

window.google = window.google || {};
google.maps = google.maps || {};
(function() {
  
  function getScript(src) {
    var s = document.createElement('script');
    
    s.src = src;
    document.body.appendChild(s);
  }
  
  var modules = google.maps.modules = {};
  google.maps.__gjsload__ = function(name, text) {
    modules[name] = text;
  };
  
  google.maps.Load = function(apiLoad) {
    delete google.maps.Load;
    apiLoad([0.009999999776482582,[[["https://mts0.googleapis.com/maps/vt?lyrs=m@355000000\u0026src=api\u0026hl=en-GB\u0026","https://mts1.googleapis.com/maps/vt?lyrs=m@355000000\u0026src=api\u0026hl=en-GB\u0026"],null,null,null,null,"m@355000000",["https://mts0.google.com/maps/vt?lyrs=m@355000000\u0026src=api\u0026hl=en-GB\u0026","https://mts1.google.com/maps/vt?lyrs=m@355000000\u0026src=api\u0026hl=en-GB\u0026"]],[["https://khms0.googleapis.com/kh?v=693\u0026hl=en-GB\u0026","https://khms1.googleapis.com/kh?v=693\u0026hl=en-GB\u0026"],null,null,null,1,"693",["https://khms0.google.com/kh?v=693\u0026hl=en-GB\u0026","https://khms1.google.com/kh?v=693\u0026hl=en-GB\u0026"]],null,[["https://mts0.googleapis.com/maps/vt?lyrs=t@355,r@355000000\u0026src=api\u0026hl=en-GB\u0026","https://mts1.googleapis.com/maps/vt?lyrs=t@355,r@355000000\u0026src=api\u0026hl=en-GB\u0026"],null,null,null,null,"t@355,r@355000000",["https://mts0.google.com/maps/vt?lyrs=t@355,r@355000000\u0026src=api\u0026hl=en-GB\u0026","https://mts1.google.com/maps/vt?lyrs=t@355,r@355000000\u0026src=api\u0026hl=en-GB\u0026"]],null,null,[["https://cbks0.googleapis.com/cbk?","https://cbks1.googleapis.com/cbk?"]],[["https://khms0.googleapis.com/kh?v=98\u0026hl=en-GB\u0026","https://khms1.googleapis.com/kh?v=98\u0026hl=en-GB\u0026"],null,null,null,null,"98",["https://khms0.google.com/kh?v=98\u0026hl=en-GB\u0026","https://khms1.google.com/kh?v=98\u0026hl=en-GB\u0026"]],[["https://mts0.googleapis.com/mapslt?hl=en-GB\u0026","https://mts1.googleapis.com/mapslt?hl=en-GB\u0026"]],[["https://mts0.googleapis.com/mapslt/ft?hl=en-GB\u0026","https://mts1.googleapis.com/mapslt/ft?hl=en-GB\u0026"]],[["https://mts0.googleapis.com/maps/vt?hl=en-GB\u0026","https://mts1.googleapis.com/maps/vt?hl=en-GB\u0026"]],[["https://mts0.googleapis.com/mapslt/loom?hl=en-GB\u0026","https://mts1.googleapis.com/mapslt/loom?hl=en-GB\u0026"]],[["https://mts0.googleapis.com/mapslt?hl=en-GB\u0026","https://mts1.googleapis.com/mapslt?hl=en-GB\u0026"]],[["https://mts0.googleapis.com/mapslt/ft?hl=en-GB\u0026","https://mts1.googleapis.com/mapslt/ft?hl=en-GB\u0026"]],[["https://mts0.googleapis.com/mapslt/loom?hl=en-GB\u0026","https://mts1.googleapis.com/mapslt/loom?hl=en-GB\u0026"]]],["en-GB","US",null,0,null,null,"https://maps.gstatic.com/mapfiles/","https://csi.gstatic.com","https://maps.googleapis.com","https://maps.googleapis.com",null,"https://maps.google.com","https://gg.google.com","https://maps.gstatic.com/maps-api-v3/api/images/","https://www.google.com/maps",0,"https://www.google.com"],["https://maps.googleapis.com/maps-api-v3/api/js/25/8/intl/en_gb","3.25.8"],[4185683918],1,null,null,null,null,null,"initMap",null,null,1,"https://khms.googleapis.com/mz?v=693\u0026","AIzaSyAllCYQn6MZXwNbHlcT9mDpfk8oHyV7FTI","https://earthbuilder.googleapis.com","https://earthbuilder.googleapis.com",null,"https://mts.googleapis.com/maps/vt/icon",[["https://maps.googleapis.com/maps/vt"],["https://maps.googleapis.com/maps/vt"],null,null,null,null,null,null,null,null,null,null,["https://www.google.com/maps/vt"],"/maps/vt",355000000,355],2,500,[null,"https://g0.gstatic.com/landmark/tour","https://g0.gstatic.com/landmark/config",null,"https://www.google.com/maps/preview/log204","","https://static.panoramio.com.storage.googleapis.com/photos/",["https://geo0.ggpht.com/cbk","https://geo1.ggpht.com/cbk","https://geo2.ggpht.com/cbk","https://geo3.ggpht.com/cbk"],"https://maps.googleapis.com/maps/api/js/GeoPhotoService.GetMetadata","https://maps.googleapis.com/maps/api/js/GeoPhotoService.SingleImageSearch",["https://lh3.ggpht.com/","https://lh4.ggpht.com/","https://lh5.ggpht.com/","https://lh6.ggpht.com/"]],["https://www.google.com/maps/api/js/master?pb=!1m2!1u25!2s8!2sen-GB!3sUS!4s25/8/intl/en_gb","https://www.google.com/maps/api/js/widget?pb=!1m2!1u25!2s8!2sen-GB"],null,0,null,"/maps/api/js/ApplicationService.GetEntityDetails",0,null,null,[null,null,null,null,null,null,null,null,null,[0,0]],null,[],["25.8"]], loadScriptTime);
  };
  var loadScriptTime = (new Date).getTime();
})();
// inlined
(function(_){'use strict';var Ea,Fa,Ra,Wa,$a,fb,gb,hb,ib,mb,nb,qb,tb,pb,ub,yb,Hb,Lb,Pb,Xb,Yb,ac,dc,ec,gc,ic,kc,fc,hc,mc,pc,qc,wc,Ic,Kc,Pc,Oc,Qc,Rc,Sc,Tc,Uc,cd,ed,gd,hd,pd,rd,qd,td,yd,zd,Ed,Ld,Od,Pd,be,ce,ee,ie,ke,je,le,se,te,we,ze,Ae,Be,Fe,Ge,He,Ie,Le,Ne,Oe,Pe,Qe,Re,Se,Xe,af,bf,cf,df,lf,mf,nf,qf,tf,zf,Af,Cf,Ff,Hf,Sf,Tf,Uf,Vf,Wf,Xf,Zf,$f,ag,bg,dg,ig,kg,tg,ug,Ag,yg,Bg,Cg,Gg,Jg,Kg,Og,Pg,Ug,Vg,Wg,Xg,Yg,Ba,Ca;_.aa="ERROR";_.ba="INVALID_REQUEST";_.ca="MAX_DIMENSIONS_EXCEEDED";_.da="MAX_ELEMENTS_EXCEEDED";_.ea="MAX_WAYPOINTS_EXCEEDED";
_.fa="NOT_FOUND";_.ga="OK";_.ha="OVER_QUERY_LIMIT";_.ia="REQUEST_DENIED";_.ja="UNKNOWN_ERROR";_.ka="ZERO_RESULTS";_.la=function(){return function(a){return a}};_.k=function(){return function(){}};_.ma=function(a){return function(b){this[a]=b}};_.m=function(a){return function(){return this[a]}};_.oa=function(a){return function(){return a}};_.ra=function(a){return function(){return _.pa[a].apply(this,arguments)}};_.sa=function(a){return void 0!==a};_.ta=_.k();
_.ua=function(a){a.Jb=function(){return a.Ra?a.Ra:a.Ra=new a}};
_.va=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};_.wa=function(a){var b=_.va(a);return"array"==b||"object"==b&&"number"==typeof a.length};_.xa=function(a){return"string"==typeof a};_.ya=function(a){return"number"==typeof a};_.za=function(a){return"function"==_.va(a)};_.Aa=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};_.Da=function(a){return a[Ba]||(a[Ba]=++Ca)};Ea=function(a,b,c){return a.call.apply(a.bind,arguments)};
Fa=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}};_.u=function(a,b,c){_.u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ea:Fa;return _.u.apply(null,arguments)};_.Ga=function(){return+new Date};
_.v=function(a,b){function c(){}c.prototype=b.prototype;a.Ab=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.cq=function(a,c,f){for(var g=Array(arguments.length-2),h=2;h<arguments.length;h++)g[h-2]=arguments[h];return b.prototype[c].apply(a,g)}};_.y=function(a){return a?a.length:0};_.Ha=function(a,b){return function(c){return b(a(c))}};_.Ja=function(a,b){_.Ia(b,function(c){a[c]=b[c]})};_.Ka=function(a){for(var b in a)return!1;return!0};
_.La=function(a,b,c){null!=b&&(a=Math.max(a,b));null!=c&&(a=Math.min(a,c));return a};_.Ma=function(a,b,c){c-=b;return((a-b)%c+c)%c+b};_.Na=function(a,b,c){return Math.abs(a-b)<=(c||1E-9)};_.Oa=function(a,b){for(var c=[],d=_.y(a),e=0;e<d;++e)c.push(b(a[e],e));return c};_.Qa=function(a,b){for(var c=_.Pa(void 0,_.y(b)),d=_.Pa(void 0,0);d<c;++d)a.push(b[d])};Ra=function(a){return null==a};_.Sa=function(a){return"undefined"!=typeof a};_.A=function(a){return"number"==typeof a};
_.Ta=function(a){return"object"==typeof a};_.Pa=function(a,b){return null==a?b:a};_.Ua=function(a){return"string"==typeof a};_.Va=function(a){return a===!!a};_.Ia=function(a,b){for(var c in a)b(c,a[c])};Wa=function(a,b,c){return Function.prototype.call.apply(Array.prototype.slice,arguments)};_.Xa=function(a){return null!=a&&"object"==typeof a&&"number"==typeof a.length};_.Za=function(a){return function(){var b=this,c=arguments;_.Ya(function(){a.apply(b,c)})}};
_.Ya=function(a){return window.setTimeout(a,0)};$a=function(a,b){if(Object.prototype.hasOwnProperty.call(a,b))return a[b]};_.ab=function(a){window.console&&window.console.error&&window.console.error(a)};_.db=function(a){a=a||window.event;_.bb(a);_.cb(a)};_.bb=function(a){a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation()};_.cb=function(a){a.preventDefault&&_.Sa(a.defaultPrevented)?a.preventDefault():a.returnValue=!1};_.eb=function(a){a.handled=!0;_.Sa(a.bubbles)||(a.returnValue="handled")};
fb=function(a,b){a.__e3_||(a.__e3_={});a=a.__e3_;a[b]||(a[b]={});return a[b]};gb=function(a,b){a=a.__e3_||{};if(b)b=a[b]||{};else{b={};for(var c in a)_.Ja(b,a[c])}return b};hb=function(a,b){return function(c){return b.call(a,c,this)}};ib=function(a,b,c){return function(d){var e=[b,a];_.Qa(e,arguments);_.B.trigger.apply(this,e);c&&_.eb.apply(null,arguments)}};mb=function(a,b,c,d){this.Ra=a;this.f=b;this.b=c;this.j=null;this.l=d;this.id=++jb;fb(a,b)[this.id]=this;kb&&"tagName"in a&&(lb[this.id]=this)};
nb=function(a){return a.j=function(b){b||(b=window.event);if(b&&!b.target)try{b.target=b.srcElement}catch(d){}var c;c=a.b.apply(a.Ra,[b]);return b&&"click"==b.type&&(b=b.srcElement)&&"A"==b.tagName&&"javascript:void(0)"==b.href?!1:c}};_.ob=function(a){return""+(_.Aa(a)?_.Da(a):a)};_.C=_.k();qb=function(a,b){var c=b+"_changed";if(a[c])a[c]();else a.changed(b);var c=pb(a,b),d;for(d in c){var e=c[d];qb(e.Ic,e.jb)}_.B.trigger(a,b.toLowerCase()+"_changed")};
_.sb=function(a){return rb[a]||(rb[a]=a.substr(0,1).toUpperCase()+a.substr(1))};tb=function(a){a.gm_accessors_||(a.gm_accessors_={});return a.gm_accessors_};pb=function(a,b){a.gm_bindings_||(a.gm_bindings_={});a.gm_bindings_.hasOwnProperty(b)||(a.gm_bindings_[b]={});return a.gm_bindings_[b]};ub=function(a){this.message=a;this.name="InvalidValueError";this.stack=Error().stack};_.vb=function(a,b){var c="";if(null!=b){if(!(b instanceof ub))return b;c=": "+b.message}return new ub(a+c)};
_.wb=function(a){if(!(a instanceof ub))throw a;_.ab(a.name+": "+a.message)};_.xb=function(a,b){return function(c){if(!c||!_.Ta(c))throw _.vb("not an Object");var d={},e;for(e in c)if(d[e]=c[e],!b&&!a[e])throw _.vb("unknown property "+e);for(e in a)try{var f=a[e](d[e]);if(_.Sa(f)||Object.prototype.hasOwnProperty.call(c,e))d[e]=a[e](d[e])}catch(g){throw _.vb("in property "+e,g);}return d}};yb=function(a){try{return!!a.cloneNode}catch(b){return!1}};
_.zb=function(a,b,c){return c?function(c){if(c instanceof a)return c;try{return new a(c)}catch(e){throw _.vb("when calling new "+b,e);}}:function(c){if(c instanceof a)return c;throw _.vb("not an instance of "+b);}};_.Ab=function(a){return function(b){for(var c in a)if(a[c]==b)return b;throw _.vb(b);}};_.Bb=function(a){return function(b){if(!_.Xa(b))throw _.vb("not an Array");return _.Oa(b,function(b,d){try{return a(b)}catch(e){throw _.vb("at index "+d,e);}})}};
_.Cb=function(a,b){return function(c){if(a(c))return c;throw _.vb(b||""+c);}};_.Db=function(a){var b=arguments;return function(a){for(var d=[],e=0,f=b.length;e<f;++e){var g=b[e];try{(g.Ag||g)(a)}catch(h){if(!(h instanceof ub))throw h;d.push(h.message);continue}return(g.then||g)(a)}throw _.vb(d.join("; and "));}};_.Eb=function(a){return function(b){return null==b?b:a(b)}};Hb=function(a){return function(b){if(b&&null!=b[a])return b;throw _.vb("no "+a+" property");}};
_.Ib=function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};_.Kb=function(){return-1!=_.Jb.toLowerCase().indexOf("webkit")};
_.Mb=function(a,b){var c=0;a=_.Ib(String(a)).split(".");b=_.Ib(String(b)).split(".");for(var d=Math.max(a.length,b.length),e=0;0==c&&e<d;e++){var f=a[e]||"",g=b[e]||"",h=/(\d*)(\D*)/g,l=/(\d*)(\D*)/g;do{var n=h.exec(f)||["","",""],p=l.exec(g)||["","",""];if(0==n[0].length&&0==p[0].length)break;c=Lb(0==n[1].length?0:(0,window.parseInt)(n[1],10),0==p[1].length?0:(0,window.parseInt)(p[1],10))||Lb(0==n[2].length,0==p[2].length)||Lb(n[2],p[2])}while(0==c)}return c};
Lb=function(a,b){return a<b?-1:a>b?1:0};_.Ob=function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(_.xa(a))return _.xa(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};_.G=function(a,b,c){for(var d=a.length,e=_.xa(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};Pb=function(a,b){for(var c=a.length,d=_.xa(a)?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a))return e;return-1};
_.Rb=function(a,b){b=_.Ob(a,b);var c;(c=0<=b)&&_.Qb(a,b);return c};_.Qb=function(a,b){Array.prototype.splice.call(a,b,1)};_.Sb=function(a){return a*Math.PI/180};_.Tb=function(a){return 180*a/Math.PI};_.H=function(a,b,c){if(a&&(void 0!==a.lat||void 0!==a.lng))try{Ub(a),b=a.lng,a=a.lat,c=!1}catch(d){_.wb(d)}a-=0;b-=0;c||(a=_.La(a,-90,90),180!=b&&(b=_.Ma(b,-180,180)));this.lat=function(){return a};this.lng=function(){return b}};_.Vb=function(a){return _.Sb(a.lat())};_.Wb=function(a){return _.Sb(a.lng())};
Xb=function(a,b){b=Math.pow(10,b);return Math.round(a*b)/b};Yb=_.k();_.Zb=function(a){try{if(a instanceof _.H)return a;a=Ub(a);return new _.H(a.lat,a.lng)}catch(b){throw _.vb("not a LatLng or LatLngLiteral",b);}};_.$b=function(a){this.b=_.Zb(a)};ac=function(a){if(a instanceof Yb)return a;try{return new _.$b(_.Zb(a))}catch(b){}throw _.vb("not a Geometry or LatLng or LatLngLiteral object");};_.bc=function(a,b){if(a)return function(){--a||b()};b();return _.ta};
_.cc=function(a,b,c){var d=a.getElementsByTagName("head")[0];a=a.createElement("script");a.type="text/javascript";a.charset="UTF-8";a.src=b;c&&(a.onerror=c);d.appendChild(a);return a};dc=function(a){for(var b="",c=0,d=arguments.length;c<d;++c){var e=arguments[c];e.length&&"/"==e[0]?b=e:(b&&"/"!=b[b.length-1]&&(b+="/"),b+=e)}return b};ec=function(a){this.j=window.document;this.b={};this.f=a};gc=function(){this.l={};this.f={};this.m={};this.b={};this.j=new fc};
ic=function(a,b){a.l[b]||(a.l[b]=!0,hc(a.j,function(c){for(var d=c.Wh[b],e=d?d.length:0,f=0;f<e;++f){var g=d[f];a.b[g]||ic(a,g)}c=c.Zm;c.b[b]||_.cc(c.j,dc(c.f,b)+".js")}))};kc=function(a,b){var c=jc;this.Zm=a;this.Wh=c;a={};for(var d in c)for(var e=c[d],f=0,g=e.length;f<g;++f){var h=e[f];a[h]||(a[h]=[]);a[h].push(d)}this.vo=a;this.ul=b};fc=function(){this.b=[]};hc=function(a,b){a.f?b(a.f):a.b.push(b)};_.J=function(a,b,c){var d=gc.Jb();a=""+a;d.b[a]?b(d.b[a]):((d.f[a]=d.f[a]||[]).push(b),c||ic(d,a))};
_.lc=function(a,b){gc.Jb().b[""+a]=b};mc=function(a,b,c){var d=[],e=_.bc(a.length,function(){b.apply(null,d)});_.G(a,function(a,b){_.J(a,function(a){d[b]=a;e()},c)})};_.nc=function(a){a=a||{};this.j=a.id;this.b=null;try{this.b=a.geometry?ac(a.geometry):null}catch(b){_.wb(b)}this.f=a.properties||{}};_.L=function(a,b){this.x=a;this.y=b};pc=function(a){if(a instanceof _.L)return a;try{_.xb({x:_.oc,y:_.oc},!0)(a)}catch(b){throw _.vb("not a Point",b);}return new _.L(a.x,a.y)};
_.M=function(a,b,c,d){this.width=a;this.height=b;this.j=c||"px";this.f=d||"px"};qc=function(a){if(a instanceof _.M)return a;try{_.xb({height:_.oc,width:_.oc},!0)(a)}catch(b){throw _.vb("not a Size",b);}return new _.M(a.width,a.height)};_.rc=function(a){return function(){return this.get(a)}};_.sc=function(a,b){return b?function(c){try{this.set(a,b(c))}catch(d){_.wb(_.vb("set"+_.sb(a),d))}}:function(b){this.set(a,b)}};
_.tc=function(a,b){_.Ia(b,function(b,d){var e=_.rc(b);a["get"+_.sb(b)]=e;d&&(d=_.sc(b,d),a["set"+_.sb(b)]=d)})};_.xc=function(a){this.b=a||[];wc(this)};wc=function(a){a.set("length",a.b.length)};_.yc=function(a){this.j=a||_.ob;this.f={}};_.zc=function(a,b){var c=a.f,d=a.j(b);c[d]||(c[d]=b,_.B.trigger(a,"insert",b),a.b&&a.b(b))};_.Ac=_.ma("b");_.Bc=function(a,b,c){this.heading=a;this.pitch=_.La(b,-90,90);this.zoom=Math.max(0,c)};_.Cc=function(){this.__gm=new _.C;this.l=null};_.Dc=_.la();
_.Ec=function(a,b,c){for(var d in a)b.call(c,a[d],d,a)};_.Gc=function(a){return-1!=_.Jb.indexOf(a)};_.Hc=function(){return _.Gc("Trident")||_.Gc("MSIE")};Ic=function(){return(_.Gc("Chrome")||_.Gc("CriOS"))&&!_.Gc("Edge")};Kc=function(a){_.Jc.setTimeout(function(){throw a;},0)};Pc=function(){var a=_.Lc.f,a=Mc(a);!_.za(_.Jc.setImmediate)||_.Jc.Window&&_.Jc.Window.prototype&&!_.Gc("Edge")&&_.Jc.Window.prototype.setImmediate==_.Jc.setImmediate?(Nc||(Nc=Oc()),Nc(a)):_.Jc.setImmediate(a)};
Oc=function(){var a=_.Jc.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!_.Gc("Presto")&&(a=function(){var a=window.document.createElement("IFRAME");a.style.display="none";a.src="";window.document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=(0,_.u)(function(a){if(("*"==
d||a.origin==d)&&a.data==c)this.port1.onmessage()},this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&!_.Hc()){var b=new a,c={},d=c;b.port1.onmessage=function(){if(_.sa(c.next)){c=c.next;var a=c.lh;c.lh=null;a()}};return function(a){d.next={lh:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof window.document&&"onreadystatechange"in window.document.createElement("SCRIPT")?function(a){var b=window.document.createElement("SCRIPT");
b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};window.document.documentElement.appendChild(b)}:function(a){_.Jc.setTimeout(a,0)}};Qc=function(a,b,c){this.l=c;this.j=a;this.m=b;this.f=0;this.b=null};Rc=function(){this.f=this.b=null};Sc=function(){this.next=this.b=this.Dc=null};_.Lc=function(a,b){_.Lc.b||_.Lc.m();_.Lc.j||(_.Lc.b(),_.Lc.j=!0);_.Lc.l.add(a,b)};Tc=function(a,b){return function(c){return c.Dc==a&&c.context==(b||null)}};
Uc=function(a){this.T=[];this.b=a&&a.yd||_.ta;this.f=a&&a.Ad||_.ta};_.Wc=function(a,b,c,d){function e(){_.G(f,function(a){b.call(c||null,function(b){if(a.Bd){if(a.Bd.jh)return;a.Bd.jh=!0;_.Rb(g.T,a);g.T.length||g.b()}a.Dc.call(a.context,b)})})}var f=a.T.slice(0),g=a;d&&d.Ro?e():Vc(e)};_.Xc=function(){this.T=new Uc({yd:(0,_.u)(this.yd,this),Ad:(0,_.u)(this.Ad,this)})};_.ad=function(){_.Xc.call(this)};_.bd=function(a){_.Xc.call(this);this.b=a};cd=_.k();
ed=function(a){var b=a;if(a instanceof Array)b=Array(a.length),_.dd(b,a);else if(a instanceof Object){var c=b={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]=ed(a[d]))}return b};_.dd=function(a,b){for(var c=0;c<b.length;++c)b.hasOwnProperty(c)&&(a[c]=ed(b[c]))};_.N=function(a,b){a[b]||(a[b]=[]);return a[b]};_.fd=function(a,b){return a[b]?a[b].length:0};gd=function(a,b,c,d){this.type=a;this.label=b;this.Cl=c;this.Ac=d};
hd=function(a){switch(a){case "d":case "f":case "i":case "j":case "u":case "v":case "x":case "y":case "g":case "h":case "n":case "o":case "e":return 0;case "s":case "z":case "B":return"";case "b":return!1;default:return null}};_.id=function(a,b,c){return new gd(a,1,_.sa(b)?b:hd(a),c)};_.jd=function(a,b,c){return new gd(a,2,_.sa(b)?b:hd(a),c)};_.kd=function(a,b){return new gd(a,3,void 0,b)};_.ld=function(a){return _.id("i",a)};_.md=function(a){return _.id("v",a)};_.nd=function(a){return _.id("b",a)};
_.od=function(a){return _.id("e",a)};_.O=function(a,b){return _.id("m",a,b)};pd=_.k();rd=function(a,b,c){for(var d=1;d<b.A.length;++d){var e=b.A[d],f=a[d+b.F];if(e&&null!=f)if(3==e.label)for(var g=0;g<f.length;++g)qd(f[g],d,e,c);else qd(f,d,e,c)}};qd=function(a,b,c,d){if("m"==c.type){var e=d.length;rd(a,c.Ac,d);d.splice(e,0,[b,"m",d.length-e].join(""))}else"b"==c.type&&(a=a?"1":"0"),d.push([b,c.type,(0,window.encodeURIComponent)(a)].join(""))};
_.sd=function(){return _.Gc("iPhone")&&!_.Gc("iPod")&&!_.Gc("iPad")};td=function(){var a=_.Jc.document;return a?a.documentMode:void 0};_.wd=function(a){return ud[a]||(ud[a]=0<=_.Mb(_.vd,a))};_.xd=function(a,b){this.b=a||0;this.f=b||0};yd=_.k();zd=function(a,b){-180==a&&180!=b&&(a=180);-180==b&&180!=a&&(b=180);this.b=a;this.f=b};_.Ad=function(a){return a.b>a.f};_.Cd=function(a,b){return 1E-9>=Math.abs(b.b-a.b)%360+Math.abs(_.Bd(b)-_.Bd(a))};_.Dd=function(a,b){var c=b-a;return 0<=c?c:b+180-(a-180)};
_.Bd=function(a){return a.isEmpty()?0:_.Ad(a)?360-(a.b-a.f):a.f-a.b};Ed=function(a,b){this.f=a;this.b=b};_.Fd=function(a){return a.isEmpty()?0:a.b-a.f};_.Gd=function(a,b){a=a&&_.Zb(a);b=b&&_.Zb(b);if(a){b=b||a;var c=_.La(a.lat(),-90,90),d=_.La(b.lat(),-90,90);this.f=new Ed(c,d);a=a.lng();b=b.lng();360<=b-a?this.b=new zd(-180,180):(a=_.Ma(a,-180,180),b=_.Ma(b,-180,180),this.b=new zd(a,b))}else this.f=new Ed(1,-1),this.b=new zd(180,-180)};
_.Hd=function(a,b,c,d){return new _.Gd(new _.H(a,b,!0),new _.H(c,d,!0))};_.Jd=function(a){if(a instanceof _.Gd)return a;try{return a=Id(a),_.Hd(a.south,a.west,a.north,a.east)}catch(b){throw _.vb("not a LatLngBounds or LatLngBoundsLiteral",b);}};_.Kd=_.ma("__gm");Ld=function(){this.b={};this.j={};this.f={}};Od=function(){this.b={}};Pd=function(a){this.b=new Od;var b=this;_.B.addListenerOnce(a,"addfeature",function(){_.J("data",function(c){c.b(b,a,b.b)})})};_.Rd=function(a){this.b=[];try{this.b=Qd(a)}catch(b){_.wb(b)}};
_.Td=function(a){this.b=(0,_.Sd)(a)};_.Vd=function(a){this.b=Ud(a)};_.Wd=function(a){this.b=(0,_.Sd)(a)};_.Xd=function(a){this.b=(0,_.Sd)(a)};_.Zd=function(a){this.b=Yd(a)};_.ae=function(a){this.b=$d(a)};be=function(a){a=a||{};a.clickable=_.Pa(a.clickable,!0);a.visible=_.Pa(a.visible,!0);this.setValues(a);_.J("marker",_.ta)};ce=function(a){var b=_,c=gc.Jb().j;a=c.f=new kc(new ec(a),b);for(var b=0,d=c.b.length;b<d;++b)c.b[b](a);c.b.length=0};
_.de=function(a){this.__gm={set:null,se:null};be.call(this,a)};ee=function(a){a=a||{};a.visible=_.Pa(a.visible,!0);return a};_.fe=function(a){return a&&a.radius||6378137};ie=function(a){return a instanceof _.xc?he(a):new _.xc((0,_.Sd)(a))};ke=function(a){var b;_.Xa(a)?0==_.y(a)?b=!0:(b=a instanceof _.xc?a.getAt(0):a[0],b=_.Xa(b)):b=!1;return b?a instanceof _.xc?je(he)(a):new _.xc(_.Bb(ie)(a)):new _.xc([ie(a)])};
je=function(a){return function(b){if(!(b instanceof _.xc))throw _.vb("not an MVCArray");b.forEach(function(b,d){try{a(b)}catch(e){throw _.vb("at index "+d,e);}});return b}};le=function(a){this.set("latLngs",new _.xc([new _.xc]));this.setValues(ee(a));_.J("poly",_.ta)};_.me=function(a){le.call(this,a)};_.ne=function(a){le.call(this,a)};
_.qe=function(a,b,c){function d(a){if(!a)throw _.vb("not a Feature");if("Feature"!=a.type)throw _.vb('type != "Feature"');var b=a.geometry;try{b=null==b?null:e(b)}catch(d){throw _.vb('in property "geometry"',d);}var f=a.properties||{};if(!_.Ta(f))throw _.vb("properties is not an Object");var g=c.idPropertyName;a=g?f[g]:a.id;if(null!=a&&!_.A(a)&&!_.Ua(a))throw _.vb((g||"id")+" is not a string or number");return{id:a,geometry:b,properties:f}}function e(a){if(null==a)throw _.vb("is null");var b=(a.type+
"").toLowerCase(),c=a.coordinates;try{switch(b){case "point":return new _.$b(h(c));case "multipoint":return new _.Wd(n(c));case "linestring":return g(c);case "multilinestring":return new _.Vd(p(c));case "polygon":return f(c);case "multipolygon":return new _.ae(r(c))}}catch(d){throw _.vb('in property "coordinates"',d);}if("geometrycollection"==b)try{return new _.Rd(x(a.geometries))}catch(d){throw _.vb('in property "geometries"',d);}throw _.vb("invalid type");}function f(a){return new _.Zd(q(a))}function g(a){return new _.Td(n(a))}
function h(a){a=l(a);return _.Zb({lat:a[1],lng:a[0]})}if(!b)return[];c=c||{};var l=_.Bb(_.oc),n=_.Bb(h),p=_.Bb(g),q=_.Bb(function(a){a=n(a);if(!a.length)throw _.vb("contains no elements");if(!a[0].b(a[a.length-1]))throw _.vb("first and last positions are not equal");return new _.Xd(a.slice(0,-1))}),r=_.Bb(f),x=_.Bb(e),z=_.Bb(d);if("FeatureCollection"==b.type){b=b.features;try{return _.Oa(z(b),function(b){return a.add(b)})}catch(w){throw _.vb('in property "features"',w);}}if("Feature"==b.type)return[a.add(d(b))];
throw _.vb("not a Feature or FeatureCollection");};se=function(a){var b=this;this.setValues(a||{});this.b=new Ld;_.B.forward(this.b,"addfeature",this);_.B.forward(this.b,"removefeature",this);_.B.forward(this.b,"setgeometry",this);_.B.forward(this.b,"setproperty",this);_.B.forward(this.b,"removeproperty",this);this.f=new Pd(this.b);this.f.bindTo("map",this);this.f.bindTo("style",this);_.G(_.re,function(a){_.B.forward(b.f,a,b)});this.j=!1};te=function(a){a.j||(a.j=!0,_.J("drawing_impl",function(b){b.vm(a)}))};
_.ue=function(a){this.b=a||[]};_.ve=function(a){this.b=a||[]};we=function(a){this.b=a||[]};_.xe=function(a){this.b=a||[]};_.ye=function(a){this.b=a||[]};ze=function(a){if(!a)return null;var b;_.xa(a)?(b=window.document.createElement("div"),b.style.overflow="auto",b.innerHTML=a):a.nodeType==window.Node.TEXT_NODE?(b=window.document.createElement("div"),b.appendChild(a)):b=a;return b};
Ae=function(a,b){this.b=a;this.qd=b;a.addListener("map_changed",(0,_.u)(this.vn,this));this.bindTo("map",a);this.bindTo("disableAutoPan",a);this.bindTo("maxWidth",a);this.bindTo("position",a);this.bindTo("zIndex",a);this.bindTo("internalAnchor",a,"anchor");this.bindTo("internalContent",a,"content");this.bindTo("internalPixelOffset",a,"pixelOffset")};Be=function(a,b,c,d){c?a.bindTo(b,c,d):(a.unbind(b),a.set(b,void 0))};
_.Ce=function(a){function b(){e||(e=!0,_.J("infowindow",function(a){a.Tk(d)}))}window.setTimeout(function(){_.J("infowindow",_.ta)},100);a=a||{};var c=!!a.qd;delete a.qd;var d=new Ae(this,c),e=!1;_.B.addListenerOnce(this,"anchor_changed",b);_.B.addListenerOnce(this,"map_changed",b);this.setValues(a)};_.Ee=function(a){_.De&&a&&_.De.push(a)};Fe=function(a){this.setValues(a)};Ge=_.k();He=_.k();Ie=_.k();_.Je=function(){_.J("geocoder",_.ta)};
_.Ke=function(a,b,c){this.J=null;this.set("url",a);this.set("bounds",_.Eb(_.Jd)(b));this.setValues(c)};Le=function(a,b){_.Ua(a)?(this.set("url",a),this.setValues(b)):this.setValues(a)};_.Me=function(){var a=this;_.J("layers",function(b){b.b(a)})};Ne=function(a){this.setValues(a);var b=this;_.J("layers",function(a){a.f(b)})};Oe=function(){var a=this;_.J("layers",function(b){b.j(a)})};Pe=function(a){this.b=a||[]};Qe=function(a){this.b=a||[]};Re=function(a){this.b=a||[]};Se=function(a){this.b=a||[]};
_.Te=function(a){this.b=a||[]};_.Ue=function(a){this.b=a||[]};_.Ve=function(a){this.b=a||[]};_.We=function(a){this.b=a||[]};Xe=function(a){this.b=a||[]};af=function(a){this.b=a||[]};bf=function(a){this.b=a||[]};cf=function(a){this.b=a||[]};df=function(a){this.b=a||[]};_.ef=function(a){this.b=a||[]};_.ff=function(a){this.b=a||[]};_.gf=function(a){a=a.b[0];return null!=a?a:""};_.hf=function(a){a=a.b[1];return null!=a?a:""};_.kf=function(){var a=_.jf(_.P).b[9];return null!=a?a:""};
lf=function(){var a=_.jf(_.P).b[7];return null!=a?a:""};mf=function(){var a=_.jf(_.P).b[12];return null!=a?a:""};nf=function(a){a=a.b[0];return null!=a?a:""};_.of=function(a){a=a.b[1];return null!=a?a:""};qf=function(){var a=_.P.b[4],a=(a?new bf(a):pf).b[0];return null!=a?a:0};_.rf=function(){var a=_.P.b[0];return null!=a?a:1};_.sf=function(a){a=a.b[6];return null!=a?a:""};tf=function(){var a=_.P.b[11];return null!=a?a:""};_.uf=function(){var a=_.P.b[16];return null!=a?a:""};
_.jf=function(a){return(a=a.b[2])?new Xe(a):vf};_.xf=function(){var a=_.P.b[3];return a?new af(a):wf};zf=function(){var a=_.P.b[33];return a?new Pe(a):yf};Af=function(a){return _.N(_.P.b,8)[a]};Cf=function(){var a=_.P.b[36],a=(a?new df(a):Bf).b[0];return null!=a?a:""};
Ff=function(a,b){_.Cc.call(this);_.Ee(a);this.__gm=new _.C;this.j=null;b&&b.client&&(this.j=_.Df[b.client]||null);var c=this.controls=[];_.Ia(_.Ef,function(a,b){c[b]=new _.xc});this.m=!0;this.f=a;this.setPov(new _.Bc(0,0,1));b&&b.zb&&!_.A(b.zb.zoom)&&(b.zb.zoom=_.A(b.zoom)?b.zoom:1);this.setValues(b);void 0==this.getVisible()&&this.setVisible(!0);this.__gm.Hc=b&&b.Hc||new _.yc;_.B.addListenerOnce(this,"pano_changed",_.Za(function(){_.J("marker",(0,_.u)(function(a){a.b(this.__gm.Hc,this)},this))}))};
_.Gf=function(){this.l=[];this.f=this.b=this.j=null};Hf=function(a,b,c){this.V=b;this.b=new _.bd(new _.Ac([]));this.C=new _.yc;this.K=new _.xc;this.G=new _.yc;this.H=new _.yc;this.l=new _.yc;var d=this.Hc=new _.yc;d.b=function(){delete d.b;_.J("marker",_.Za(function(b){b.b(d,a)}))};this.j=new Ff(b,{visible:!1,enableCloseButton:!0,Hc:d});this.j.bindTo("reportErrorControl",a);this.j.m=!1;this.f=new _.Gf;this.X=c};_.If=function(){this.T=new Uc};
_.Jf=function(){this.b=new _.L(128,128);this.j=256/360;this.l=256/(2*Math.PI);this.f=!0};_.Kf=function(a){this.L=this.M=window.Infinity;this.R=this.O=-window.Infinity;_.G(a||[],this.extend,this)};_.Lf=function(a,b,c,d){var e=new _.Kf;e.M=a;e.L=b;e.O=c;e.R=d;return e};_.Nf=function(a,b,c){if(a=a.fromLatLngToPoint(b))c=Math.pow(2,c),a.x*=c,a.y*=c;return a};
_.Of=function(a,b){var c=a.lat()+_.Tb(b);90<c&&(c=90);var d=a.lat()-_.Tb(b);-90>d&&(d=-90);b=Math.sin(b);var e=Math.cos(_.Sb(a.lat()));if(90==c||-90==d||1E-6>e)return new _.Gd(new _.H(d,-180),new _.H(c,180));b=_.Tb(Math.asin(b/e));return new _.Gd(new _.H(d,a.lng()-b),new _.H(c,a.lng()+b))};_.Pf=function(a){this.ol=a||0;_.B.bind(this,"forceredraw",this,this.C)};_.Qf=function(a,b){a=a.style;a.width=b.width+b.j;a.height=b.height+b.f};_.Rf=function(a){return new _.M(a.offsetWidth,a.offsetHeight)};
Sf=function(a){this.b=a||[]};Tf=function(a){this.b=a||[]};Uf=function(a){this.b=a||[]};Vf=function(a){this.b=a||[]};Wf=function(a){this.b=a||[]};Xf=function(a,b,c,d){_.Pf.call(this);this.m=b;this.l=new _.Jf;this.D=c+"/maps/api/js/StaticMapService.GetMapImage";this.f=this.b=null;this.j=d;this.set("div",a);this.set("loading",!0)};Zf=function(a){var b=a.get("tilt")||a.get("mapMaker")||_.y(a.get("styles"));a=a.get("mapTypeId");return b?null:Yf[a]};$f=function(a){a.parentNode&&a.parentNode.removeChild(a)};
ag=function(a,b){var c=a.f;c.onload=null;c.onerror=null;b&&(c.parentNode||a.b.appendChild(c),_.Qf(c,a.get("size")),_.B.trigger(a,"staticmaploaded"),a.j.set(_.Ga()));a.set("loading",!1)};bg=function(a,b){var c=a.f;b!=c.src?($f(c),c.onload=function(){ag(a,!0)},c.onerror=function(){ag(a,!1)},c.src=b):!c.parentNode&&b&&a.b.appendChild(c)};
dg=function(a,b,c,d,e){var f=_.cg[15]?mf():lf();this.b=a;this.f=d;this.j=_.sa(e)?e:_.Ga();var g=f+"/csi?v=2&s=mapsapi3&v3v="+Cf()+"&action="+a;_.Ec(c,function(a,b){g+="&"+(0,window.encodeURIComponent)(b)+"="+(0,window.encodeURIComponent)(a)});b&&(g+="&e="+b);this.l=g};_.fg=function(a,b){var c={};c[b]=void 0;_.eg(a,c)};
_.eg=function(a,b){var c="";_.Ec(b,function(a,b){var f=(null!=a?a:_.Ga())-this.j;c&&(c+=",");c+=b+"."+Math.round(f);null==a&&window.performance&&window.performance.mark&&window.performance.mark("mapsapi:"+this.b+":"+b)},a);b=a.l+"&rt="+c;a.f.createElement("img").src=b;(a=_.Jc.__gm_captureCSI)&&a(b)};
_.gg=function(a,b){b=b||{};var c=b.Sn||{},d=_.N(_.P.b,12).join(",");d&&(c.libraries=d);var d=_.sf(_.P),e=zf(),f=[];d&&f.push(d);_.G(e.B(),function(a,b){a&&_.G(a,function(a,c){null!=a&&f.push(b+1+"_"+(c+1)+"_"+a)})});b.Pl&&(f=f.concat(b.Pl));return new dg(a,f.join(","),c,b.document||window.document,b.startTime)};ig=function(){this.f=_.gg("apiboot2",{startTime:_.hg});_.fg(this.f,"main");this.b=!1};kg=function(){var a=jg;a.b||(a.b=!0,_.fg(a.f,"firstmap"))};_.lg=_.k();_.mg=function(){this.b=""};
_.ng=function(a){var b=new _.mg;b.b=a;return b};_.pg=function(){this.Pf="";this.gk=_.og;this.b=null};_.qg=function(a,b){var c=new _.pg;c.Pf=a;c.b=b;return c};_.rg=function(a,b){b.parentNode&&b.parentNode.insertBefore(a,b.nextSibling)};_.sg=function(a){a&&a.parentNode&&a.parentNode.removeChild(a)};tg=function(a,b,c,d,e){this.b=!!b;this.node=null;this.f=0;this.j=!1;this.l=!c;a&&this.setPosition(a,d);this.depth=void 0!=e?e:this.f||0;this.b&&(this.depth*=-1)};
ug=function(a,b,c,d){tg.call(this,a,b,c,null,d)};_.wg=function(a){for(var b;b=a.firstChild;)_.vg(b),a.removeChild(b)};_.vg=function(a){a=new ug(a);try{for(;;)_.B.clearInstanceListeners(a.next())}catch(b){if(b!==_.xg)throw b;}};
Ag=function(a,b){var c=_.Ga();jg&&kg();var d=new _.If;_.Kd.call(this,new Hf(this,a,d));var e=b||{};_.Sa(e.mapTypeId)||(e.mapTypeId="roadmap");this.setValues(e);this.b=_.cg[15]&&e.noControlsOrLogging;this.mapTypes=new yd;this.features=new _.C;_.Ee(a);this.notify("streetView");b=_.Rf(a);e.noClear||_.wg(a);var f=null;_.P&&yg(e.useStaticMap,b)&&(f=new Xf(a,_.zg,_.kf(),new _.bd(null)),_.B.forward(f,"staticmaploaded",this),f.set("size",b),f.bindTo("center",this),f.bindTo("zoom",this),f.bindTo("mapTypeId",
this),f.bindTo("styles",this),f.bindTo("mapMaker",this));this.overlayMapTypes=new _.xc;var g=this.controls=[];_.Ia(_.Ef,function(a,b){g[b]=new _.xc});var h=this,l=!0;_.J("map",function(a){a.f(h,e,f,l,c,d)});l=!1;this.data=new se({map:this})};yg=function(a,b){if(_.Sa(a))return!!a;a=b.width;b=b.height;return 384E3>=a*b&&800>=a&&800>=b};Bg=function(){_.J("maxzoom",_.ta)};Cg=function(a,b){!a||_.Ua(a)||_.A(a)?(this.set("tableId",a),this.setValues(b)):this.setValues(a)};_.Dg=_.k();
_.Eg=function(a){this.setValues(ee(a));_.J("poly",_.ta)};_.Fg=function(a){this.setValues(ee(a));_.J("poly",_.ta)};Gg=function(){this.b=null};_.Hg=function(){this.b=null};
_.Ig=function(a){this.tileSize=a.tileSize||new _.M(256,256);this.name=a.name;this.alt=a.alt;this.minZoom=a.minZoom;this.maxZoom=a.maxZoom;this.j=(0,_.u)(a.getTileUrl,a);this.b=new _.yc;this.f=null;this.set("opacity",a.opacity);_.Jc.window&&_.B.addDomListener(window,"online",(0,_.u)(this.On,this));var b=this;_.J("map",function(a){var d=b.f=a.b,e=b.tileSize||new _.M(256,256);b.b.forEach(function(a){var c=a.__gmimt,h=c.$,l=c.zoom,n=b.j(h,l);c.Bb=d(h,l,e,a,n,function(){_.B.trigger(a,"load")})})})};
Jg=function(a,b){null!=a.style.opacity?a.style.opacity=b:a.style.filter=b&&"alpha(opacity="+Math.round(100*b)+")"};Kg=function(a){a=a.get("opacity");return"number"==typeof a?a:1};_.Lg=_.k();_.Mg=function(a,b){this.set("styles",a);a=b||{};this.b=a.baseMapTypeId||"roadmap";this.minZoom=a.minZoom;this.maxZoom=a.maxZoom||20;this.name=a.name;this.alt=a.alt;this.projection=null;this.tileSize=new _.M(256,256)};
_.Ng=function(a,b){_.Cb(yb,"container is not a Node")(a);this.setValues(b);_.J("controls",(0,_.u)(function(b){b.nl(this,a)},this))};Og=_.ma("b");Pg=function(a,b,c){for(var d=Array(b.length),e=0,f=b.length;e<f;++e)d[e]=b.charCodeAt(e);d.unshift(c);a=a.b;c=b=0;for(e=d.length;c<e;++c)b*=1729,b+=d[c],b%=a;return b};
Ug=function(){var a=qf(),b=new Og(131071),c=(0,window.unescape)("%26%74%6F%6B%65%6E%3D");return function(d){d=d.replace(Sg,"%27");var e=d+c;Tg||(Tg=/(?:https?:\/\/[^/]+)?(.*)/);d=Tg.exec(d);return e+Pg(b,d&&d[1],a)}};Vg=function(){var a=new Og(2147483647);return function(b){return Pg(a,b,0)}};Wg=function(a){for(var b=a.split("."),c=window,d=window,e=0;e<b.length;e++)if(d=c,c=c[b[e]],!c)throw _.vb(a+" is not a function");return function(){c.apply(d)}};
Xg=function(){for(var a in Object.prototype)window.console&&window.console.error("This site adds property <"+a+"> to Object.prototype. Extending Object.prototype breaks JavaScript for..in loops, which are used heavily in Google Maps API v3.")};Yg=function(a){(a="version"in a)&&window.console&&window.console.error("You have included the Google Maps API multiple times on this page. This may cause unexpected errors.");return a};_.pa=[];_.Jc=this;Ba="closure_uid_"+(1E9*Math.random()>>>0);Ca=0;var kb,lb;_.B={};kb="undefined"!=typeof window.navigator&&-1!=window.navigator.userAgent.toLowerCase().indexOf("msie");lb={};_.B.addListener=function(a,b,c){return new mb(a,b,c,0)};_.B.hasListeners=function(a,b){b=(a=a.__e3_)&&a[b];return!!b&&!_.Ka(b)};_.B.removeListener=function(a){a&&a.remove()};_.B.clearListeners=function(a,b){_.Ia(gb(a,b),function(a,b){b&&b.remove()})};_.B.clearInstanceListeners=function(a){_.Ia(gb(a),function(a,c){c&&c.remove()})};
_.B.trigger=function(a,b,c){if(_.B.hasListeners(a,b)){var d=Wa(arguments,2),e=gb(a,b),f;for(f in e){var g=e[f];g&&g.b.apply(g.Ra,d)}}};_.B.addDomListener=function(a,b,c,d){if(a.addEventListener){var e=d?4:1;a.addEventListener(b,c,d);c=new mb(a,b,c,e)}else a.attachEvent?(c=new mb(a,b,c,2),a.attachEvent("on"+b,nb(c))):(a["on"+b]=c,c=new mb(a,b,c,3));return c};_.B.addDomListenerOnce=function(a,b,c,d){var e=_.B.addDomListener(a,b,function(){e.remove();return c.apply(this,arguments)},d);return e};
_.B.W=function(a,b,c,d){return _.B.addDomListener(a,b,hb(c,d))};_.B.bind=function(a,b,c,d){return _.B.addListener(a,b,(0,_.u)(d,c))};_.B.addListenerOnce=function(a,b,c){var d=_.B.addListener(a,b,function(){d.remove();return c.apply(this,arguments)});return d};_.B.forward=function(a,b,c){return _.B.addListener(a,b,ib(b,c))};_.B.Ha=function(a,b,c,d){return _.B.addDomListener(a,b,ib(b,c,!d))};_.B.Oi=function(){var a=lb,b;for(b in a)a[b].remove();lb={};(a=_.Jc.CollectGarbage)&&a()};
_.B.ko=function(){kb&&_.B.addDomListener(window,"unload",_.B.Oi)};var jb=0;mb.prototype.remove=function(){if(this.Ra){switch(this.l){case 1:this.Ra.removeEventListener(this.f,this.b,!1);break;case 4:this.Ra.removeEventListener(this.f,this.b,!0);break;case 2:this.Ra.detachEvent("on"+this.f,this.j);break;case 3:this.Ra["on"+this.f]=null}delete fb(this.Ra,this.f)[this.id];this.j=this.b=this.Ra=null;delete lb[this.id]}};_.t=_.C.prototype;_.t.get=function(a){var b=tb(this);a+="";b=$a(b,a);if(_.Sa(b)){if(b){a=b.jb;var b=b.Ic,c="get"+_.sb(a);return b[c]?b[c]():b.get(a)}return this[a]}};_.t.set=function(a,b){var c=tb(this);a+="";var d=$a(c,a);if(d)if(a=d.jb,d=d.Ic,c="set"+_.sb(a),d[c])d[c](b);else d.set(a,b);else this[a]=b,c[a]=null,qb(this,a)};_.t.notify=function(a){var b=tb(this);a+="";(b=$a(b,a))?b.Ic.notify(b.jb):qb(this,a)};
_.t.setValues=function(a){for(var b in a){var c=a[b],d="set"+_.sb(b);if(this[d])this[d](c);else this.set(b,c)}};_.t.setOptions=_.C.prototype.setValues;_.t.changed=_.k();var rb={};_.C.prototype.bindTo=function(a,b,c,d){a+="";c=(c||a)+"";this.unbind(a);var e={Ic:this,jb:a},f={Ic:b,jb:c,gh:e};tb(this)[a]=f;pb(b,c)[_.ob(e)]=e;d||qb(this,a)};_.C.prototype.unbind=function(a){var b=tb(this),c=b[a];c&&(c.gh&&delete pb(c.Ic,c.jb)[_.ob(c.gh)],this[a]=this.get(a),b[a]=null)};
_.C.prototype.unbindAll=function(){var a=(0,_.u)(this.unbind,this),b=tb(this),c;for(c in b)a(c)};_.C.prototype.addListener=function(a,b){return _.B.addListener(this,a,b)};_.Zg={ROADMAP:"roadmap",SATELLITE:"satellite",HYBRID:"hybrid",TERRAIN:"terrain"};_.Ef={TOP_LEFT:1,TOP_CENTER:2,TOP:2,TOP_RIGHT:3,LEFT_CENTER:4,LEFT_TOP:5,LEFT:5,LEFT_BOTTOM:6,RIGHT_TOP:7,RIGHT:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM:11,BOTTOM_RIGHT:12,CENTER:13};var $g={Kp:"Point",Ip:"LineString",POLYGON:"Polygon"};_.v(ub,Error);var bh;_.oc=_.Cb(_.A,"not a number");_.ah=_.Cb(_.Ua,"not a string");bh=_.Cb(_.Va,"not a boolean");_.ch=_.Eb(_.oc);_.dh=_.Eb(_.ah);_.eh=_.Eb(bh);var Ub=_.xb({lat:_.oc,lng:_.oc},!0);_.H.prototype.toString=function(){return"("+this.lat()+", "+this.lng()+")"};_.H.prototype.toJSON=function(){return{lat:this.lat(),lng:this.lng()}};_.H.prototype.b=function(a){return a?_.Na(this.lat(),a.lat())&&_.Na(this.lng(),a.lng()):!1};_.H.prototype.equals=_.H.prototype.b;_.H.prototype.toUrlValue=function(a){a=_.Sa(a)?a:6;return Xb(this.lat(),a)+","+Xb(this.lng(),a)};_.Sd=_.Bb(_.Zb);_.v(_.$b,Yb);_.$b.prototype.getType=_.oa("Point");_.$b.prototype.forEachLatLng=function(a){a(this.b)};_.$b.prototype.get=_.m("b");var Qd=_.Bb(ac);_.ua(gc);gc.prototype.Pb=function(a,b){var c=this,d=c.m;hc(c.j,function(e){for(var f=e.Wh[a]||[],g=e.vo[a]||[],h=d[a]=_.bc(f.length,function(){delete d[a];b(e.ul);for(var f=c.f[a],h=f?f.length:0,l=0;l<h;++l)f[l](c.b[a]);delete c.f[a];l=0;for(f=g.length;l<f;++l)h=g[l],d[h]&&d[h]()}),l=0,n=f.length;l<n;++l)c.b[f[l]]&&h()})};_.t=_.nc.prototype;_.t.getId=_.m("j");_.t.getGeometry=_.m("b");_.t.setGeometry=function(a){var b=this.b;try{this.b=a?ac(a):null}catch(c){_.wb(c);return}_.B.trigger(this,"setgeometry",{feature:this,newGeometry:this.b,oldGeometry:b})};_.t.getProperty=function(a){return $a(this.f,a)};_.t.setProperty=function(a,b){if(void 0===b)this.removeProperty(a);else{var c=this.getProperty(a);this.f[a]=b;_.B.trigger(this,"setproperty",{feature:this,name:a,newValue:b,oldValue:c})}};
_.t.removeProperty=function(a){var b=this.getProperty(a);delete this.f[a];_.B.trigger(this,"removeproperty",{feature:this,name:a,oldValue:b})};_.t.forEachProperty=function(a){for(var b in this.f)a(this.getProperty(b),b)};_.t.toGeoJson=function(a){var b=this;_.J("data",function(c){c.f(b,a)})};_.fh=new _.L(0,0);_.L.prototype.toString=function(){return"("+this.x+", "+this.y+")"};_.L.prototype.b=function(a){return a?a.x==this.x&&a.y==this.y:!1};_.L.prototype.equals=_.L.prototype.b;_.L.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y)};_.L.prototype.ze=_.ra(0);_.gh=new _.M(0,0);_.M.prototype.toString=function(){return"("+this.width+", "+this.height+")"};_.M.prototype.b=function(a){return a?a.width==this.width&&a.height==this.height:!1};_.M.prototype.equals=_.M.prototype.b;var hh={CIRCLE:0,FORWARD_CLOSED_ARROW:1,FORWARD_OPEN_ARROW:2,BACKWARD_CLOSED_ARROW:3,BACKWARD_OPEN_ARROW:4};_.v(_.xc,_.C);_.t=_.xc.prototype;_.t.getAt=function(a){return this.b[a]};_.t.indexOf=function(a){for(var b=0,c=this.b.length;b<c;++b)if(a===this.b[b])return b;return-1};_.t.forEach=function(a){for(var b=0,c=this.b.length;b<c;++b)a(this.b[b],b)};_.t.setAt=function(a,b){var c=this.b[a],d=this.b.length;if(a<d)this.b[a]=b,_.B.trigger(this,"set_at",a,c),this.l&&this.l(a,c);else{for(c=d;c<a;++c)this.insertAt(c,void 0);this.insertAt(a,b)}};
_.t.insertAt=function(a,b){this.b.splice(a,0,b);wc(this);_.B.trigger(this,"insert_at",a);this.f&&this.f(a)};_.t.removeAt=function(a){var b=this.b[a];this.b.splice(a,1);wc(this);_.B.trigger(this,"remove_at",a,b);this.j&&this.j(a,b);return b};_.t.push=function(a){this.insertAt(this.b.length,a);return this.b.length};_.t.pop=function(){return this.removeAt(this.b.length-1)};_.t.getArray=_.m("b");_.t.clear=function(){for(;this.get("length");)this.pop()};_.tc(_.xc.prototype,{length:null});_.yc.prototype.remove=function(a){var b=this.f,c=this.j(a);b[c]&&(delete b[c],_.B.trigger(this,"remove",a),this.onRemove&&this.onRemove(a))};_.yc.prototype.contains=function(a){return!!this.f[this.j(a)]};_.yc.prototype.forEach=function(a){var b=this.f,c;for(c in b)a.call(this,b[c])};_.Ac.prototype.ab=_.ra(1);_.Ac.prototype.forEach=function(a,b){_.G(this.b,function(c,d){a.call(b,c,d)})};var ih=_.xb({zoom:_.ch,heading:_.oc,pitch:_.oc});_.v(_.Cc,_.C);var jh=function(a){return function(){return a}}(null);a:{var kh=_.Jc.navigator;if(kh){var lh=kh.userAgent;if(lh){_.Jb=lh;break a}}_.Jb=""};var Nc,Mc=_.Dc;Qc.prototype.get=function(){var a;0<this.f?(this.f--,a=this.b,this.b=a.next,a.next=null):a=this.j();return a};var mh=new Qc(function(){return new Sc},function(a){a.reset()},100);Rc.prototype.add=function(a,b){var c=mh.get();c.set(a,b);this.f?this.f.next=c:this.b=c;this.f=c};Rc.prototype.remove=function(){var a=null;this.b&&(a=this.b,this.b=this.b.next,this.b||(this.f=null),a.next=null);return a};Sc.prototype.set=function(a,b){this.Dc=a;this.b=b;this.next=null};Sc.prototype.reset=function(){this.next=this.b=this.Dc=null};_.Lc.m=function(){if(_.Jc.Promise&&_.Jc.Promise.resolve){var a=_.Jc.Promise.resolve(void 0);_.Lc.b=function(){a.then(_.Lc.f)}}else _.Lc.b=function(){Pc()}};_.Lc.C=function(a){_.Lc.b=function(){Pc();a&&a(_.Lc.f)}};_.Lc.j=!1;_.Lc.l=new Rc;_.Lc.f=function(){for(var a;a=_.Lc.l.remove();){try{a.Dc.call(a.b)}catch(c){Kc(c)}var b=mh;b.m(a);b.f<b.l&&(b.f++,a.next=b.b,b.b=a)}_.Lc.j=!1};Uc.prototype.addListener=function(a,b,c){c=c?{jh:!1}:null;var d=!this.T.length,e;e=this.T;var f=Pb(e,Tc(a,b));(e=0>f?null:_.xa(e)?e.charAt(f):e[f])?e.Bd=e.Bd&&c:this.T.push({Dc:a,context:b||null,Bd:c});d&&this.f();return a};Uc.prototype.addListenerOnce=function(a,b){this.addListener(a,b,!0);return a};Uc.prototype.removeListener=function(a,b){if(this.T.length){var c=this.T;a=Pb(c,Tc(a,b));0<=a&&_.Qb(c,a);this.T.length||this.b()}};var Vc=_.Lc;_.t=_.Xc.prototype;_.t.Ad=_.k();_.t.yd=_.k();_.t.addListener=function(a,b){return this.T.addListener(a,b)};_.t.addListenerOnce=function(a,b){return this.T.addListenerOnce(a,b)};_.t.removeListener=function(a,b){return this.T.removeListener(a,b)};_.t.notify=function(a){_.Wc(this.T,function(a){a(this.get())},this,a)};_.v(_.ad,_.Xc);_.ad.prototype.set=function(a){this.yi(a);this.notify()};_.v(_.bd,_.ad);_.bd.prototype.get=_.m("b");_.bd.prototype.yi=_.ma("b");_.v(cd,_.C);_.nh=_.id("d",void 0);_.oh=_.kd("d");_.ph=_.id("f",void 0);_.Q=_.ld();_.qh=_.jd("i",void 0);_.rh=_.kd("i");_.sh=_.kd("j");_.th=_.id("u",void 0);_.uh=_.jd("u",void 0);_.vh=_.kd("u");_.wh=_.md();_.R=_.nd();_.S=_.od();_.xh=_.kd("e");_.T=_.id("s",void 0);_.yh=_.jd("s",void 0);_.zh=_.kd("s");_.Ah=_.id("x",void 0);_.Bh=_.jd("x",void 0);_.Ch=_.kd("x");_.Dh=_.kd("y");var Fh;_.Eh=new pd;Fh=/'/g;pd.prototype.b=function(a,b){var c=[];rd(a,b,c);return c.join("&").replace(Fh,"%27")};var Sh,ud,Wh;_.Gh=_.Gc("Opera");_.Hh=_.Hc();_.Ih=_.Gc("Edge");_.Jh=_.Gc("Gecko")&&!(_.Kb()&&!_.Gc("Edge"))&&!(_.Gc("Trident")||_.Gc("MSIE"))&&!_.Gc("Edge");_.Kh=_.Kb()&&!_.Gc("Edge");_.Lh=_.Gc("Macintosh");_.Mh=_.Gc("Windows");_.Nh=_.Gc("Linux")||_.Gc("CrOS");_.Oh=_.Gc("Android");_.Ph=_.sd();_.Qh=_.Gc("iPad");_.Rh=_.Gc("iPod");
a:{var Th="",Uh=function(){var a=_.Jb;if(_.Jh)return/rv\:([^\);]+)(\)|;)/.exec(a);if(_.Ih)return/Edge\/([\d\.]+)/.exec(a);if(_.Hh)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(_.Kh)return/WebKit\/(\S+)/.exec(a);if(_.Gh)return/(?:Version)[ \/]?(\S+)/.exec(a)}();Uh&&(Th=Uh?Uh[1]:"");if(_.Hh){var Vh=td();if(null!=Vh&&Vh>(0,window.parseFloat)(Th)){Sh=String(Vh);break a}}Sh=Th}_.vd=Sh;ud={};Wh=_.Jc.document;_.Xh=Wh&&_.Hh?td()||("CSS1Compat"==Wh.compatMode?(0,window.parseInt)(_.vd,10):5):void 0;_.Yh=_.Gc("Firefox");_.Zh=_.sd()||_.Gc("iPod");_.$h=_.Gc("iPad");_.ai=_.Gc("Android")&&!(Ic()||_.Gc("Firefox")||_.Gc("Opera")||_.Gc("Silk"));_.bi=Ic();_.ci=_.Gc("Safari")&&!(Ic()||_.Gc("Coast")||_.Gc("Opera")||_.Gc("Edge")||_.Gc("Silk")||_.Gc("Android"))&&!(_.sd()||_.Gc("iPad")||_.Gc("iPod"));_.xd.prototype.heading=_.m("b");_.xd.prototype.Ja=_.ra(2);_.xd.prototype.toString=function(){return this.b+","+this.f};_.di=new _.xd;_.v(yd,_.C);yd.prototype.set=function(a,b){if(null!=b&&!(b&&_.A(b.maxZoom)&&b.tileSize&&b.tileSize.width&&b.tileSize.height&&b.getTile&&b.getTile.apply))throw Error("Expected value implementing google.maps.MapType");return _.C.prototype.set.apply(this,arguments)};_.t=zd.prototype;_.t.isEmpty=function(){return 360==this.b-this.f};_.t.intersects=function(a){var b=this.b,c=this.f;return this.isEmpty()||a.isEmpty()?!1:_.Ad(this)?_.Ad(a)||a.b<=this.f||a.f>=b:_.Ad(a)?a.b<=c||a.f>=b:a.b<=c&&a.f>=b};_.t.contains=function(a){-180==a&&(a=180);var b=this.b,c=this.f;return _.Ad(this)?(a>=b||a<=c)&&!this.isEmpty():a>=b&&a<=c};_.t.extend=function(a){this.contains(a)||(this.isEmpty()?this.b=this.f=a:_.Dd(a,this.b)<_.Dd(this.f,a)?this.b=a:this.f=a)};
_.t.Hb=function(){var a=(this.b+this.f)/2;_.Ad(this)&&(a=_.Ma(a+180,-180,180));return a};_.t=Ed.prototype;_.t.isEmpty=function(){return this.f>this.b};_.t.intersects=function(a){var b=this.f,c=this.b;return b<=a.f?a.f<=c&&a.f<=a.b:b<=a.b&&b<=c};_.t.contains=function(a){return a>=this.f&&a<=this.b};_.t.extend=function(a){this.isEmpty()?this.b=this.f=a:a<this.f?this.f=a:a>this.b&&(this.b=a)};_.t.Hb=function(){return(this.b+this.f)/2};_.t=_.Gd.prototype;_.t.getCenter=function(){return new _.H(this.f.Hb(),this.b.Hb())};_.t.toString=function(){return"("+this.getSouthWest()+", "+this.getNorthEast()+")"};_.t.toJSON=function(){return{south:this.f.f,west:this.b.b,north:this.f.b,east:this.b.f}};_.t.toUrlValue=function(a){var b=this.getSouthWest(),c=this.getNorthEast();return[b.toUrlValue(a),c.toUrlValue(a)].join()};
_.t.Aj=function(a){if(!a)return!1;a=_.Jd(a);var b=this.f,c=a.f;return(b.isEmpty()?c.isEmpty():1E-9>=Math.abs(c.f-b.f)+Math.abs(b.b-c.b))&&_.Cd(this.b,a.b)};_.Gd.prototype.equals=_.Gd.prototype.Aj;_.t=_.Gd.prototype;_.t.contains=function(a){return this.f.contains(a.lat())&&this.b.contains(a.lng())};_.t.intersects=function(a){a=_.Jd(a);return this.f.intersects(a.f)&&this.b.intersects(a.b)};_.t.extend=function(a){this.f.extend(a.lat());this.b.extend(a.lng());return this};
_.t.union=function(a){a=_.Jd(a);if(!a||a.isEmpty())return this;this.extend(a.getSouthWest());this.extend(a.getNorthEast());return this};_.t.getSouthWest=function(){return new _.H(this.f.f,this.b.b,!0)};_.t.getNorthEast=function(){return new _.H(this.f.b,this.b.f,!0)};_.t.toSpan=function(){return new _.H(_.Fd(this.f),_.Bd(this.b),!0)};_.t.isEmpty=function(){return this.f.isEmpty()||this.b.isEmpty()};var Id=_.xb({south:_.oc,west:_.oc,north:_.oc,east:_.oc},!1);_.v(_.Kd,_.C);_.t=Ld.prototype;_.t.contains=function(a){return this.b.hasOwnProperty(_.ob(a))};_.t.getFeatureById=function(a){return $a(this.f,a)};
_.t.add=function(a){a=a||{};a=a instanceof _.nc?a:new _.nc(a);if(!this.contains(a)){var b=a.getId();if(b){var c=this.getFeatureById(b);c&&this.remove(c)}c=_.ob(a);this.b[c]=a;b&&(this.f[b]=a);var d=_.B.forward(a,"setgeometry",this),e=_.B.forward(a,"setproperty",this),f=_.B.forward(a,"removeproperty",this);this.j[c]=function(){_.B.removeListener(d);_.B.removeListener(e);_.B.removeListener(f)};_.B.trigger(this,"addfeature",{feature:a})}return a};
_.t.remove=function(a){var b=_.ob(a),c=a.getId();if(this.b[b]){delete this.b[b];c&&delete this.f[c];if(c=this.j[b])delete this.j[b],c();_.B.trigger(this,"removefeature",{feature:a})}};_.t.forEach=function(a){for(var b in this.b)a(this.b[b])};Od.prototype.get=function(a){return this.b[a]};Od.prototype.set=function(a,b){var c=this.b;c[a]||(c[a]={});_.Ja(c[a],b);_.B.trigger(this,"changed",a)};Od.prototype.reset=function(a){delete this.b[a];_.B.trigger(this,"changed",a)};Od.prototype.forEach=function(a){_.Ia(this.b,a)};_.v(Pd,_.C);Pd.prototype.overrideStyle=function(a,b){this.b.set(_.ob(a),b)};Pd.prototype.revertStyle=function(a){a?this.b.reset(_.ob(a)):this.b.forEach((0,_.u)(this.b.reset,this.b))};_.v(_.Rd,Yb);_.t=_.Rd.prototype;_.t.getType=_.oa("GeometryCollection");_.t.getLength=function(){return this.b.length};_.t.getAt=function(a){return this.b[a]};_.t.getArray=function(){return this.b.slice()};_.t.forEachLatLng=function(a){this.b.forEach(function(b){b.forEachLatLng(a)})};_.v(_.Td,Yb);_.t=_.Td.prototype;_.t.getType=_.oa("LineString");_.t.getLength=function(){return this.b.length};_.t.getAt=function(a){return this.b[a]};_.t.getArray=function(){return this.b.slice()};_.t.forEachLatLng=function(a){this.b.forEach(a)};var Ud=_.Bb(_.zb(_.Td,"google.maps.Data.LineString",!0));_.v(_.Vd,Yb);_.t=_.Vd.prototype;_.t.getType=_.oa("MultiLineString");_.t.getLength=function(){return this.b.length};_.t.getAt=function(a){return this.b[a]};_.t.getArray=function(){return this.b.slice()};_.t.forEachLatLng=function(a){this.b.forEach(function(b){b.forEachLatLng(a)})};_.v(_.Wd,Yb);_.t=_.Wd.prototype;_.t.getType=_.oa("MultiPoint");_.t.getLength=function(){return this.b.length};_.t.getAt=function(a){return this.b[a]};_.t.getArray=function(){return this.b.slice()};_.t.forEachLatLng=function(a){this.b.forEach(a)};_.v(_.Xd,Yb);_.t=_.Xd.prototype;_.t.getType=_.oa("LinearRing");_.t.getLength=function(){return this.b.length};_.t.getAt=function(a){return this.b[a]};_.t.getArray=function(){return this.b.slice()};_.t.forEachLatLng=function(a){this.b.forEach(a)};var Yd=_.Bb(_.zb(_.Xd,"google.maps.Data.LinearRing",!0));_.v(_.Zd,Yb);_.t=_.Zd.prototype;_.t.getType=_.oa("Polygon");_.t.getLength=function(){return this.b.length};_.t.getAt=function(a){return this.b[a]};_.t.getArray=function(){return this.b.slice()};_.t.forEachLatLng=function(a){this.b.forEach(function(b){b.forEachLatLng(a)})};var $d=_.Bb(_.zb(_.Zd,"google.maps.Data.Polygon",!0));_.v(_.ae,Yb);_.t=_.ae.prototype;_.t.getType=_.oa("MultiPolygon");_.t.getLength=function(){return this.b.length};_.t.getAt=function(a){return this.b[a]};_.t.getArray=function(){return this.b.slice()};_.t.forEachLatLng=function(a){this.b.forEach(function(b){b.forEachLatLng(a)})};var ei=_.xb({source:_.ah,webUrl:_.dh,iosDeepLinkId:_.dh});var fi=_.Ha(_.xb({placeId:_.dh,query:_.dh,location:_.Zb}),function(a){if(a.placeId&&a.query)throw _.vb("cannot set both placeId and query");if(!a.placeId&&!a.query)throw _.vb("must set one of placeId or query");return a});_.v(be,_.C);
_.tc(be.prototype,{position:_.Eb(_.Zb),title:_.dh,icon:_.Eb(_.Db(_.ah,{Ag:Hb("url"),then:_.xb({url:_.ah,scaledSize:_.Eb(qc),size:_.Eb(qc),origin:_.Eb(pc),anchor:_.Eb(pc),labelOrigin:_.Eb(pc),path:_.Cb(Ra)},!0)},{Ag:Hb("path"),then:_.xb({path:_.Db(_.ah,_.Ab(hh)),anchor:_.Eb(pc),labelOrigin:_.Eb(pc),fillColor:_.dh,fillOpacity:_.ch,rotation:_.ch,scale:_.ch,strokeColor:_.dh,strokeOpacity:_.ch,strokeWeight:_.ch,url:_.Cb(Ra)},!0)})),label:_.Eb(_.Db(_.ah,{Ag:Hb("text"),then:_.xb({text:_.ah,fontSize:_.dh,fontWeight:_.dh,
fontFamily:_.dh},!0)})),shadow:_.Dc,shape:_.Dc,cursor:_.dh,clickable:_.eh,animation:_.Dc,draggable:_.eh,visible:_.eh,flat:_.Dc,zIndex:_.ch,opacity:_.ch,place:_.Eb(fi),attribution:_.Eb(ei)});var jc={main:[],common:["main"],util:["common"],adsense:["main"],controls:["util"],data:["util"],directions:["util","geometry"],distance_matrix:["util"],drawing:["main"],drawing_impl:["controls"],elevation:["util","geometry"],geocoder:["util"],geojson:["main"],imagery_viewer:["main"],geometry:["main"],infowindow:["util"],kml:["onion","util","map"],layers:["map"],map:["common"],marker:["util"],maxzoom:["util"],onion:["util","map"],overlay:["common"],panoramio:["main"],places:["main"],places_impl:["controls"],
poly:["util","map","geometry"],search:["main"],search_impl:["onion"],stats:["util"],streetview:["util","geometry"],usage:["util"],visualization:["main"],visualization_impl:["onion"],weather:["main"],zombie:["main"]};var gi=_.Jc.google.maps,hi=gc.Jb(),ii=(0,_.u)(hi.Pb,hi);gi.__gjsload__=ii;_.Ia(gi.modules,ii);delete gi.modules;_.ji=_.Eb(_.zb(_.Kd,"Map"));var ki=_.Eb(_.zb(_.Cc,"StreetViewPanorama"));_.v(_.de,be);_.de.prototype.map_changed=function(){this.__gm.set&&this.__gm.set.remove(this);var a=this.get("map");this.__gm.set=a&&a.__gm.Hc;this.__gm.set&&_.zc(this.__gm.set,this)};_.de.MAX_ZINDEX=1E6;_.tc(_.de.prototype,{map:_.Db(_.ji,ki)});var he=je(_.zb(_.H,"LatLng"));_.v(le,_.C);le.prototype.map_changed=le.prototype.visible_changed=function(){var a=this;_.J("poly",function(b){b.f(a)})};le.prototype.getPath=function(){return this.get("latLngs").getAt(0)};le.prototype.setPath=function(a){try{this.get("latLngs").setAt(0,ie(a))}catch(b){_.wb(b)}};_.tc(le.prototype,{draggable:_.eh,editable:_.eh,map:_.ji,visible:_.eh});_.v(_.me,le);_.me.prototype.Aa=!0;_.me.prototype.getPaths=function(){return this.get("latLngs")};_.me.prototype.setPaths=function(a){this.set("latLngs",ke(a))};_.v(_.ne,le);_.ne.prototype.Aa=!1;_.re="click dblclick mousedown mousemove mouseout mouseover mouseup rightclick".split(" ");_.v(se,_.C);_.t=se.prototype;_.t.contains=function(a){return this.b.contains(a)};_.t.getFeatureById=function(a){return this.b.getFeatureById(a)};_.t.add=function(a){return this.b.add(a)};_.t.remove=function(a){this.b.remove(a)};_.t.forEach=function(a){this.b.forEach(a)};_.t.addGeoJson=function(a,b){return _.qe(this.b,a,b)};_.t.loadGeoJson=function(a,b,c){var d=this.b;_.J("data",function(e){e.Sl(d,a,b,c)})};_.t.toGeoJson=function(a){var b=this.b;_.J("data",function(c){c.Ol(b,a)})};
_.t.overrideStyle=function(a,b){this.f.overrideStyle(a,b)};_.t.revertStyle=function(a){this.f.revertStyle(a)};_.t.controls_changed=function(){this.get("controls")&&te(this)};_.t.drawingMode_changed=function(){this.get("drawingMode")&&te(this)};_.tc(se.prototype,{map:_.ji,style:_.Dc,controls:_.Eb(_.Bb(_.Ab($g))),controlPosition:_.Eb(_.Ab(_.Ef)),drawingMode:_.Eb(_.Ab($g))});_.ue.prototype.B=_.m("b");_.ve.prototype.B=_.m("b");_.li=new _.ue;_.mi=new _.ue;we.prototype.B=_.m("b");_.ni=new _.xe;_.xe.prototype.B=_.m("b");_.oi=new _.ue;_.pi=new we;_.ye.prototype.B=_.m("b");_.qi=new _.ve;_.ri=new _.ye;_.si={METRIC:0,IMPERIAL:1};_.ti={DRIVING:"DRIVING",WALKING:"WALKING",BICYCLING:"BICYCLING",TRANSIT:"TRANSIT"};_.ui={BEST_GUESS:"bestguess",OPTIMISTIC:"optimistic",PESSIMISTIC:"pessimistic"};_.vi={BUS:"BUS",RAIL:"RAIL",SUBWAY:"SUBWAY",TRAIN:"TRAIN",TRAM:"TRAM"};_.wi={LESS_WALKING:"LESS_WALKING",FEWER_TRANSFERS:"FEWER_TRANSFERS"};var xi=_.xb({routes:_.Bb(_.Cb(_.Ta))},!0);_.v(Ae,_.C);_.t=Ae.prototype;_.t.internalAnchor_changed=function(){var a=this.get("internalAnchor");Be(this,"attribution",a);Be(this,"place",a);Be(this,"internalAnchorMap",a,"map");Be(this,"internalAnchorPoint",a,"anchorPoint");a instanceof _.de?Be(this,"internalAnchorPosition",a,"internalPosition"):Be(this,"internalAnchorPosition",a,"position")};
_.t.internalAnchorPoint_changed=Ae.prototype.internalPixelOffset_changed=function(){var a=this.get("internalAnchorPoint")||_.fh,b=this.get("internalPixelOffset")||_.gh;this.set("pixelOffset",new _.M(b.width+Math.round(a.x),b.height+Math.round(a.y)))};_.t.internalAnchorPosition_changed=function(){var a=this.get("internalAnchorPosition");a&&this.set("position",a)};_.t.internalAnchorMap_changed=function(){this.get("internalAnchor")&&this.b.set("map",this.get("internalAnchorMap"))};
_.t.vn=function(){var a=this.get("internalAnchor");!this.b.get("map")&&a&&a.get("map")&&this.set("internalAnchor",null)};_.t.internalContent_changed=function(){this.set("content",ze(this.get("internalContent")))};_.t.trigger=function(a){_.B.trigger(this.b,a)};_.t.close=function(){this.b.set("map",null)};_.v(_.Ce,_.C);_.tc(_.Ce.prototype,{content:_.Db(_.dh,_.Cb(yb)),position:_.Eb(_.Zb),size:_.Eb(qc),map:_.Db(_.ji,ki),anchor:_.Eb(_.zb(_.C,"MVCObject")),zIndex:_.ch});_.Ce.prototype.open=function(a,b){this.set("anchor",b);b?!this.get("map")&&a&&this.set("map",a):this.set("map",a)};_.Ce.prototype.close=function(){this.set("map",null)};_.De=[];_.v(Fe,_.C);Fe.prototype.changed=function(a){if("map"==a||"panel"==a){var b=this;_.J("directions",function(c){c.wm(b,a)})}"panel"==a&&_.Ee(this.getPanel())};_.tc(Fe.prototype,{directions:xi,map:_.ji,panel:_.Eb(_.Cb(yb)),routeIndex:_.ch});Ge.prototype.route=function(a,b){_.J("directions",function(c){c.vi(a,b,!0)})};He.prototype.getDistanceMatrix=function(a,b){_.J("distance_matrix",function(c){c.b(a,b)})};Ie.prototype.getElevationAlongPath=function(a,b){_.J("elevation",function(c){c.getElevationAlongPath(a,b)})};Ie.prototype.getElevationForLocations=function(a,b){_.J("elevation",function(c){c.getElevationForLocations(a,b)})};_.yi=_.zb(_.Gd,"LatLngBounds");_.Je.prototype.geocode=function(a,b){_.J("geocoder",function(c){c.geocode(a,b)})};_.v(_.Ke,_.C);_.Ke.prototype.map_changed=function(){var a=this;_.J("kml",function(b){b.b(a)})};_.tc(_.Ke.prototype,{map:_.ji,url:null,bounds:null,opacity:_.ch});_.Ai={UNKNOWN:"UNKNOWN",OK:_.ga,INVALID_REQUEST:_.ba,DOCUMENT_NOT_FOUND:"DOCUMENT_NOT_FOUND",FETCH_ERROR:"FETCH_ERROR",INVALID_DOCUMENT:"INVALID_DOCUMENT",DOCUMENT_TOO_LARGE:"DOCUMENT_TOO_LARGE",LIMITS_EXCEEDED:"LIMITS_EXECEEDED",TIMED_OUT:"TIMED_OUT"};_.v(Le,_.C);_.t=Le.prototype;_.t.Qd=function(){var a=this;_.J("kml",function(b){b.f(a)})};_.t.url_changed=Le.prototype.Qd;_.t.driveFileId_changed=Le.prototype.Qd;_.t.map_changed=Le.prototype.Qd;_.t.zIndex_changed=Le.prototype.Qd;_.tc(Le.prototype,{map:_.ji,defaultViewport:null,metadata:null,status:null,url:_.dh,screenOverlays:_.eh,zIndex:_.ch});_.v(_.Me,_.C);_.tc(_.Me.prototype,{map:_.ji});_.v(Ne,_.C);_.tc(Ne.prototype,{map:_.ji});_.v(Oe,_.C);_.tc(Oe.prototype,{map:_.ji});_.Df={japan_prequake:20,japan_postquake2010:24};_.Bi={NEAREST:"nearest",BEST:"best"};_.Ci={DEFAULT:"default",OUTDOOR:"outdoor"};var Di,Ei,Fi,Gi;Pe.prototype.B=_.m("b");var Hi=new Qe,Ii=new Re,Ji=new Se;Qe.prototype.B=_.m("b");Re.prototype.B=_.m("b");Se.prototype.B=_.m("b");_.Te.prototype.B=_.m("b");_.Ki=new _.Te;_.Li=new _.Te;var vf,wf,pf,yf,Bf;_.Ue.prototype.B=_.m("b");_.Ue.prototype.getUrl=function(a){return _.N(this.b,0)[a]};_.Ue.prototype.setUrl=function(a,b){_.N(this.b,0)[a]=b};_.Ve.prototype.B=_.m("b");_.We.prototype.B=_.m("b");_.Mi=new _.Ue;_.Ni=new _.Ue;_.Oi=new _.Ue;_.Pi=new _.Ue;_.Qi=new _.Ue;Xe.prototype.B=_.m("b");af.prototype.B=_.m("b");bf.prototype.B=_.m("b");cf.prototype.B=_.m("b");_.Ri=new _.We;_.Si=new _.Ve;vf=new Xe;wf=new af;pf=new bf;_.Ti=new _.ef;_.Ui=new _.ff;yf=new Pe;Bf=new df;df.prototype.B=_.m("b");
_.ef.prototype.B=_.m("b");_.ff.prototype.B=_.m("b");_.v(Ff,_.Cc);Ff.prototype.visible_changed=function(){var a=this;!a.C&&a.getVisible()&&(a.C=!0,_.J("streetview",function(b){var c;a.j&&(c=a.j);b.Pn(a,c)}))};_.tc(Ff.prototype,{visible:_.eh,pano:_.dh,position:_.Eb(_.Zb),pov:_.Eb(ih),photographerPov:null,location:null,links:_.Bb(_.Cb(_.Ta)),status:null,zoom:_.ch,enableCloseButton:_.eh});Ff.prototype.registerPanoProvider=_.sc("panoProvider");_.t=_.Gf.prototype;_.t.Zd=_.ra(3);_.t.sb=_.ra(4);_.t.Kd=_.ra(5);_.t.Jd=_.ra(6);_.t.Id=_.ra(7);_.v(Hf,cd);_.If.prototype.addListener=function(a,b){this.T.addListener(a,b)};_.If.prototype.addListenerOnce=function(a,b){this.T.addListenerOnce(a,b)};_.If.prototype.removeListener=function(a,b){this.T.removeListener(a,b)};_.If.prototype.b=_.ra(8);_.cg={};_.Jf.prototype.fromLatLngToPoint=function(a,b){b=b||new _.L(0,0);var c=this.b;b.x=c.x+a.lng()*this.j;a=_.La(Math.sin(_.Sb(a.lat())),-(1-1E-15),1-1E-15);b.y=c.y+.5*Math.log((1+a)/(1-a))*-this.l;return b};_.Jf.prototype.fromPointToLatLng=function(a,b){var c=this.b;return new _.H(_.Tb(2*Math.atan(Math.exp((a.y-c.y)/-this.l))-Math.PI/2),(a.x-c.x)/this.j,b)};_.Kf.prototype.isEmpty=function(){return!(this.M<this.O&&this.L<this.R)};_.Kf.prototype.extend=function(a){a&&(this.M=Math.min(this.M,a.x),this.O=Math.max(this.O,a.x),this.L=Math.min(this.L,a.y),this.R=Math.max(this.R,a.y))};_.Kf.prototype.getCenter=function(){return new _.L((this.M+this.O)/2,(this.L+this.R)/2)};_.Vi=_.Lf(-window.Infinity,-window.Infinity,window.Infinity,window.Infinity);_.Wi=_.Lf(0,0,0,0);_.v(_.Pf,_.C);_.Pf.prototype.N=function(){var a=this;a.G||(a.G=window.setTimeout(function(){a.G=void 0;a.Z()},a.ol))};_.Pf.prototype.C=function(){this.G&&window.clearTimeout(this.G);this.G=void 0;this.Z()};var Xi,ej;Sf.prototype.B=_.m("b");Tf.prototype.B=_.m("b");var fj=new Sf;var gj,hj;Uf.prototype.B=_.m("b");Vf.prototype.B=_.m("b");var ij;Wf.prototype.B=_.m("b");Wf.prototype.getZoom=function(){var a=this.b[2];return null!=a?a:0};Wf.prototype.setZoom=function(a){this.b[2]=a};var jj=new Uf,kj=new Vf,lj=new Tf,mj=new Pe;_.v(Xf,_.Pf);var Yf={roadmap:0,satellite:2,hybrid:3,terrain:4},nj={0:1,2:2,3:2,4:2};_.t=Xf.prototype;_.t.Ah=_.rc("center");_.t.Pg=_.rc("zoom");_.t.changed=function(){var a=this.Ah(),b=this.Pg(),c=Zf(this);if(a&&!a.b(this.I)||this.H!=b||this.K!=c)$f(this.f),this.N(),this.H=b,this.K=c;this.I=a};
_.t.Z=function(){var a="",b=this.Ah(),c=this.Pg(),d=Zf(this),e=this.get("size");if(b&&(0,window.isFinite)(b.lat())&&(0,window.isFinite)(b.lng())&&1<c&&null!=d&&e&&e.width&&e.height&&this.b){_.Qf(this.b,e);var f;(b=_.Nf(this.l,b,c))?(f=new _.Kf,f.M=Math.round(b.x-e.width/2),f.O=f.M+e.width,f.L=Math.round(b.y-e.height/2),f.R=f.L+e.height):f=null;b=nj[d];if(f){var a=new Wf,g;a.b[0]=a.b[0]||[];g=new Uf(a.b[0]);g.b[0]=f.M;g.b[1]=f.L;a.b[1]=b;a.setZoom(c);a.b[3]=a.b[3]||[];c=new Vf(a.b[3]);c.b[0]=f.O-f.M;
c.b[1]=f.R-f.L;a.b[4]=a.b[4]||[];c=new Tf(a.b[4]);c.b[0]=d;c.b[4]=_.gf(_.jf(_.P));c.b[5]=_.hf(_.jf(_.P)).toLowerCase();c.b[9]=!0;c.b[11]=!0;d=this.D+(0,window.unescape)("%3F");if(!ij){c=ij={F:-1,A:[]};gj||(gj={F:-1,A:[,_.Q,_.Q]});b=_.O(jj,gj);hj||(hj={F:-1,A:[]},hj.A=[,_.th,_.th,_.od(1)]);f=_.O(kj,hj);ej||(g=[],ej={F:-1,A:g},g[1]=_.S,g[2]=_.R,g[3]=_.R,g[5]=_.T,g[6]=_.T,Xi||(Xi={F:-1,A:[,_.xh,_.R]}),g[9]=_.O(fj,Xi),g[10]=_.R,g[11]=_.R,g[12]=_.R,g[100]=_.R);g=_.O(lj,ej);if(!Di){var h=Di={F:-1,A:[]};
Ei||(Ei={F:-1,A:[,_.R]});var l=_.O(Hi,Ei);Gi||(Gi={F:-1,A:[,_.R,_.R]});var n=_.O(Ji,Gi);Fi||(Fi={F:-1,A:[,_.R]});h.A=[,l,,,,,,,,,n,,_.O(Ii,Fi)]}c.A=[,b,_.S,_.th,f,g,_.O(mj,Di)]}a=_.Eh.b(a.b,ij);a=this.m(d+a)}}this.f&&e&&(_.Qf(this.f,e),bg(this,a))};
_.t.div_changed=function(){var a=this.get("div"),b=this.b;if(a)if(b)a.appendChild(b);else{b=this.b=window.document.createElement("div");b.style.overflow="hidden";var c=this.f=window.document.createElement("img");_.B.addDomListener(b,"contextmenu",function(a){_.cb(a);_.eb(a)});c.ontouchstart=c.ontouchmove=c.ontouchend=c.ontouchcancel=function(a){_.db(a);_.eb(a)};_.Qf(c,_.gh);a.appendChild(b);this.Z()}else b&&($f(b),this.b=null)};var jg;_.xg="StopIteration"in _.Jc?_.Jc.StopIteration:{message:"StopIteration",stack:""};_.lg.prototype.next=function(){throw _.xg;};_.lg.prototype.mf=function(){return this};_.mg.prototype.Rf=!0;_.mg.prototype.Kb=_.ra(10);_.mg.prototype.Nh=!0;_.mg.prototype.oe=_.ra(12);_.ng("about:blank");_.pg.prototype.Nh=!0;_.pg.prototype.oe=_.ra(11);_.pg.prototype.Rf=!0;_.pg.prototype.Kb=_.ra(9);_.og={};_.qg("<!DOCTYPE html>",0);_.qg("",0);_.qg("<br>",0);!_.Jh&&!_.Hh||_.Hh&&9<=Number(_.Xh)||_.Jh&&_.wd("1.9.1");_.Hh&&_.wd("9");_.v(tg,_.lg);tg.prototype.setPosition=function(a,b,c){if(this.node=a)this.f=_.ya(b)?b:1!=this.node.nodeType?0:this.b?-1:1;_.ya(c)&&(this.depth=c)};
tg.prototype.next=function(){var a;if(this.j){if(!this.node||this.l&&0==this.depth)throw _.xg;a=this.node;var b=this.b?-1:1;if(this.f==b){var c=this.b?a.lastChild:a.firstChild;c?this.setPosition(c):this.setPosition(a,-1*b)}else(c=this.b?a.previousSibling:a.nextSibling)?this.setPosition(c):this.setPosition(a.parentNode,-1*b);this.depth+=this.f*(this.b?-1:1)}else this.j=!0;a=this.node;if(!this.node)throw _.xg;return a};
tg.prototype.splice=function(a){var b=this.node,c=this.b?1:-1;this.f==c&&(this.f=-1*c,this.depth+=this.f*(this.b?-1:1));this.b=!this.b;tg.prototype.next.call(this);this.b=!this.b;for(var c=_.wa(arguments[0])?arguments[0]:arguments,d=c.length-1;0<=d;d--)_.rg(c[d],b);_.sg(b)};_.v(ug,tg);ug.prototype.next=function(){do ug.Ab.next.call(this);while(-1==this.f);return this.node};_.pj=_.Jc.document&&_.Jc.document.createElement("div");_.v(Ag,_.Kd);_.t=Ag.prototype;_.t.streetView_changed=function(){this.get("streetView")||this.set("streetView",this.__gm.j)};_.t.getDiv=function(){return this.__gm.V};_.t.panBy=function(a,b){var c=this.__gm;_.J("map",function(){_.B.trigger(c,"panby",a,b)})};_.t.panTo=function(a){var b=this.__gm;a=_.Zb(a);_.J("map",function(){_.B.trigger(b,"panto",a)})};_.t.panToBounds=function(a){var b=this.__gm,c=_.Jd(a);_.J("map",function(){_.B.trigger(b,"pantolatlngbounds",c)})};
_.t.fitBounds=function(a){var b=this;a=_.Jd(a);_.J("map",function(c){c.fitBounds(b,a)})};_.tc(Ag.prototype,{bounds:null,streetView:ki,center:_.Eb(_.Zb),zoom:_.ch,mapTypeId:_.dh,projection:null,heading:_.ch,tilt:_.ch,clickableIcons:bh});Bg.prototype.getMaxZoomAtLatLng=function(a,b){_.J("maxzoom",function(c){c.getMaxZoomAtLatLng(a,b)})};_.v(Cg,_.C);Cg.prototype.changed=function(a){if("suppressInfoWindows"!=a&&"clickable"!=a){var b=this;_.J("onion",function(a){a.b(b)})}};_.tc(Cg.prototype,{map:_.ji,tableId:_.ch,query:_.Eb(_.Db(_.ah,_.Cb(_.Ta,"not an Object")))});_.v(_.Dg,_.C);_.Dg.prototype.map_changed=function(){var a=this;_.J("overlay",function(b){b.Vk(a)})};_.tc(_.Dg.prototype,{panes:null,projection:null,map:_.Db(_.ji,ki)});_.v(_.Eg,_.C);_.Eg.prototype.map_changed=_.Eg.prototype.visible_changed=function(){var a=this;_.J("poly",function(b){b.b(a)})};_.Eg.prototype.center_changed=function(){_.B.trigger(this,"bounds_changed")};_.Eg.prototype.radius_changed=_.Eg.prototype.center_changed;_.Eg.prototype.getBounds=function(){var a=this.get("radius"),b=this.get("center");if(b&&_.A(a)){var c=this.get("map"),c=c&&c.__gm.get("mapType");return _.Of(b,a/_.fe(c))}return null};
_.tc(_.Eg.prototype,{center:_.Eb(_.Zb),draggable:_.eh,editable:_.eh,map:_.ji,radius:_.ch,visible:_.eh});_.v(_.Fg,_.C);_.Fg.prototype.map_changed=_.Fg.prototype.visible_changed=function(){var a=this;_.J("poly",function(b){b.j(a)})};_.tc(_.Fg.prototype,{draggable:_.eh,editable:_.eh,bounds:_.Eb(_.Jd),map:_.ji,visible:_.eh});_.v(Gg,_.C);Gg.prototype.map_changed=function(){var a=this;_.J("streetview",function(b){b.Uk(a)})};_.tc(Gg.prototype,{map:_.ji});_.Hg.prototype.getPanorama=function(a,b){var c=this.b||void 0;_.J("streetview",function(d){_.J("geometry",function(e){d.Zl(a,b,e.computeHeading,e.computeOffset,c)})})};_.Hg.prototype.getPanoramaByLocation=function(a,b,c){this.getPanorama({location:a,radius:b,preference:50>(b||0)?"best":"nearest"},c)};_.Hg.prototype.getPanoramaById=function(a,b){this.getPanorama({pano:a},b)};_.v(_.Ig,_.C);_.t=_.Ig.prototype;_.t.getTile=function(a,b,c){if(!a||!c)return null;var d=c.createElement("div");c={$:a,zoom:b,Bb:null};d.__gmimt=c;_.zc(this.b,d);var e=Kg(this);1!=e&&Jg(d,e);if(this.f){var e=this.tileSize||new _.M(256,256),f=this.j(a,b);c.Bb=this.f(a,b,e,d,f,function(){_.B.trigger(d,"load")})}return d};_.t.releaseTile=function(a){a&&this.b.contains(a)&&(this.b.remove(a),(a=a.__gmimt.Bb)&&a.release())};_.t.If=_.ra(13);_.t.On=function(){this.f&&this.b.forEach(function(a){a.__gmimt.Bb.ib()})};
_.t.opacity_changed=function(){var a=Kg(this);this.b.forEach(function(b){Jg(b,a)})};_.t.Tc=!0;_.tc(_.Ig.prototype,{opacity:_.ch});_.v(_.Lg,_.C);_.Lg.prototype.getTile=jh;_.Lg.prototype.tileSize=new _.M(256,256);_.Lg.prototype.Tc=!0;_.v(_.Mg,_.Lg);_.v(_.Ng,_.C);_.tc(_.Ng.prototype,{attribution:_.Eb(ei),place:_.Eb(fi)});var qj={Animation:{BOUNCE:1,DROP:2,Lp:3,Jp:4},Circle:_.Eg,ControlPosition:_.Ef,Data:se,GroundOverlay:_.Ke,ImageMapType:_.Ig,InfoWindow:_.Ce,LatLng:_.H,LatLngBounds:_.Gd,MVCArray:_.xc,MVCObject:_.C,Map:Ag,MapTypeControlStyle:{DEFAULT:0,HORIZONTAL_BAR:1,DROPDOWN_MENU:2,INSET:3,INSET_LARGE:4},MapTypeId:_.Zg,MapTypeRegistry:yd,Marker:_.de,MarkerImage:function(a,b,c,d,e){this.url=a;this.size=b||e;this.origin=c;this.anchor=d;this.scaledSize=e;this.labelOrigin=null},NavigationControlStyle:{DEFAULT:0,SMALL:1,
ANDROID:2,ZOOM_PAN:3,Mp:4,Dk:5},OverlayView:_.Dg,Point:_.L,Polygon:_.me,Polyline:_.ne,Rectangle:_.Fg,ScaleControlStyle:{DEFAULT:0},Size:_.M,StreetViewPreference:_.Bi,StreetViewSource:_.Ci,StrokePosition:{CENTER:0,INSIDE:1,OUTSIDE:2},SymbolPath:hh,ZoomControlStyle:{DEFAULT:0,SMALL:1,LARGE:2,Dk:3},event:_.B};
_.Ja(qj,{BicyclingLayer:_.Me,DirectionsRenderer:Fe,DirectionsService:Ge,DirectionsStatus:{OK:_.ga,UNKNOWN_ERROR:_.ja,OVER_QUERY_LIMIT:_.ha,REQUEST_DENIED:_.ia,INVALID_REQUEST:_.ba,ZERO_RESULTS:_.ka,MAX_WAYPOINTS_EXCEEDED:_.ea,NOT_FOUND:_.fa},DirectionsTravelMode:_.ti,DirectionsUnitSystem:_.si,DistanceMatrixService:He,DistanceMatrixStatus:{OK:_.ga,INVALID_REQUEST:_.ba,OVER_QUERY_LIMIT:_.ha,REQUEST_DENIED:_.ia,UNKNOWN_ERROR:_.ja,MAX_ELEMENTS_EXCEEDED:_.da,MAX_DIMENSIONS_EXCEEDED:_.ca},DistanceMatrixElementStatus:{OK:_.ga,
NOT_FOUND:_.fa,ZERO_RESULTS:_.ka},ElevationService:Ie,ElevationStatus:{OK:_.ga,UNKNOWN_ERROR:_.ja,OVER_QUERY_LIMIT:_.ha,REQUEST_DENIED:_.ia,INVALID_REQUEST:_.ba,Gp:"DATA_NOT_AVAILABLE"},FusionTablesLayer:Cg,Geocoder:_.Je,GeocoderLocationType:{ROOFTOP:"ROOFTOP",RANGE_INTERPOLATED:"RANGE_INTERPOLATED",GEOMETRIC_CENTER:"GEOMETRIC_CENTER",APPROXIMATE:"APPROXIMATE"},GeocoderStatus:{OK:_.ga,UNKNOWN_ERROR:_.ja,OVER_QUERY_LIMIT:_.ha,REQUEST_DENIED:_.ia,INVALID_REQUEST:_.ba,ZERO_RESULTS:_.ka,ERROR:_.aa},KmlLayer:Le,
KmlLayerStatus:_.Ai,MaxZoomService:Bg,MaxZoomStatus:{OK:_.ga,ERROR:_.aa},SaveWidget:_.Ng,StreetViewCoverageLayer:Gg,StreetViewPanorama:Ff,StreetViewService:_.Hg,StreetViewStatus:{OK:_.ga,UNKNOWN_ERROR:_.ja,ZERO_RESULTS:_.ka},StyledMapType:_.Mg,TrafficLayer:Ne,TrafficModel:_.ui,TransitLayer:Oe,TransitMode:_.vi,TransitRoutePreference:_.wi,TravelMode:_.ti,UnitSystem:_.si});_.Ja(se,{Feature:_.nc,Geometry:Yb,GeometryCollection:_.Rd,LineString:_.Td,LinearRing:_.Xd,MultiLineString:_.Vd,MultiPoint:_.Wd,MultiPolygon:_.ae,Point:_.$b,Polygon:_.Zd});var Sg=/'/g,Tg;_.lc("main",{});window.google.maps.Load(function(a,b){var c=window.google.maps;Xg();var d=Yg(c);_.P=new cf(a);_.rj=Math.random()<_.rf();_.sj=Math.round(1E15*Math.random()).toString(36);_.zg=Ug();_.zi=Vg();_.oj=new _.xc;_.hg=b;for(a=0;a<_.fd(_.P.b,8);++a)_.cg[Af(a)]=!0;a=_.xf();ce(nf(a));_.Ia(qj,function(a,b){c[a]=b});c.version=_.of(a);window.setTimeout(function(){mc(["util","stats"],function(a,b){a.f.b();a.j();d&&b.b.b({ev:"api_alreadyloaded",client:_.sf(_.P),key:_.uf()})})},5E3);_.B.ko();jg=new ig;(a=tf())&&mc(_.N(_.P.b,
12),Wg(a),!0)});}).call(this,{});



Ext.onReady(function(){Ext.define("Ext.ux.button.ColorButton",{extend:"Ext.button.Button",alias:"widget.colorbutton",width:109,height:22,defaultValue:null,value:"f1f1f1",getValue:function(){return this.value},setValue:function(j){this.value=j;if(Ext.isDefined(this.getEl())){this.getEl().dom.style.background="#"+j}},reset:function(){this.setValue(this.defaultValue)},menu:{},menuHandler:function(){},initComponent:function(){var j=this;this.defaultValue=this.value;this.menu=Ext.create("Ext.menu.Menu",{showSeparator:false,items:{xtype:"colorpicker",closeAction:"hide",listeners:{select:function(l,k){j.setValue(k);j.menu.hide();j.menuHandler(l,k)}}}});this.callParent()},listeners:{render:function(){this.setValue(this.value)}}});Ext.define("Ext.ux.layout.component.form.MultiSelect",{extend:"Ext.layout.component.field.Field",alias:["layout.multiselectfield"],type:"multiselectfield",defaultHeight:200,sizeBodyContents:function(k,j){var l=this;if(!Ext.isNumber(j)){j=l.defaultHeight}l.owner.panel.setSize(k,j)}});Ext.define("Ext.ux.form.MultiSelect",{extend:"Ext.form.field.Base",alternateClassName:"Ext.ux.Multiselect",alias:["widget.multiselect","widget.multiselectfield"],uses:["Ext.view.BoundList","Ext.form.FieldSet","Ext.ux.layout.component.form.MultiSelect","Ext.view.DragZone","Ext.view.DropZone"],ddReorder:false,appendOnly:false,displayField:"text",allowBlank:true,minSelections:0,maxSelections:Number.MAX_VALUE,blankText:"This field is required",minSelectionsText:"Minimum {0} item(s) required",maxSelectionsText:"Maximum {0} item(s) allowed",delimiter:",",componentLayout:"multiselectfield",fieldBodyCls:Ext.baseCSSPrefix+"form-multiselect-body",initComponent:function(){var j=this;j.bindStore(j.store,true);if(j.store.autoCreated){j.valueField=j.displayField="field1";if(!j.store.expanded){j.displayField="field2"}}if(!Ext.isDefined(j.valueField)){j.valueField=j.displayField}j.callParent()},bindStore:function(j,l){var m=this,n=m.store,k=m.boundList;if(n&&!l&&n!==j&&n.autoDestroy){n.destroy()}m.store=j?Ext.data.StoreManager.lookup(j):null;if(k){k.bindStore(j||null)}},onRender:function(n,j){var o=this,k,m,l;o.callParent(arguments);m=o.boundList=Ext.create("Ext.view.BoundList",{multiSelect:true,store:o.store,displayField:o.displayField,border:false});l=m.getSelectionModel();o.mon(l,{selectionChange:o.onSelectionChange,scope:o});k=o.panel=Ext.create("Ext.panel.Panel",{title:o.listTitle,tbar:o.tbar,items:[m],renderTo:o.bodyEl,layout:"fit"});k.ownerCt=o;o.setRawValue(o.rawValue)},getSubTplMarkup:function(){return""},afterRender:function(){var j=this;j.callParent();if(j.ddReorder&&!j.dragGroup&&!j.dropGroup){j.dragGroup=j.dropGroup="MultiselectDD-"+Ext.id()}if(j.draggable||j.dragGroup){j.dragZone=Ext.create("Ext.view.DragZone",{view:j.boundList,ddGroup:j.dragGroup,dragText:"{0} Item{1}"})}if(j.droppable||j.dropGroup){j.dropZone=Ext.create("Ext.view.DropZone",{view:j.boundList,ddGroup:j.dropGroup,handleNodeDrop:function(q,p,k){var l=this.view,n=l.getStore(),m=q.records,o;q.view.store.remove(m);o=n.indexOf(p);if(k==="after"){o++}n.insert(o,m);l.getSelectionModel().select(m)}})}},onSelectionChange:function(){this.checkChange()},clearValue:function(){this.setValue([])},getSubmitValue:function(){var k=this,j=k.delimiter,l=k.getValue();return Ext.isString(j)?l.join(j):l},getRawValue:function(){var k=this,j=k.boundList;if(j){k.rawValue=Ext.Array.map(j.getSelectionModel().getSelection(),function(l){return l.get(k.valueField)})}return k.rawValue},setRawValue:function(l){var k=this,j=k.boundList,m;l=Ext.Array.from(l);k.rawValue=l;if(j){m=[];Ext.Array.forEach(l,function(p){var o,n=k.store.findRecord(k.valueField,p,o,o,true,true);if(n){m.push(n)}});j.getSelectionModel().select(m,false,true)}return l},valueToRaw:function(j){return j},isEqual:function(n,m){var k=Ext.Array.from,l,j;n=k(n);m=k(m);j=n.length;if(j!==m.length){return false}for(l=0;l<j;l++){if(m[l]!==n[l]){return false}}return true},getErrors:function(k){var j=this,l=Ext.String.format,n=j.callParent(arguments),m;k=Ext.Array.from(k||j.getValue());m=k.length;if(!j.allowBlank&&m<1){n.push(j.blankText)}if(m<this.minSelections){n.push(l(j.minSelectionsText,j.minSelections))}if(m>this.maxSelections){n.push(l(j.maxSelectionsText,j.maxSelections))}return n},onDisable:function(){this.callParent();this.disabled=true;this.updateReadOnly()},onEnable:function(){this.callParent();this.disabled=false;this.updateReadOnly()},setReadOnly:function(j){this.readOnly=j;this.updateReadOnly()},updateReadOnly:function(){var k=this,j=k.boundList,l=k.readOnly||k.disabled;if(j){j.getSelectionModel().setLocked(l)}},onDestroy:function(){Ext.destroyMembers(this,"panel","boundList","dragZone","dropZone");this.callParent()}});OpenLayers.Util.OSM={};OpenLayers.Util.OSM.MISSING_TILE_URL="http://www.openstreetmap.org/openlayers/img/404.png";OpenLayers.Util.OSM.originalOnImageLoadError=OpenLayers.Util.onImageLoadError;OpenLayers.Util.onImageLoadError=function(){if(this.src.match(/^http:\/\/[abc]\.[a-z]+\.openstreetmap\.org\//)){this.src=OpenLayers.Util.OSM.MISSING_TILE_URL}else{if(this.src.match(/^http:\/\/[def]\.tah\.openstreetmap\.org\//)){}else{OpenLayers.Util.OSM.originalOnImageLoadError}}};OpenLayers.Layer.OSM.Mapnik=OpenLayers.Class(OpenLayers.Layer.OSM,{initialize:function(l,m){var j=["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"];m=OpenLayers.Util.extend({numZoomLevels:19,buffer:0,transitionEffect:"resize"},m);var k=[l,j,m];OpenLayers.Layer.OSM.prototype.initialize.apply(this,k)},CLASS_NAME:"OpenLayers.Layer.OSM.Mapnik"});OpenLayers.Layer.OSM.Osmarender=OpenLayers.Class(OpenLayers.Layer.OSM,{initialize:function(l,m){var j=["http://a.tah.openstreetmap.org/Tiles/tile/${z}/${x}/${y}.png","http://b.tah.openstreetmap.org/Tiles/tile/${z}/${x}/${y}.png","http://c.tah.openstreetmap.org/Tiles/tile/${z}/${x}/${y}.png"];m=OpenLayers.Util.extend({numZoomLevels:18,buffer:0,transitionEffect:"resize"},m);var k=[l,j,m];OpenLayers.Layer.OSM.prototype.initialize.apply(this,k)},CLASS_NAME:"OpenLayers.Layer.OSM.Osmarender"});OpenLayers.Layer.OSM.CycleMap=OpenLayers.Class(OpenLayers.Layer.OSM,{initialize:function(l,m){var j=["http://a.tile.opencyclemap.org/cycle/${z}/${x}/${y}.png","http://b.tile.opencyclemap.org/cycle/${z}/${x}/${y}.png","http://c.tile.opencyclemap.org/cycle/${z}/${x}/${y}.png"];m=OpenLayers.Util.extend({numZoomLevels:19,buffer:0,transitionEffect:"resize"},m);var k=[l,j,m];OpenLayers.Layer.OSM.prototype.initialize.apply(this,k)},CLASS_NAME:"OpenLayers.Layer.OSM.CycleMap"});OpenLayers.Control.Circle=OpenLayers.Class(OpenLayers.Control,{feature:null,layer:null,radius:5,origin:null,sides:40,angle:null,snapAngle:null,dragControl:null,initialize:function(j){OpenLayers.Control.prototype.initialize.apply(this,arguments)},activate:function(){var k=OpenLayers.Control.prototype.activate.call(this);if(k){var j={displayInLayerSwitcher:false,calculateInRange:function(){return true}};this.map.addLayer(this.layer)}return k},deactivate:function(){var j=OpenLayers.Control.prototype.deactivate.call(this);if(j){if(this.layer.map!=null){this.layer.destroy(false);if(this.feature){this.feature.destroy()}}this.layer=null;this.feature=null}return j},createGeometry:function(){this.angle=Math.PI*((1/this.sides)-(1/2));if(this.snapAngle){this.angle+=this.snapAngle*(Math.PI/180)}this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,this.radius,this.sides,this.snapAngle)},modifyGeometry:function(){var l,o,j,k;var n=this.feature.geometry.components[0];if(n.components.length!=(this.sides+1)){this.createGeometry();n=this.feature.geometry.components[0]}for(var m=0;m<this.sides;++m){k=n.components[m];l=this.angle+(m*2*Math.PI/this.sides);k.x=this.origin.x+(this.radius*Math.cos(l));k.y=this.origin.y+(this.radius*Math.sin(l));k.clearBounds()}},updateCircle:function(j,k){this.origin=new OpenLayers.Geometry.Point(j.lon,j.lat);this.radius=k*1;if(!this.feature){this.feature=new OpenLayers.Feature.Vector();this.createGeometry();this.layer.addFeatures([this.feature],{silent:true})}else{this.modifyGeometry()}this.layer.drawFeature(this.feature,this.style)},CLASS_NAME:"Meteorage.Circle"});OpenLayers.Control.newSelectFeature=OpenLayers.Class(OpenLayers.Control,{multipleKey:null,toggleKey:null,multiple:false,clickout:true,toggle:false,hover:false,onSelect:function(){},onUnselect:function(){},onHoverSelect:function(){},onHoverUnselect:function(){},onClickSelect:function(){},onClickUnselect:function(){},geometryTypes:null,layer:null,callbacks:null,selectStyle:null,renderIntent:"select",handler:null,initialize:function(l,k){OpenLayers.Control.prototype.initialize.apply(this,[k]);this.layer=l;this.callbacks=OpenLayers.Util.extend({click:this.clickFeature,clickout:this.clickoutFeature,over:this.overFeature,out:this.outFeature},this.callbacks);var j={geometryTypes:this.geometryTypes};this.handler=new OpenLayers.Handler.Feature(this,l,this.callbacks,j)},unselectAll:function(j){var l;for(var k=this.layer.selectedFeatures.length-1;k>=0;--k){l=this.layer.selectedFeatures[k];if(!j||j.except!=l){this.unselect(l,"click")}}},clickFeature:function(j){if((this.onSelect.name!=""||this.onClickSelect.name!="")&&!this.hover){var k=(OpenLayers.Util.indexOf(this.layer.selectedFeatures,j)>-1);if(k){if(this.toggleSelect()){this.unselect(j)}else{if(!this.multipleSelect()){this.unselectAll({except:j})}}}else{if(!this.multipleSelect()){this.unselectAll({except:j})}}this.select(j,"click")}},multipleSelect:function(){return this.multiple||this.handler.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handler.evt[this.toggleKey]},clickoutFeature:function(j){if(((this.onClickUnselect.name!=""||this.onHoverSelect.name=="")&&!this.hover)&&this.clickout){this.unselectAll()}},overFeature:function(j){if((this.onHoverSelect.name!=""||this.hover)&&(OpenLayers.Util.indexOf(this.layer.selectedFeatures,j)==-1)){this.select(j,"hover")}},outFeature:function(j){if(this.onHoverUnselect.name!=""||this.hover){this.unselect(j,"hover")}},select:function(l,j){this.layer.selectedFeatures.push(l);var k=this.selectStyle||this.renderIntent;this.layer.drawFeature(l,k);this.layer.events.triggerEvent("featureselected",{feature:l});switch(j){case"hover":this.onHoverSelect(l);break;case"click":if(this.onClickSelect.name!=""){this.onClickSelect(l)}else{if(this.onSelect.name!=""){this.onSelect(l)}}break;default:this.onSelect(l);break}},unselect:function(k,j){this.layer.drawFeature(k,"default");OpenLayers.Util.removeItem(this.layer.selectedFeatures,k);this.layer.events.triggerEvent("featureunselected",{feature:k});switch(j){case"hover":this.onHoverUnselect(k);break;case"click":if(this.onClickUnselect.name!=""){this.onClickUnselect(k)}else{if(this.onUnselect.name!=""){this.onUnselect(k)}}break;default:this.onUnselect(k);break}},setMap:function(j){this.handler.setMap(j);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.newSelectFeature"});Ext.define("GeoExt.data.LayerModel",{alternateClassName:"GeoExt.data.LayerRecord",extend:"Ext.data.Model",requires:["Ext.data.proxy.Memory","Ext.data.reader.Json"],alias:"model.gx_layer",statics:{createFromLayer:function(j){return this.proxy.reader.readRecords([j]).records[0]}},fields:["id",{name:"title",type:"string",mapping:"name"},{name:"legendURL",type:"string",mapping:"metadata.legendURL"},{name:"hideTitle",type:"bool",mapping:"metadata.hideTitle"},{name:"hideInLegend",type:"bool",mapping:"metadata.hideInLegend"}],proxy:{type:"memory",reader:{type:"json"}},getLayer:function(){return this.raw}});Ext.define("GeoExt.data.LayerStore",{requires:["GeoExt.data.LayerModel"],extend:"Ext.data.Store",model:"GeoExt.data.LayerModel",statics:{MAP_TO_STORE:1,STORE_TO_MAP:2},map:null,constructor:function(j){var m=this;j=Ext.apply({},j);var l=(GeoExt.MapPanel&&j.map instanceof GeoExt.MapPanel)?j.map.map:j.map;delete j.map;if(j.layers){j.data=j.layers}delete j.layers;var k={initDir:j.initDir};delete j.initDir;m.callParent([j]);if(l){this.bind(l,k)}},bind:function(l,k){var j=this;if(j.map){return}j.map=l;k=Ext.apply({},k);var n=k.initDir;if(k.initDir==undefined){n=GeoExt.data.LayerStore.MAP_TO_STORE|GeoExt.data.LayerStore.STORE_TO_MAP}var m=l.layers.slice(0);if(n&GeoExt.data.LayerStore.STORE_TO_MAP){j.each(function(o){j.map.addLayer(o.getLayer())},j)}if(n&GeoExt.data.LayerStore.MAP_TO_STORE){j.loadRawData(m,true)}l.events.on({changelayer:j.onChangeLayer,addlayer:j.onAddLayer,removelayer:j.onRemoveLayer,scope:j});j.on({load:j.onLoad,clear:j.onClear,add:j.onAdd,remove:j.onRemove,update:j.onUpdate,scope:j});j.data.on({replace:j.onReplace,scope:j});j.fireEvent("bind",j,l)},unbind:function(){var j=this;if(j.map){j.map.events.un({changelayer:j.onChangeLayer,addlayer:j.onAddLayer,removelayer:j.onRemoveLayer,scope:j});j.un("load",j.onLoad,j);j.un("clear",j.onClear,j);j.un("add",j.onAdd,j);j.un("remove",j.onRemove,j);j.data.un("replace",j.onReplace,j);j.map=null}},onChangeLayer:function(j){var l=j.layer;var n=this.findBy(function(p,o){return p.getLayer()===l});if(n>-1){var k=this.getAt(n);if(j.property==="order"){if(!this._adding&&!this._removing){var m=this.map.getLayerIndex(l);if(m!==n){this._removing=true;this.remove(k);delete this._removing;this._adding=true;this.insert(m,[k]);delete this._adding}}}else{if(j.property==="name"){k.set("title",l.name)}else{this.fireEvent("update",this,k,Ext.data.Record.EDIT)}}}},onAddLayer:function(j){var l=this;if(!l._adding){l._adding=true;var k=l.proxy.reader.read(j.layer);l.add(k.records);delete l._adding}},onRemoveLayer:function(k){if(this.map.unloadDestroy){if(!this._removing){var j=k.layer;this._removing=true;this.remove(this.getByLayer(j));delete this._removing}}else{this.unbind()}},onLoad:function(p,j,l){if(l){if(!Ext.isArray(j)){j=[j]}if(!this._addRecords){this._removing=true;for(var n=this.map.layers.length-1;n>=0;n--){this.map.removeLayer(this.map.layers[n])}delete this._removing}var k=j.length;if(k>0){var m=new Array(k);for(var o=0;o<k;o++){m[o]=j[o].getLayer()}this._adding=true;this.map.addLayers(m);delete this._adding}}delete this._addRecords},onClear:function(k){this._removing=true;for(var j=this.map.layers.length-1;j>=0;j--){this.map.removeLayer(this.map.layers[j])}delete this._removing},onAdd:function(j,k,n){if(!this._adding){this._adding=true;var l;for(var m=k.length-1;m>=0;--m){l=k[m].getLayer();this.map.addLayer(l);if(n!==this.map.layers.length-1){this.map.setLayerIndex(l,n)}}delete this._adding}},onRemove:function(j,k,m){if(!this._removing){var l=k.getLayer();if(this.map.getLayer(l.id)!=null){this._removing=true;this.removeMapLayer(k);delete this._removing}}},onUpdate:function(n,k,j){if(j===Ext.data.Record.EDIT){if(k.modified&&k.modified.title){var m=k.getLayer();var l=k.get("title");if(l!==m.name){m.setName(l)}}}},removeMapLayer:function(j){this.map.removeLayer(j.getLayer())},onReplace:function(l,k,j){this.removeMapLayer(k)},getByLayer:function(j){var k=this.findBy(function(l){return l.getLayer()===j});if(k>-1){return this.getAt(k)}},destroy:function(){var j=this;j.unbind();j.callParent()},loadRecords:function(k,j){if(j&&j.addRecords){this._addRecords=true}this.callParent(arguments)}});Ext.define("GeoExt.panel.Map",{extend:"Ext.panel.Panel",requires:["GeoExt.data.LayerStore"],alias:"widget.gx_mappanel",alternateClassName:"GeoExt.MapPanel",statics:{guess:function(){var j=Ext.ComponentQuery.query("gx_mappanel");return((j&&j.length>0)?j[0]:null)}},center:null,zoom:null,extent:null,prettyStateKeys:false,map:null,layers:null,stateEvents:["aftermapmove","afterlayervisibilitychange","afterlayeropacitychange","afterlayerorderchange","afterlayernamechange","afterlayeradd","afterlayerremove"],initComponent:function(){if(!(this.map instanceof OpenLayers.Map)){this.map=new OpenLayers.Map(Ext.applyIf(this.map||{},{allOverlays:true}))}var j=this.layers;if(!j||j instanceof Array){this.layers=Ext.create("GeoExt.data.LayerStore",{layers:j,map:this.map.layers.length>0?this.map:null})}if(Ext.isString(this.center)){this.center=OpenLayers.LonLat.fromString(this.center)}else{if(Ext.isArray(this.center)){this.center=new OpenLayers.LonLat(this.center[0],this.center[1])}}if(Ext.isString(this.extent)){this.extent=OpenLayers.Bounds.fromString(this.extent)}else{if(Ext.isArray(this.extent)){this.extent=OpenLayers.Bounds.fromArray(this.extent)}}this.callParent(arguments);this.on("resize",this.onResize,this);this.on("afterlayout",function(){if(typeof this.map.getViewport==="function"){this.items.each(function(k){if(typeof k.addToMapPanel==="function"){k.getEl().appendTo(this.map.getViewport())}},this)}},this);this.map.events.on({moveend:this.onMoveend,changelayer:this.onChangelayer,addlayer:this.onAddlayer,removelayer:this.onRemovelayer,scope:this})},onMoveend:function(j){this.fireEvent("aftermapmove",this,this.map,j)},onChangelayer:function(j){var k=this.map;if(j.property){if(j.property==="visibility"){this.fireEvent("afterlayervisibilitychange",this,k,j)}else{if(j.property==="order"){this.fireEvent("afterlayerorderchange",this,k,j)}else{if(j.property==="nathis"){this.fireEvent("afterlayernathischange",this,k,j)}else{if(j.property==="opacity"){this.fireEvent("afterlayeropacitychange",this,k,j)}}}}}},onAddlayer:function(){this.fireEvent("afterlayeradd")},onRemovelayer:function(){this.fireEvent("afterlayerremove")},onResize:function(){var j=this.map;if(this.body.dom!==j.div){j.render(this.body.dom);this.layers.bind(j);if(j.layers.length>0){this.setInitialExtent()}else{this.layers.on("add",this.setInitialExtent,this,{single:true})}}else{j.updateSize()}},setInitialExtent:function(){var j=this.map;if(!j.getCenter()){if(this.center||this.zoom){j.setCenter(this.center,this.zoom)}else{if(this.extent instanceof OpenLayers.Bounds){j.zoomToExtent(this.extent,true)}else{j.zoomToMaxExtent()}}}},getState:function(){var n=this,l=n.map,m=n.callParent(arguments)||{},j;if(!l){return}var k=l.getCenter();k&&Ext.applyIf(m,{x:k.lon,y:k.lat,zoom:l.getZoom()});n.layers.each(function(o){j=o.getLayer();layerId=this.prettyStateKeys?o.get("title"):o.get("id");m=n.addPropertyToState(m,"visibility_"+layerId,j.getVisibility());m=n.addPropertyToState(m,"opacity_"+layerId,(j.opacity===null)?1:j.opacity)},n);return m},applyState:function(s){var k=this;map=k.map;k.center=new OpenLayers.LonLat(s.x,s.y);k.zoom=s.zoom;var n,q,m,p,r,l;var o=map.layers;for(n=0,q=o.length;n<q;n++){m=o[n];p=k.prettyStateKeys?m.name:m.id;r=s["visibility_"+p];if(r!==undefined){r=(/^true$/i).test(r);if(m.isBaseLayer){if(r){map.setBaseLayer(m)}}else{m.setVisibility(r)}}l=s["opacity_"+p];if(l!==undefined){m.setOpacity(l)}}},onBeforeAdd:function(j){if(Ext.isFunction(j.addToMapPanel)){j.addToMapPanel(this)}this.callParent(arguments)},beforeDestroy:function(){if(this.map&&this.map.events){this.map.events.un({moveend:this.onMoveend,changelayer:this.onChangelayer,scope:this})}if(!this.initialConfig.map||!(this.initialConfig.map instanceof OpenLayers.Map)){if(this.map&&this.map.destroy){this.map.destroy()}}delete this.map;this.callParent(arguments)}});Ext.define("GeoExt.tree.Column",{extend:"Ext.tree.Column",alias:"widget.gx_treecolumn",initComponent:function(){var j=this;j.callParent();var k=j.renderer;this.renderer=function(m,q,r,n,l,p,s){var o=[k(m,q,r,n,l,p,s)];if(r.get("checkedGroup")){o[0]=o[0].replace(/class="([^-]+)-tree-checkbox([^"]+)?"/,'class="$1-tree-checkbox$2 gx-tree-radio"')}o.push('<div class="gx-tree-component gx-tree-component-off" id="tree-record-'+r.id+'"></div>');if(r.uiProvider&&r.uiProvider instanceof "string"){}return o.join("")}},defaultRenderer:function(j){return j}});Ext.define("GeoExt.tree.View",{extend:"Ext.tree.View",alias:"widget.gx_treeview",initComponent:function(){var j=this;j.on("itemupdate",this.onItem,this);j.on("itemadd",this.onItem,this);j.on("createchild",this.createChild,this);return j.callParent(arguments)},onItem:function(k,o,l,j){var m=this;if(!(k instanceof Array)){k=[k]}for(var n=0;n<k.length;n++){this.onNodeRendered(k[n])}},onNodeRendered:function(l){var j=this;var k=Ext.get("tree-record-"+l.id);if(!k){return}if(l.get("layer")){j.fireEvent("createchild",k,l)}if(l.hasChildNodes()){l.eachChild(function(m){j.onNodeRendered(m)},j)}},createChild:function(j,l){var k=l.get("component");if(k){cmpObj=Ext.ComponentManager.create(k);cmpObj.render(j);j.removeCls("gx-tree-component-off")}}});Ext.define("GeoExt.tree.LayerNode",{extend:"Ext.AbstractPlugin",alias:"plugin.gx_layer",init:function(j){this.target=j;var k=j.get("layer");j.set("checked",k.getVisibility());if(!j.get("checkedGroup")&&k.isBaseLayer){j.set("checkedGroup","gx_baselayer")}j.set("fixedText",!!j.text);j.set("leaf",true);if(!j.get("iconCls")){j.set("iconCls","gx-tree-layer-icon")}j.on("afteredit",this.onAfterEdit,this);k.events.on({visibilitychanged:this.onLayerVisibilityChanged,scope:this})},onAfterEdit:function(l,k){var j=this;if(~Ext.Array.indexOf(k,"checked")){j.onCheckChange()}},onLayerVisibilityChanged:function(){if(!this._visibilityChanging){this.target.set("checked",this.target.get("layer").getVisibility())}},onCheckChange:function(){var l=this.target,j=this.target.get("checked");if(j!=l.get("layer").getVisibility()){l._visibilityChanging=true;var k=l.get("layer");if(j&&k.isBaseLayer&&k.map){k.map.setBaseLayer(k)}else{k.setVisibility(j)}delete l._visibilityChanging}}});Ext.define("GeoExt.tree.LayerLoader",{extend:"Ext.util.Observable",requires:["GeoExt.tree.LayerNode"],store:null,filter:function(j){return j.getLayer().displayInLayerSwitcher===true},baseAttrs:null,load:function(j){if(this.fireEvent("beforeload",this,j)){this.removeStoreHandlers();while(j.firstChild){j.removeChild(j.firstChild)}if(!this.store){this.store=GeoExt.MapPanel.guess().layers}this.store.each(function(k){this.addLayerNode(j,k)},this);this.addStoreHandlers(j);this.fireEvent("load",this,j)}},onStoreAdd:function(j,k,p,m){if(!this._reordering){var l=m.get("container").recordIndexToNodeIndex(p+k.length-1,m);for(var o=0,n=k.length;o<n;++o){this.addLayerNode(m,k[o],l)}}},onStoreRemove:function(k,j){if(!this._reordering){this.removeLayerNode(j,k)}},addLayerNode:function(m,k,j){j=j||0;if(this.filter(k)===true){var n=k.getLayer();var l=this.createNode({plugins:[{ptype:"gx_layer"}],layer:n,text:n.name,listeners:{move:this.onChildMove,scope:this}});if(j!==undefined){m.insertChild(j,l)}else{m.appendChild(l)}m.getChildAt(j).on("move",this.onChildMove,this)}},removeLayerNode:function(j,k){if(this.filter(k)===true){var l=j.findChildBy(function(m){return m.get("layer")==k.getLayer()});if(l){l.un("move",this.onChildMove,this);l.remove()}}},onChildMove:function(v,n,m,q){var p=this,r=p.store.getByLayer(v.get("layer")),w=m.get("container"),s=w.loader;p._reordering=true;if(s instanceof p.self&&p.store===s.store){s._reordering=true;p.store.remove(r);var x;if(m.childNodes.length>1){var o=(q===0)?q+1:q-1;x=p.store.findBy(function(j){return m.childNodes[o].get("layer")===j.getLayer()});if(q===0){x++}}else{if(n.parentNode===m.parentNode){var u=m;do{u=u.previousSibling}while(u&&!(u.get("container") instanceof w.self&&u.lastChild));if(u){x=p.store.findBy(function(j){return u.lastChild.get("layer")===j.getLayer()})}else{var t=m;do{t=t.nextSibling}while(t&&!(t.get("container") instanceof w.self&&t.firstChild));if(t){x=p.store.findBy(function(j){return t.firstChild.get("layer")===j.getLayer()})}x++}}}if(x!==undefined){p.store.insert(x,[r])}else{p.store.insert(oldRecordIndex,[r])}delete s._reordering}delete p._reordering},addStoreHandlers:function(j){if(!this._storeHandlers){this._storeHandlers={add:function(n,l,m){this.onStoreAdd(n,l,m,j)},remove:function(m,l){this.onStoreRemove(l,j)}};for(var k in this._storeHandlers){this.store.on(k,this._storeHandlers[k],this)}}},removeStoreHandlers:function(){if(this._storeHandlers){for(var j in this._storeHandlers){this.store.un(j,this._storeHandlers[j],this)}delete this._storeHandlers}},createNode:function(j){if(this.baseAttrs){Ext.apply(j,this.baseAttrs)}return j},destroy:function(){this.removeStoreHandlers()}});Ext.define("GeoExt.tree.LayerContainer",{extend:"Ext.AbstractPlugin",requires:["GeoExt.tree.LayerLoader"],alias:"plugin.gx_layercontainer",defaultText:"Layers",init:function(l){var j=this;var k=j.loader;j.loader=(k&&k instanceof GeoExt.tree.LayerLoader)?k:new GeoExt.tree.LayerLoader(k);l.set("container",j);if(!l.get("text")){l.set("text",j.defaultText);l.commit()}j.loader.load(l)},recordIndexToNodeIndex:function(q,m){var n=this;var j=n.loader.store;var o=j.getCount();var k=m.childNodes.length;var l=-1;for(var p=o-1;p>=0;--p){if(n.loader.filter(j.getAt(p))===true){++l;if(q===p||l>k-1){break}}}return l}});Ext.define("GeoExt.tree.BaseLayerContainer",{extend:"GeoExt.tree.LayerContainer",alias:"plugin.gx_baselayercontainer",defaultText:"Base Layers",init:function(l){var j=this;var k=j.loader;j.loader=Ext.applyIf(k||{},{baseAttrs:Ext.applyIf((k&&k.baseAttrs)||{},{iconCls:"gx-tree-baselayer-icon",checkedGroup:"baselayer"}),filter:function(n){var m=n.getLayer();return m.displayInLayerSwitcher===true&&m.isBaseLayer===true}});j.callParent(arguments)}});Ext.define("GeoExt.tree.Panel",{extend:"Ext.tree.Panel",alias:"widget.gx_treepanel",requires:["GeoExt.tree.Column","GeoExt.tree.View"],viewType:"gx_treeview",initComponent:function(){var j=this;if(!j.columns){if(j.initialConfig.hideHeaders===undefined){j.hideHeaders=true}j.addCls(Ext.baseCSSPrefix+"autowidth-table");j.columns=[{xtype:"gx_treecolumn",text:"Name",width:Ext.isIE6?null:10000,dataIndex:j.displayField}]}j.callParent()}});Ext.Ajax.method="GET";Ext.isIE=(/trident/.test(Ext.userAgent));Ext.isIE11=Ext.isIE&&(/rv:11.0/.test(Ext.userAgent));GIS={core:{instances:[]},i18n:{},isDebug:false,isSessionStorage:"sessionStorage" in window&&window.sessionStorage!==null,logg:[]};GIS.core.getOLMap=function(m,j){var p,l,k=j.dashboard?"google-logo-small":"google-logo",o,n=true;l=function(r,t){var s,q;s=new OpenLayers.Control.Button({displayClass:"olControlButton",trigger:function(){t.call(m.olmap)}});q=new OpenLayers.Control.Panel({defaultControl:s});q.addControls([s]);p.addControl(q);q.div.className+=" "+r;q.div.childNodes[0].className+=" "+r+"Button";return q};p=new OpenLayers.Map({controls:[new OpenLayers.Control.Navigation({zoomWheelEnabled:j.dashboard?false:true,documentDrag:true}),new OpenLayers.Control.MousePosition({prefix:'<span id="mouseposition" class="el-fontsize-10"><span class="text-mouseposition-lonlat">LON </span>',separator:'<span class="text-mouseposition-lonlat">,&nbsp;LAT </span>',suffix:'<div class="'+k+'" name="http://www.google.com/intl/en-US_US/help/terms_maps.html" onclick="window.open(Ext.get(this).dom.attributes.name.nodeValue);"></div></span>'}),new OpenLayers.Control.Permalink(),new OpenLayers.Control.ScaleLine({geodesic:true,maxWidth:170,minWidth:100})],displayProjection:new OpenLayers.Projection("EPSG:4326"),mouseMove:{},relocate:{}});p.events.register("mousemove",null,function(t){m.olmap.mouseMove.x=t.clientX;m.olmap.mouseMove.y=t.clientY;if(n&&j.dashboard){n=false;var r=Ext.get(o.div),q=r.first().first(),s;q.on("mousemove",function(){if(s&&!s.isVisible()){s.show()}else{if(!s){var x=m.util.map.getRenderedVectorLayers().reverse(),w='<div id="legendWrapper">';for(var v=0,u,y;v<x.length;v++){u=x[v];y=u.core.updateLegend().innerHTML;if(y){w+='<div style="font-size:10px; font-weight:bold">'+u.name+"</div>"+y+(v<x.length-1?'<div style="padding:5px"></div>':"")}}w+="</div>";s=Ext.create("Ext.window.Window",{title:"Legend",cls:"gis-plugin",bodyStyle:"background-color: #fff; padding: 3px",width:100,height:100,html:w,preventHeader:true,shadow:false,listeners:{show:function(){var A=this.getEl(),z=A.first().first(),B=Ext.get(p.buttonControls[0].div).getAnchorXY();A.setStyle("opacity",0.92);this.setHeight(z.getHeight()+8+9);this.setPosition(B[0]-this.getWidth(),B[1]-1)}}})}}});q.on("mouseleave",function(){if(s&&s.hide){s.hide()}})}});p.zoomToVisibleExtent=function(){m.util.map.zoomToVisibleExtent(this)};p.closeAllLayers=function(){m.layer.event.core.reset();m.layer.facility.core.reset();m.layer.boundary.core.reset();m.layer.thematic1.core.reset();m.layer.thematic2.core.reset();m.layer.thematic3.core.reset();m.layer.thematic4.core.reset()};p.buttonControls=[];p.buttonControls.push(l("zoomIn"+(j.dashboard?"-vertical":""),p.zoomIn));p.buttonControls.push(l("zoomOut"+(j.dashboard?"-vertical":""),p.zoomOut));p.buttonControls.push(l("zoomVisible"+(j.dashboard?"-vertical":""),p.zoomToVisibleExtent));o=l("legend"+(j.dashboard?"-vertical":""),function(){});p.buttonControls.push(o);p.addButtonControl=l;return p};GIS.core.getLayers=function(j){var o={},k,m=["1","2","3","4"];o.openStreetMap=new OpenLayers.Layer.OSM.Mapnik("OpenStreetMap",{layerType:j.conf.finals.layer.type_base,layerOpacity:1,setLayerOpacity:function(p){if(p){this.layerOpacity=parseFloat(p)}this.setOpacity(this.layerOpacity)}});o.openStreetMap.id="openStreetMap";o.event=GIS.core.VectorLayer(j,"event",GIS.i18n.event_layer,{opacity:j.conf.layout.layer.opacity});o.event.core=new mapfish.GeoStat.Event(j.olmap,{layer:o.event,gis:j});o.facility=GIS.core.VectorLayer(j,"facility",GIS.i18n.facility_layer,{opacity:1});o.facility.core=new mapfish.GeoStat.Facility(j.olmap,{layer:o.facility,gis:j});o.boundary=GIS.core.VectorLayer(j,"boundary",GIS.i18n.boundary_layer,{opacity:1});o.boundary.core=new mapfish.GeoStat.Boundary(j.olmap,{layer:o.boundary,gis:j});for(var l=0,n;l<m.length;l++){n=m[l];o["thematic"+n]=GIS.core.VectorLayer(j,"thematic"+n,GIS.i18n.thematic_layer+" "+n,{opacity:j.conf.layout.layer.opacity});o["thematic"+n].layerCategory=j.conf.finals.layer.category_thematic,o["thematic"+n].core=new mapfish.GeoStat["Thematic"+n](j.olmap,{layer:o["thematic"+n],gis:j})}return o};GIS.core.createSelectHandlers=function(t,m){var w=!!GIS.app?!!t.init.user.isAdmin:false,x={},p,j,l,k,n,s=t.conf.finals.dimension,u,r,o=m.id==="boundary",v=m.id==="event";j=function q(B){if(o){var C=m.core.getDefaultFeatureStyle();C.fillOpacity=0.15;C.strokeColor=B.style.strokeColor;C.strokeWidth=B.style.strokeWidth;C.label=B.style.label;C.fontFamily=B.style.fontFamily;C.fontWeight=B.style.strokeWidth>1?"bold":"normal";C.labelAlign=B.style.labelAlign;C.labelYOffset=B.style.labelYOffset;m.drawFeature(B,C)}if(u){u.destroy()}u=Ext.create("Ext.window.Window",{cls:"gis-window-widget-feature gis-plugin",preventHeader:true,shadow:false,resizable:false,items:{html:B.attributes.popupText}});u.show();t.viewport.centerRegion.trash.push(u);var E=t.viewport.centerRegion,F=E.getPosition()[0],D=F+(E.getWidth()/2),A=E.getPosition()[1]+(t.plugin?0:32),z=D-(u.getWidth()/2),G=A;u.setPosition(z,G)};l=function q(y){u.destroy()};k=function q(H){var G,F,z,A,C,E=H.geometry.CLASS_NAME===t.conf.finals.openLayers.point_classname,D=H.attributes,B=Ext.get(document.body);F=function(){if(t.olmap.relocate.window){t.olmap.relocate.window.destroy()}t.olmap.relocate.window=Ext.create("Ext.window.Window",{title:"Relocate facility",layout:"fit",iconCls:"gis-window-title-icon-relocate",cls:"gis-container-default",setMinWidth:function(I){this.setWidth(this.getWidth()<I?I:this.getWidth())},items:{html:D.name,cls:"gis-container-inner"},bbar:["->",{xtype:"button",hideLabel:true,text:GIS.i18n.cancel,handler:function(){t.olmap.relocate.active=false;t.olmap.relocate.window.destroy();t.olmap.getViewport().style.cursor="auto"}}],listeners:{close:function(){t.olmap.relocate.active=false;t.olmap.getViewport().style.cursor="auto"}}});t.olmap.relocate.window.show();t.olmap.relocate.window.setMinWidth(220);t.util.gui.window.setPositionTopRight(t.olmap.relocate.window)};G=function(){t.ajax({url:t.init.contextPath+"/api/organisationUnits/"+D.id+".json?links=false",disableCaching:false,success:function(J){var I=Ext.decode(J.responseText);if(m.infrastructuralWindow){m.infrastructuralWindow.destroy()}m.infrastructuralWindow=Ext.create("Ext.window.Window",{title:GIS.i18n.information,layout:"column",iconCls:"gis-window-title-icon-information",cls:"gis-container-default",width:460,height:400,period:null,items:[{cls:"gis-container-inner",columnWidth:0.4,bodyStyle:"padding-right:4px",items:function(){var K=[];if(D.name){K.push({html:GIS.i18n.name,cls:"gis-panel-html-title"},{html:D.name,cls:"gis-panel-html"},{cls:"gis-panel-html-separator"})}if(I.parent){K.push({html:GIS.i18n.parent_unit,cls:"gis-panel-html-title"},{html:I.parent.name,cls:"gis-panel-html"},{cls:"gis-panel-html-separator"})}if(I.code){K.push({html:GIS.i18n.code,cls:"gis-panel-html-title"},{html:I.code,cls:"gis-panel-html"},{cls:"gis-panel-html-separator"})}if(I.address){K.push({html:GIS.i18n.address,cls:"gis-panel-html-title"},{html:I.address,cls:"gis-panel-html"},{cls:"gis-panel-html-separator"})}if(I.email){K.push({html:GIS.i18n.email,cls:"gis-panel-html-title"},{html:I.email,cls:"gis-panel-html"},{cls:"gis-panel-html-separator"})}if(I.phoneNumber){K.push({html:GIS.i18n.phone_number,cls:"gis-panel-html-title"},{html:I.phoneNumber,cls:"gis-panel-html"},{cls:"gis-panel-html-separator"})}if(Ext.isString(I.coordinates)){var N=I.coordinates.replace("[","").replace("]","").replace(",",", ");K.push({html:GIS.i18n.coordinate,cls:"gis-panel-html-title"},{html:N,cls:"gis-panel-html"},{cls:"gis-panel-html-separator"})}if(Ext.isArray(I.organisationUnitGroups)&&I.organisationUnitGroups.length){var M="";for(var L=0;L<I.organisationUnitGroups.length;L++){M+=I.organisationUnitGroups[L].name;M+=L<I.organisationUnitGroups.length-1?"<br/>":""}K.push({html:GIS.i18n.groups,cls:"gis-panel-html-title"},{html:M,cls:"gis-panel-html"},{cls:"gis-panel-html-separator"})}return K}()},{xtype:"form",cls:"gis-container-inner gis-form-widget",columnWidth:0.6,bodyStyle:"padding-left:4px",items:[{html:GIS.i18n.infrastructural_data,cls:"gis-panel-html-title"},{cls:"gis-panel-html-separator"},{xtype:"combo",fieldLabel:GIS.i18n.period,editable:false,valueField:"id",displayField:"name",emptyText:"Select period",forceSelection:true,width:258,labelWidth:70,store:{fields:["id","name"],data:function(){var K=t.init.systemSettings.infrastructuralPeriodType.id,N=t.init.periodGenerator,M=N.filterFuturePeriodsExceptCurrent(N.generateReversedPeriods(K,this.periodOffset))||[];if(Ext.isArray(M)&&M.length){for(var L=0;L<M.length;L++){M[L].id=M[L].iso}M=M.slice(0,5)}return M}()},lockPosition:false,listeners:{select:function(M){var O=M.getValue(),K=t.init.contextPath+"/api/analytics.json?",N=t.init.systemSettings.infrastructuralDataElementGroup;if(N&&N.dataElements){K+="dimension=dx:";for(var L=0;L<N.dataElements.length;L++){K+=N.dataElements[L].id;K+=L<N.dataElements.length-1?";":""}}K+="&filter=pe:"+O;K+="&filter=ou:"+D.id;t.ajax({url:K,disableCaching:false,success:function(R){var P=Ext.decode(R.responseText),S=[];if(Ext.isArray(P.rows)){for(var Q=0;Q<P.rows.length;Q++){S.push({name:P.metaData.names[P.rows[Q][0]],value:P.rows[Q][1]})}}m.widget.infrastructuralDataElementValuesStore.loadData(S)}})}}},{xtype:"grid",cls:"gis-grid",height:300,width:258,scroll:"vertical",columns:[{id:"name",text:"Data element",dataIndex:"name",sortable:true,width:195},{id:"value",header:"Value",dataIndex:"value",sortable:true,width:63}],disableSelection:true,store:m.widget.infrastructuralDataElementValuesStore}]}],listeners:{show:function(){if(p){this.down("combo").setValue(p);infrastructuralDataElementValuesStore.load({params:{periodId:p,organisationUnitId:D.internalId}})}}}});m.infrastructuralWindow.show();t.util.gui.window.setPositionTopRight(m.infrastructuralWindow)}})};z=function(M,K,L){var J=Ext.clone(m.core.view),I;J.parentGraphMap={};J.parentGraphMap[M]=K;J.rows=[{dimension:s.organisationUnit.objectName,items:[{id:M},{id:"LEVEL-"+L}]}];if(J){I=m.core.getLoader();I.updateGui=true;I.zoomToVisibleExtent=true;I.hideMask=true;I.load(J)}};var y=[];if(m.id!=="facility"){y.push(Ext.create("Ext.menu.Item",{text:"Float up",iconCls:"gis-menu-item-icon-float",cls:"gis-plugin",disabled:!D.hasCoordinatesUp,handler:function(){z(D.grandParentId,D.grandParentParentGraph,parseInt(D.level)-1)}}));y.push(Ext.create("Ext.menu.Item",{text:"Drill down",iconCls:"gis-menu-item-icon-drill",cls:"gis-menu-item-first gis-plugin",disabled:!D.hasCoordinatesDown,handler:function(){z(D.id,D.parentGraph,parseInt(D.level)+1)}}))}if(w&&E){if(m.id!=="facility"){y.push({xtype:"menuseparator"})}y.push(Ext.create("Ext.menu.Item",{text:GIS.i18n.relocate,iconCls:"gis-menu-item-icon-relocate",disabled:!t.init.user.isAdmin,handler:function(I){t.olmap.relocate.active=true;t.olmap.relocate.feature=H;t.olmap.getViewport().style.cursor="crosshair";F()}}));y.push(Ext.create("Ext.menu.Item",{text:"Swap lon/lat",iconCls:"gis-menu-item-icon-relocate",disabled:!t.init.user.isAdmin,handler:function(I){var K=H.attributes.id,J=Ext.clone(H.geometry).transform("EPSG:900913","EPSG:4326");if(Ext.isNumber(J.x)&&Ext.isNumber(J.y)&&t.init.user.isAdmin){t.ajax({url:t.init.contextPath+"/api/organisationUnits/"+K+".json?links=false",disableCaching:false,success:function(L){var M=Ext.decode(L.responseText);M.coordinates="["+J.y.toFixed(5)+","+J.x.toFixed(5)+"]";t.ajax({url:t.init.contextPath+"/api/metaData?preheatCache=false",method:"POST",headers:{"Content-Type":"application/json"},params:Ext.encode({organisationUnits:[M]}),success:function(O){var N=H.geometry.x,P=H.geometry.y;delete H.geometry.bounds;H.geometry.x=P;H.geometry.y=N;m.redraw();console.log(H.attributes.name+" relocated to "+M.coordinates)}})}})}}}));y.push(Ext.create("Ext.menu.Item",{text:GIS.i18n.show_information_sheet,iconCls:"gis-menu-item-icon-information",handler:function(I){G()}}))}if(y.length){y[y.length-1].addCls("gis-menu-item-last")}A=new Ext.menu.Menu({baseCls:"gis-plugin gis-popupmenu",shadow:false,showSeparator:false,defaults:{bodyStyle:"padding-right:6px"},items:y});A.showAt([t.olmap.mouseMove.x+(B.dom.scrollLeft||0),t.olmap.mouseMove.y+(B.dom.scrollTop||0)])};x={onHoverSelect:j,onHoverUnselect:l,onClickSelect:k};if(v){x.onClickSelect=function q(G){var C=["label","value","nameColumnMap","psi","ps","longitude","latitude","eventdate","ou","oucode","ouname","popupText"],A=G.attributes,y=A.nameColumnMap,B='<table class="padding1">',E=' style="font-weight:bold; padding-right:10px; vertical-align:top"',z=' style="max-width:170px"',D;B+="<tr><td"+E+">"+y.ou+"</td><td"+z+">"+A.ouname+"</td></tr>";B+="<tr><td"+E+">"+y.eventdate+"</td><td"+z+">"+A.eventdate+"</td></tr>";B+="<tr><td"+E+">"+y.longitude+"</td><td"+z+">"+A.longitude+"</td></tr>";B+="<tr><td"+E+">"+y.latitude+"</td><td"+z+">"+A.latitude+"</td></tr>";for(var F in A){if(A.hasOwnProperty(F)&&!Ext.Array.contains(C,F)){B+="<tr><td"+E+">"+y[F]+"</td><td>"+A[F]+"</td></tr>"}}B+="</table>";if(Ext.isObject(r)&&r.destroy){D=r.getPosition();r.destroy();r=null}r=Ext.create("Ext.window.Window",{title:"Event",layout:"fit",resizable:false,bodyStyle:"background-color:#fff; padding:5px",html:B,autoShow:true,listeners:{show:function(H){if(D){H.setPosition(D)}else{t.util.gui.window.setPositionTopRight(H)}},destroy:function(){r=null}}})}}n=new OpenLayers.Control.newSelectFeature(m,x);t.olmap.addControl(n);n.activate()};GIS.core.StyleMap=function(k){var l={fillOpacity:1,strokeColor:"#fff",strokeWidth:1,pointRadius:8,labelAlign:"cr",labelYOffset:13,fontFamily:'"Arial","Sans-serif","Roboto","Helvetica","Consolas"'},j={fillOpacity:0.9,strokeColor:"#fff",strokeWidth:1,cursor:"pointer",labelAlign:"cr",labelYOffset:13};if(Ext.isObject(k)&&k.labels){l.label="${label}";l.fontSize=k.labelFontSize;l.fontWeight=k.labelFontWeight;l.fontStyle=k.labelFontStyle;l.fontColor=k.labelFontColor}return new OpenLayers.StyleMap({"default":l,select:j})};GIS.core.VectorLayer=function(j,n,l,k){var m=new OpenLayers.Layer.Vector(l,{strategies:[new OpenLayers.Strategy.Refresh({force:true})],styleMap:GIS.core.StyleMap(),visibility:false,displayInLayerSwitcher:false,layerType:j.conf.finals.layer.type_vector,layerOpacity:k?k.opacity||1:1,setLayerOpacity:function(o){if(o){this.layerOpacity=parseFloat(o)}this.setOpacity(this.layerOpacity)},hasLabels:false});m.id=n;return m};GIS.core.MeasureWindow=function(j){var l,k,m,o,n;n=new OpenLayers.StyleMap({"default":new OpenLayers.Style()});o=new OpenLayers.Control.Measure(OpenLayers.Handler.Path,{persist:true,immediate:true,handlerOption:{layerOptions:{styleMap:n}}});m=function(p){if(p.measure){k.setText(p.measure.toFixed(2)+" "+p.units)}};j.olmap.addControl(o);o.events.on({measurepartial:m,measure:m});o.geodesic=true;o.activate();k=Ext.create("Ext.form.Label",{style:"height: 20px",text:"0 km"});l=Ext.create("Ext.window.Window",{title:GIS.i18n.measure_distance,layout:"fit",cls:"gis-container-default gis-plugin",bodyStyle:"text-align: center",width:130,minWidth:130,resizable:false,items:k,listeners:{show:function(){var p=j.viewport.eastRegion.getPosition()[0]-this.getWidth()-3,q=j.viewport.centerRegion.getPosition()[1]+26;this.setPosition(p,q)},destroy:function(){o.deactivate();j.olmap.removeControl(o)}}});return l};GIS.core.MapLoader=function(s,j,m){var n,l,q,k,r=[],p,o=Ext.isObject(m)&&Ext.Array.from(m.mapViews).length?m.mapViews:null;n=function(){var v="json",u=s.init.contextPath+"/api/maps/"+s.map.id+"."+v+"?fields="+s.conf.url.mapFields.join(","),w,t;s.ajax({url:u,success:function(A){A=Ext.decode(A.responseText);if(Ext.isArray(A.mapViews)){for(var y=0,x,B;y<A.mapViews.length;y++){x=A.mapViews[y];if(Ext.isArray(x.dataDimensionItems)&&x.dataDimensionItems.length&&Ext.isObject(x.dataDimensionItems[0])){var z=x.dataDimensionItems[0];if(z.hasOwnProperty("dataElement")){B="de"}else{if(z.hasOwnProperty("dataSet")){B="ds"}else{B="in"}}}}}s.map=A;l()},failure:function(x){s.olmap.mask.hide();x=Ext.decode(x.responseText);if(Ext.Array.contains([403],parseInt(x.httpStatusCode))){x.message=GIS.i18n.you_do_not_have_access_to_all_items_in_this_favorite||x.message}s.alert(x)}})};l=function(){var u=s.map.mapViews,t;if(s.dashboard&&s.viewport.northRegion&&s.map&&s.map.name){s.viewport.northRegion.update(s.map.name)}if(!(Ext.isArray(u)&&u.length)){s.olmap.mask.hide();s.alert(GIS.i18n.favorite_outdated_create_new);return}for(var w=0,v;w<u.length;w++){v=o?o[w]:null;u[w]=s.api.layout.Layout(u[w],v)}u=Ext.Array.clean(u);if(!u.length){s.olmap.mask.hide();return}if(s.viewport&&s.viewport.favoriteWindow&&s.viewport.favoriteWindow.isVisible()){s.viewport.favoriteWindow.destroy()}s.olmap.closeAllLayers();for(var w=0,x;w<u.length;w++){x=u[w];t=s.layer[x.layer].core.getLoader();t.updateGui=!s.el;t.callBack=k;t.load(x)}};k=function(t){r.push(t);if(r.length===s.map.mapViews.length){q()}};q=function(){var w=parseFloat(s.map.longitude)||0,v=parseFloat(s.map.latitude)||20,t=s.map.zoom||3;r=[];if((w>=-180&&w<=180)&&(v>=-90&&v<=90)){var u=new OpenLayers.Geometry.Point(w,v).transform("EPSG:4326","EPSG:900913");w=u.x;v=u.y}if(s.el||j){s.olmap.zoomToVisibleExtent()}else{s.olmap.setCenter(new OpenLayers.LonLat(w,v),t)}if(s.viewport.shareButton){s.viewport.shareButton.enable()}if(GIS.isSessionStorage){s.util.layout.setSessionStorage("map",s.util.layout.getAnalytical())}s.olmap.mask.hide()};p={load:function(t){if(s.olmap.mask&&!s.skipMask){s.olmap.mask.show()}if(s.map&&s.map.id){n()}else{if(t){s.map={mapViews:t}}l()}}};return p};GIS.core.LayerLoaderEvent=function(s,l){var k=l.map,m,o,n,j,r,p,q=s.conf.finals.dimension;o=function(t){n(t)};n=function(t){var y="?",w=[],x;t=t||l.core.view;y+="stage="+t.stage.id;y+="&startDate="+t.startDate;y+="&endDate="+t.endDate;if(Ext.isArray(t.organisationUnits)){y+="&dimension=ou:";for(var v=0;v<t.organisationUnits.length;v++){y+=t.organisationUnits[v].id;y+=v<t.organisationUnits.length-1?";":""}}for(var v=0,u;v<t.dataElements.length;v++){u=t.dataElements[v];y+="&dimension="+u.dimension+(u.filter?":"+u.filter:"")}x=function(A){var K=[],B=[],M=[],z,C,J,D,H=Ext.clone(A.metaData.names),I={"true":GIS.i18n.yes||"Yes","false":GIS.i18n.no||"No"},G;G=function(){for(var P=0,U;P<A.headers.length;P++){U=A.headers[P];H[U.name]=U.column}for(var P=0,T,S;P<M.length;P++){T=M[P];S={};for(var O=0,R;O<T.length;O++){R=T[O];S[A.headers[O].name]=I[R]||A.metaData.optionNames[R]||H[R]||R}S[s.conf.finals.widget.value]=0;S.label=S.ouname;S.popupText=S.ouname;S.nameColumnMap=Ext.apply(H,A.metaData.optionNames,A.metaData.booleanNames);K.push(S)}for(var P=0,Q,N;P<K.length;P++){Q=K[P];N=s.util.map.getTransformedPointByXY(Q.longitude,Q.latitude);B.push(new OpenLayers.Feature.Vector(N,Q))}l.removeFeatures(l.features);l.addFeatures(B);j(t)};getOptionSets=function(){if(!D){G()}else{dhis2.gis.store.get("optionSets",D.optionSet).done(function(N){Ext.apply(A.metaData.optionNames,s.util.array.getObjectMap(N.options,"code","name"));G()})}};A.metaData.optionNames={};for(var E=0,F;E<A.headers.length;E++){F=A.headers[E];H[F.name]=F.column;if(F.name==="longitude"){z=E}if(F.name==="latitude"){C=E}if(Ext.isString(F.optionSet)&&F.optionSet.length){J=E;D=F}}if(Ext.isArray(A.rows)&&A.rows.length){for(var E=0,L;E<A.rows.length;E++){L=A.rows[E];if(L[z]&&L[C]){M.push(L)}}}if(!M.length){s.alert("No event coordinates found");k.mask.hide();return}getOptionSets()};s.ajax({url:s.init.contextPath+"/api/analytics/events/query/"+t.program.id+".json"+y,disableCaching:false,failure:function(z){s.alert(z)},success:function(z){x(Ext.decode(z.responseText))}})};j=function(t){t=t||l.core.view;var u={indicator:s.conf.finals.widget.value,method:2,numClasses:5,colors:l.core.getColors("000000","222222"),minSize:5,maxSize:5};l.core.view=t;l.core.applyClassification(u);r(t)};r=function(t){if(l.item){l.item.setValue(true,t.opacity)}else{l.setLayerOpacity(t.opacity)}if(p.updateGui&&Ext.isObject(l.widget)){l.widget.setGui(t)}if(p.zoomToVisibleExtent){k.zoomToVisibleExtent()}if(p.hideMask){k.mask.hide()}if(p.callBack){p.callBack(l)}else{s.map=null}};p={compare:false,updateGui:false,zoomToVisibleExtent:false,hideMask:false,callBack:null,load:function(t){if(s.olmap.mask&&!s.skipMask){s.olmap.mask.show()}o(t)},loadData:n,loadLegend:j};return p};GIS.core.LayerLoaderFacility=function(s,m){var k=m.map,n,p,o,j,l,r,q;n=function(v,y){var A=m.core.view,z,u,t,w;q.zoomToVisibleExtent=true;if(!A){if(y){p(v)}return s.conf.finals.widget.loadtype_organisationunit}z=[];u=v.rows[0];t=[];w=A.rows[0];if(u.items.length===w.items.length){for(var x=0;x<u.items.length;x++){z.push(u.items[x].id)}for(var x=0;x<w.items.length;x++){t.push(w.items[x].id)}if(Ext.Array.difference(z,t).length!==0){if(y){p(v)}return s.conf.finals.widget.loadtype_organisationunit}}else{if(y){p(v)}return s.conf.finals.widget.loadtype_organisationunit}q.zoomToVisibleExtent=false;if(v.organisationUnitGroupSet.id!==A.organisationUnitGroupSet.id){if(y){p(v)}return s.conf.finals.widget.loadtype_organisationunit}if(y){j(v);return s.conf.finals.widget.loadtype_legend}};p=function(t){var u=t.rows[0].items,w=function(){var z="?ou=ou:";for(var y=0;y<u.length;y++){z+=u[y].id;z+=y!==u.length-1?";":""}z+="&displayProperty="+s.init.userAccount.settings.keyAnalysisDisplayProperty.toUpperCase();if(Ext.isArray(t.userOrgUnit)&&t.userOrgUnit.length){z+="&userOrgUnit=";for(var y=0;y<t.userOrgUnit.length;y++){z+=t.userOrgUnit[y]+(y<t.userOrgUnit.length-1?";":"")}}return s.init.contextPath+"/api/geoFeatures.json"+z+"&includeGroupSets=true"}(),x,v;x=function(A){var y=m.core.decode(A),B=new OpenLayers.Format.GeoJSON(),z=s.util.map.getTransformedFeatureArray(B.read(y));if(!Ext.isArray(z)){k.mask.hide();s.alert(GIS.i18n.invalid_coordinates);return}if(!z.length){k.mask.hide();s.alert(GIS.i18n.no_valid_coordinates_found);return}m.core.featureStore.loadFeatures(z.slice(0));o(t,z)};v=function(){k.mask.hide();s.alert(GIS.i18n.coordinates_could_not_be_loaded)};s.ajax({url:w,disableCaching:false,success:function(y){x(y)}})};o=function(t,v){t=t||m.core.view;v=v||m.core.featureStore.features;for(var u=0;u<v.length;u++){v[u].attributes.popupText=v[u].attributes.name+" ("+v[u].attributes[t.organisationUnitGroupSet.id]+")"}m.removeFeatures(m.features);m.addFeatures(v);j(t)};j=function(u){var w=GIS.plugin&&!GIS.app,y="json",v=s.init.contextPath+"/api/organisationUnitGroupSets/"+u.organisationUnitGroupSet.id+"."+y+"?fields=organisationUnitGroups[id,name,symbol]",z;u=u||m.core.view;for(var x=0,t;x<m.features.length;x++){t=m.features[x].attributes;t.label=u.labels?t.name:""}m.styleMap=GIS.core.StyleMap(u);z=function(B){var C=B.organisationUnitGroups,A={indicator:u.organisationUnitGroupSet.id};s.store.groupsByGroupSet.loadData(C);m.core.view=u;m.core.applyClassification({indicator:u.organisationUnitGroupSet.id});l(u);r(u)};s.ajax({url:v,success:function(A){z(A)}})};l=function(u){var t=u.areaRadius;if(m.circleLayer){m.circleLayer.deactivateControls();m.circleLayer=null}if(Ext.isDefined(t)&&t){m.circleLayer=GIS.core.CircleLayer(s,m.features,t);nissa=m.circleLayer}};r=function(t){s.viewport.eastRegion.doLayout();if(m.legendPanel){m.legendPanel.expand()}if(m.item){m.item.setValue(true,t.opacity)}else{m.setLayerOpacity(t.opacity)}if(q.updateGui&&Ext.isObject(m.widget)){m.widget.setGui(t)}if(q.zoomToVisibleExtent){k.zoomToVisibleExtent()}if(q.hideMask){k.mask.hide()}if(q.callBack){q.callBack(m)}else{s.map=null;if(s.viewport.shareButton){s.viewport.shareButton.enable()}}};q={compare:false,updateGui:false,zoomToVisibleExtent:false,hideMask:false,callBack:null,load:function(t){if(s.olmap.mask&&!s.skipMask){s.olmap.mask.show()}if(this.compare){n(t,true)}else{p(t)}},loadData:o,loadLegend:j};return q};GIS.core.LayerLoaderBoundary=function(r,l){var k=l.map,m,o,n,j,q,p;m=function(u,x){var z=l.core.view,y,t,s,v;if(!z){if(x){o(u)}return r.conf.finals.widget.loadtype_organisationunit}y=[];t=u.rows[0];s=[];v=z.rows[0];if(t.items.length===v.items.length){for(var w=0;w<t.items.length;w++){y.push(t.items[w].id)}for(var w=0;w<v.items.length;w++){s.push(v.items[w].id)}if(Ext.Array.difference(y,s).length!==0){if(x){o(u)}return r.conf.finals.widget.loadtype_organisationunit}if(x){p.zoomToVisibleExtent=false;j(u)}return r.conf.finals.widget.loadtype_legend}else{if(x){o(u)}return r.conf.finals.widget.loadtype_organisationunit}r.olmap.mask.hide()};o=function(s){var t=s.rows[0].items,v=function(){var y="?ou=ou:";for(var x=0;x<t.length;x++){y+=t[x].id;y+=x!==t.length-1?";":""}y+="&displayProperty="+r.init.userAccount.settings.keyAnalysisDisplayProperty.toUpperCase();if(Ext.isArray(s.userOrgUnit)&&s.userOrgUnit.length){y+="&userOrgUnit=";for(var x=0;x<s.userOrgUnit.length;x++){y+=s.userOrgUnit[x]+(x<s.userOrgUnit.length-1?";":"")}}return r.init.contextPath+"/api/geoFeatures.json"+y}(),w,u;w=function(x){var y=r.util.geojson.decode(Ext.decode(x.responseText),"DESC"),F=new OpenLayers.Format.GeoJSON(),A=r.util.map.getTransformedFeatureArray(F.read(y)),z=["black","blue","red","green","yellow"],G=[],B={};if(!Ext.isArray(A)){k.mask.hide();r.alert(GIS.i18n.invalid_coordinates);return}if(!A.length){k.mask.hide();r.alert(GIS.i18n.no_valid_coordinates_found);return}for(var D=0;D<A.length;D++){G.push(parseFloat(A[D].attributes.level))}G=Ext.Array.unique(G).sort();for(var D=0;D<G.length;D++){B[G[D]]={strokeColor:z[D]}}for(var D=0,H,C,E;D<A.length;D++){H=A[D];C=B[H.attributes.level];E=G.length===1?1:H.attributes.level==2?2:1;H.style={strokeColor:C.strokeColor||"black",strokeWidth:E,fillOpacity:0,pointRadius:5,labelAlign:"cr",labelYOffset:13}}l.core.featureStore.loadFeatures(A.slice(0));n(s,A)};u=function(){k.mask.hide();r.alert(GIS.i18n.coordinates_could_not_be_loaded)};r.ajax({url:v,disableCaching:false,success:function(x){w(x)}})};n=function(s,u){s=s||l.core.view;u=u||l.core.featureStore.features;for(var t=0;t<u.length;t++){u[t].attributes.value=0;u[t].attributes.popupText=u[t].attributes.name}l.removeFeatures(l.features);l.addFeatures(u);j(s)};j=function(s){s=s||l.core.view;for(var v=0,u;v<l.features.length;v++){attr=l.features[v].attributes;attr.label=s.labels?attr.name:""}var t={indicator:r.conf.finals.widget.value,method:2,numClasses:5,colors:l.core.getColors("000000","000000"),minSize:6,maxSize:6};l.core.view=s;l.core.applyClassification(t);l.core.setFeatureLabelStyle(s.labels,false,s);q(s)};q=function(s){if(l.item){l.item.setValue(true,s.opacity)}else{l.setLayerOpacity(s.opacity)}if(p.updateGui&&Ext.isObject(l.widget)){l.widget.setGui(s)}if(p.zoomToVisibleExtent){k.zoomToVisibleExtent()}if(p.hideMask){k.mask.hide()}if(p.callBack){p.callBack(l)}else{r.map=null;if(r.viewport.shareButton){r.viewport.shareButton.enable()}}if(l.unregisterMouseDownEvent){l.unregisterMouseDownEvent()}};p={compare:false,updateGui:false,zoomToVisibleExtent:false,hideMask:false,callBack:null,load:function(s){if(r.olmap.mask&&!r.skipMask){r.olmap.mask.show()}if(this.compare){m(s,true)}else{o(s)}},loadData:n,loadLegend:j};return p};GIS.core.LayerLoaderThematic=function(s,l){var k=l.map,m,o,n,j,r,p,q=s.conf.finals.dimension;m=function(v,y){var A=l.core.view,z,u,t,w;p.zoomToVisibleExtent=true;if(!A){if(y){o(v)}return s.conf.finals.widget.loadtype_organisationunit}z=[];u=v.rows[0];t=[];w=A.rows[0];if(u.items.length===w.items.length){for(var x=0;x<u.items.length;x++){z.push(u.items[x].id)}for(var x=0;x<w.items.length;x++){t.push(w.items[x].id)}if(Ext.Array.difference(z,t).length!==0){if(y){o(v)}return s.conf.finals.widget.loadtype_organisationunit}}else{if(y){o(v)}return s.conf.finals.widget.loadtype_organisationunit}p.zoomToVisibleExtent=false;z=[];u=v.columns[0];t=[];w=A.columns[0];if(u.items.length===w.items.length){for(var x=0;x<u.items.length;x++){z.push(u.items[x].id)}for(var x=0;x<w.items.length;x++){t.push(w.items[x].id)}if(Ext.Array.difference(z,t).length!==0){if(y){n(v)}return s.conf.finals.widget.loadtype_organisationunit}}else{if(y){n(v)}return s.conf.finals.widget.loadtype_organisationunit}z=[];u=v.filters[0];t=[];w=A.filters[0];if(u.items.length===w.items.length){for(var x=0;x<u.items.length;x++){z.push(u.items[x].id)}for(var x=0;x<w.items.length;x++){t.push(w.items[x].id)}if(Ext.Array.difference(z,t).length!==0){if(y){n(v)}return s.conf.finals.widget.loadtype_organisationunit}}else{if(y){n(v)}return s.conf.finals.widget.loadtype_organisationunit}if(y){p.zoomToVisibleExtent=false;j(v);return s.conf.finals.widget.loadtype_legend}};o=function(t){var u=t.rows[0].items,w=function(){var z="?ou=ou:";for(var y=0;y<u.length;y++){z+=u[y].id;z+=y!==u.length-1?";":""}z+="&displayProperty="+s.init.userAccount.settings.keyAnalysisDisplayProperty.toUpperCase();if(Ext.isArray(t.userOrgUnit)&&t.userOrgUnit.length){z+="&userOrgUnit=";for(var y=0;y<t.userOrgUnit.length;y++){z+=t.userOrgUnit[y]+(y<t.userOrgUnit.length-1?";":"")}}return s.init.contextPath+"/api/geoFeatures.json"+z}(),x,v;x=function(A){var y=s.util.geojson.decode(Ext.decode(A.responseText)),B=new OpenLayers.Format.GeoJSON(),z=s.util.map.getTransformedFeatureArray(B.read(y));if(!Ext.isArray(z)){k.mask.hide();s.alert(GIS.i18n.invalid_coordinates);return}if(!z.length){k.mask.hide();s.alert(GIS.i18n.no_valid_coordinates_found);return}l.core.featureStore.loadFeatures(z.slice(0));n(t,z)};v=function(){k.mask.hide();s.alert(GIS.i18n.coordinates_could_not_be_loaded)};s.ajax({url:w,disableCaching:false,success:function(y){x(y)},failure:function(){v()}})};n=function(A,v){var C;A=A||l.core.view;v=v||l.core.featureStore.features;var B=s.conf.finals.dimension,w="?",x=A.columns[0].items,t=A.columns[0].dimension===B.operand.objectName,u=A.filters[0].items,z=A.rows[0].items;w+="dimension=ou:";for(var y=0;y<z.length;y++){w+=z[y].id;w+=y<z.length-1?";":""}w+="&dimension=dx:";for(var y=0;y<x.length;y++){w+=t?x[y].id.split(".")[0]:x[y].id;w+=y<x.length-1?";":""}if(A.program){w+="&program="+A.program.id}w+=t?"&dimension=co":"";w+="&filter=pe:";for(var y=0;y<u.length;y++){w+=u[y].id;w+=y<u.length-1?";":""}w+="&displayProperty="+s.init.userAccount.settings.keyAnalysisDisplayProperty.toUpperCase();if(Ext.isArray(A.userOrgUnit)&&A.userOrgUnit.length){w+="&userOrgUnit=";for(var y=0;y<A.userOrgUnit.length;y++){w+=A.userOrgUnit[y]+(y<A.userOrgUnit.length-1?";":"")}}if(A.relativePeriodDate){w+="&relativePeriodDate="+A.relativePeriodDate}C=function(P){var I=s.api.response.Response(P),N={},F={},K,H,M,G=[],D,L=[];if(!I){k.mask.hide();return}for(var J=0;J<I.headers.length;J++){if(I.headers[J].name===B.organisationUnit.dimensionName){K=J}else{if(I.headers[J].name===B.value.dimensionName){M=J}}}for(var J=0,E;J<v.length;J++){var E=v[J].attributes.id;N[E]=true}for(var J=0;J<I.rows.length;J++){var E=I.rows[J][K],O=parseFloat(I.rows[J][M]);F[E]=O}for(var J=0;J<v.length;J++){var Q=v[J],E=Q.attributes.id;if(N.hasOwnProperty(E)&&F.hasOwnProperty(E)){Q.attributes.value=F[E];Q.attributes.popupText=Q.attributes.name+" ("+Q.attributes.value+")";G.push(Q)}}l.removeFeatures(l.features);l.addFeatures(G);s.response=I;j(A)};s.ajax({url:s.init.contextPath+"/api/analytics.json"+w,disableCaching:false,failure:function(D){s.alert(D)},success:function(D){C(Ext.decode(D.responseText))}})};j=function(C){var t=[],u=[],A=[],x=[],E,B;C=C||l.core.view;for(var w=0,D;w<l.features.length;w++){attr=l.features[w].attributes;attr.label=C.labels?attr.name+" ("+attr.value+")":""}l.styleMap=GIS.core.StyleMap(C);E=function(I){var G=Ext.Array.clean([].concat(C.columns||[],C.rows||[],C.filters||[])),H=I.metaData,N=H[q.period.objectName];for(var L=0,J;L<G.length;L++){J=G[L];for(var K=0,M;K<J.items.length;K++){M=J.items[K];if(M.id.indexOf(".")!==-1){var F=M.id.split(".");M.name=H.names[F[0]]+" "+H.names[F[1]]}else{M.name=H.names[M.id]}}}C.filters[0].items[0].name=H.names[N[N.length-1]]};B=function(){E(s.response);var F={indicator:s.conf.finals.widget.value,method:C.legendSet?mapfish.GeoStat.Distribution.CLASSIFY_WITH_BOUNDS:C.method,numClasses:C.classes,bounds:t,colors:l.core.getColors(C.colorLow,C.colorHigh),minSize:C.radiusLow,maxSize:C.radiusHigh};l.core.view=C;l.core.colorInterpolation=u;l.core.applyClassification(F);r(C)};loadLegendSet=function(F){s.ajax({url:s.init.contextPath+"/api/legendSets/"+F.legendSet.id+".json?fields="+s.conf.url.legendSetFields.join(","),scope:this,disableCaching:false,success:function(H){x=Ext.decode(H.responseText).legends;Ext.Array.sort(x,function(J,I){return J.startValue-I.startValue});for(var G=0;G<x.length;G++){if(t[t.length-1]!==x[G].startValue){if(t.length!==0){u.push(new mapfish.ColorRgb(240,240,240));A.push("")}t.push(x[G].startValue)}u.push(new mapfish.ColorRgb());u[u.length-1].setFromHex(x[G].color);A.push(x[G].name);t.push(x[G].endValue)}F.legendSet.names=A;F.legendSet.bounds=t;F.legendSet.colors=u},callback:function(){B()}})};if(C.legendSet){loadLegendSet(C)}else{var z={"in":"indicators",de:"dataElements",ds:"dataSets"},y=z[C.columns[0].objectName],v=C.columns[0].items[0].id;if(!y){B();return}s.ajax({url:s.init.contextPath+"/api/"+y+".json?fields=legendSet[id,name]&paging=false&filter=id:eq:"+v,success:function(F){var G=Ext.decode(F.responseText)[y],H;if(Ext.Array.from(G).length){H=Ext.isObject(G[0])?G[0].legendSet||null:null}if(H){C.legendSet=H;loadLegendSet(C)}else{B()}},failure:function(){B()}})}};r=function(t){s.viewport.eastRegion.doLayout();if(l.legendPanel){l.legendPanel.expand()}l.setLayerOpacity(t.opacity);if(l.item){l.item.setValue(true)}if(l.filterWindow&&l.filterWindow.isVisible()){l.filterWindow.filter()}if(p.updateGui&&Ext.isObject(l.widget)){l.widget.setGui(t)}if(p.zoomToVisibleExtent){k.zoomToVisibleExtent()}if(p.hideMask){k.mask.hide()}if(p.callBack){p.callBack(l)}else{s.map=null;if(s.viewport.shareButton){s.viewport.shareButton.enable()}}if(GIS.isSessionStorage){s.util.layout.setSessionStorage("map",s.util.layout.getAnalytical())}};p={compare:false,updateGui:false,zoomToVisibleExtent:false,hideMask:false,callBack:null,load:function(t){if(s.olmap.mask&&!s.skipMask){s.olmap.mask.show()}if(this.compare){m(t,true)}else{o(t)}},loadData:n,loadLegend:j};return p};GIS.core.CircleLayer=function(t,k,q){var r=t.util.map.getPointsByFeatures(k),j=t.util.map.getLonLatsByPoints(r),s=[],o,p=new OpenLayers.Layer.Vector(),n,m,l={};q=q&&Ext.isNumber(parseInt(q))?parseInt(q):5;n=function(){for(var u=0;u<s.length;u++){s[u].deactivate()}};m=function(){if(j.length){for(var u=0;u<j.length;u++){o=new OpenLayers.Control.Circle({layer:p});o.lonLat=j[u];s.push(o)}t.olmap.addControls(s);for(var u=0;u<s.length;u++){o=s[u];o.activate();o.updateCircle(o.lonLat,q)}}}();p.deactivateControls=n;return p};GIS.core.getInstance=function(q,j){var n={},l={},o={},m={},p=[],k={};k.alert=function(){console.log(".")};(function(){n.finals={url:{path_commons:"/dhis-web-commons-ajax-json/"},layer:{type_base:"base",type_vector:"vector",category_thematic:"thematic"},dimension:{data:{id:"data",value:"data",param:"dx",dimensionName:"dx",objectName:"dx"},category:{name:GIS.i18n.categories,dimensionName:"co",objectName:"co"},indicator:{id:"indicator",value:"indicators",param:"in",dimensionName:"dx",objectName:"in"},dataElement:{id:"dataElement",value:"dataElement",param:"de",dimensionName:"dx",objectName:"de"},operand:{id:"operand",value:"operand",param:"dc",dimensionName:"dx",objectName:"dc"},dataSet:{value:"dataSets",dimensionName:"dx",objectName:"ds"},period:{id:"period",value:"period",param:"pe",dimensionName:"pe",objectName:"pe"},organisationUnit:{id:"organisationUnit",value:"organisationUnit",param:"ou",dimensionName:"ou",objectName:"ou"},value:{id:"value",value:"value",param:"value",dimensionName:"value",objectName:"value"}},widget:{value:"value",legendtype_automatic:"automatic",legendtype_predefined:"predefined",symbolizer_color:"color",symbolizer_image:"image",loadtype_organisationunit:"organisationUnit",loadtype_data:"data",loadtype_legend:"legend"},openLayers:{point_classname:"OpenLayers.Geometry.Point"},mapfish:{classify_with_bounds:1,classify_by_equal_intervals:2,classify_by_quantils:3},root:{id:"root"}};n.layout={widget:{item_width:288,itemlabel_width:95,window_width:306},tool:{item_width:228,itemlabel_width:95,window_width:250},grid:{row_height:27},layer:{opacity:0.8}};n.period={periodTypes:[{id:"relativePeriods",name:GIS.i18n.relative},{id:"Daily",name:GIS.i18n.daily},{id:"Weekly",name:GIS.i18n.weekly},{id:"Monthly",name:GIS.i18n.monthly},{id:"BiMonthly",name:GIS.i18n.bimonthly},{id:"Quarterly",name:GIS.i18n.quarterly},{id:"SixMonthly",name:GIS.i18n.sixmonthly},{id:"SixMonthlyApril",name:GIS.i18n.sixmonthly_april},{id:"Yearly",name:GIS.i18n.yearly},{id:"FinancialOct",name:GIS.i18n.financial_oct},{id:"FinancialJuly",name:GIS.i18n.financial_july},{id:"FinancialApril",name:GIS.i18n.financial_april}],relativePeriods:[{id:"THIS_WEEK",name:GIS.i18n.this_week},{id:"LAST_WEEK",name:GIS.i18n.last_week},{id:"THIS_MONTH",name:GIS.i18n.this_month},{id:"LAST_MONTH",name:GIS.i18n.last_month},{id:"THIS_BIMONTH",name:GIS.i18n.this_bimonth},{id:"LAST_BIMONTH",name:GIS.i18n.last_bimonth},{id:"THIS_QUARTER",name:GIS.i18n.this_quarter},{id:"LAST_QUARTER",name:GIS.i18n.last_quarter},{id:"THIS_SIX_MONTH",name:GIS.i18n.this_sixmonth},{id:"LAST_SIX_MONTH",name:GIS.i18n.last_sixmonth},{id:"THIS_FINANCIAL_YEAR",name:GIS.i18n.this_financial_year},{id:"LAST_FINANCIAL_YEAR",name:GIS.i18n.last_financial_year},{id:"THIS_YEAR",name:GIS.i18n.this_year},{id:"LAST_YEAR",name:GIS.i18n.last_year}],relativePeriodsMap:{},relativePeriodRecordsMap:{},integratedRelativePeriodsMap:{THIS_WEEK:"THIS_WEEK",LAST_WEEK:"LAST_WEEK",LAST_4_WEEKS:"LAST_WEEK",LAST_12_WEEKS:"LAST_WEEK",THIS_MONTH:"THIS_MONTH",LAST_MONTH:"LAST_MONTH",LAST_3_MONTHS:"LAST_MONTH",LAST_12_MONTHS:"LAST_MONTH",THIS_BIMONTH:"THIS_BIMONTH",LAST_BIMONTH:"LAST_BIMONTH",LAST_6_BIMONTHS:"LAST_BIMONTH",THIS_QUARTER:"THIS_QUARTER",LAST_QUARTER:"LAST_QUARTER",LAST_4_QUARTERS:"LAST_QUARTER",THIS_SIX_MONTH:"THIS_SIX_MONTH",LAST_SIX_MONTH:"LAST_SIX_MONTH",LAST_2_SIXMONTHS:"LAST_SIX_MONTH",LAST_FINANCIAL_YEAR:"LAST_FINANCIAL_YEAR",LAST_5_FINANCIAL_YEARS:"LAST_FINANCIAL_YEAR",THIS_YEAR:"THIS_YEAR",LAST_YEAR:"LAST_YEAR",LAST_5_YEARS:"LAST_YEAR"}};for(var r=0,s;r<n.period.relativePeriods.length;r++){s=n.period.relativePeriods[r];n.period.relativePeriodsMap[s.id]=s.name;n.period.relativePeriodRecordsMap[s.id]={id:s.id,name:s.name}}n.url={};n.url.analysisFields=["*","columns[dimension,filter,items[id,"+q.namePropertyUrl+"]]","rows[dimension,filter,items[id,"+q.namePropertyUrl+"]]","filters[dimension,filter,items[id,"+q.namePropertyUrl+"]]","!lastUpdated","!href","!created","!publicAccess","!rewindRelativePeriods","!userOrganisationUnit","!userOrganisationUnitChildren","!userOrganisationUnitGrandChildren","!externalAccess","!access","!relativePeriods","!columnDimensions","!rowDimensions","!filterDimensions","!user","!organisationUnitGroups","!itemOrganisationUnitGroups","!userGroupAccesses","!indicators","!dataElements","!dataElementOperands","!dataElementGroups","!dataSets","!periods","!organisationUnitLevels","!organisationUnits","!sortOrder","!topLimit"];n.url.mapFields=[n.url.analysisFields.join(","),"mapViews["+n.url.analysisFields.join(",")+"]"];n.url.legendFields=["*","!created","!lastUpdated","!displayName","!externalAccess","!access","!userGroupAccesses"];n.url.legendSetFields=["id,name,legends["+n.url.legendFields.join(",")+"]"]}());(function(){l.map={};l.map.getVisibleVectorLayers=function(){var t=[];for(var s=0,r;s<k.olmap.layers.length;s++){r=k.olmap.layers[s];if(r.layerType===n.finals.layer.type_vector&&r.visibility&&r.features.length){t.push(r)}}return t};l.map.getRenderedVectorLayers=function(){var t=[];for(var s=0,r;s<k.olmap.layers.length;s++){r=k.olmap.layers[s];if(r.layerType===n.finals.layer.type_vector&&r.features.length){t.push(r)}}return t};l.map.getExtendedBounds=function(t){var s=null;if(t.length){s=t[0].getDataExtent();if(t.length>1){for(var r=1;r<t.length;r++){s.extend(t[r].getDataExtent())}}}return s};l.map.zoomToVisibleExtent=function(s){var r=l.map.getExtendedBounds(l.map.getVisibleVectorLayers(s));if(r){s.zoomToExtent(r)}};l.map.getTransformedFeatureArray=function(u){var r=new OpenLayers.Projection("EPSG:4326"),s=new OpenLayers.Projection("EPSG:900913");for(var t=0;t<u.length;t++){u[t].geometry.transform(r,s)}return u};l.map.getPointsByFeatures=function(t){var r=[];for(var s=0;s<t.length;s++){if(t[s].geometry.CLASS_NAME===k.conf.finals.openLayers.point_classname){r.push(t[s])}}return r};l.map.getLonLatsByPoints=function(v){var t,r,s=[];for(var u=0;u<v.length;u++){r=v[u];t=new OpenLayers.LonLat(r.geometry.x,r.geometry.y);s.push(t)}return s};l.geojson={};l.geojson.decode=function(x,y){var t={type:"FeatureCollection",crs:{type:"EPSG",properties:{code:"4326"}},features:[]};y=y||"ASC";l.array.sort(x,y,"le");for(var u=0,w,s="",r="";u<x.length;u++){w=x[u];if(Ext.isString(w.pg)&&w.pg.length){var v=Ext.Array.clean(w.pg.split("/"));if(v.length>=2){s=v[v.length-2]}if(v.length>2){r="/"+v.slice(0,v.length-2).join("/")}}t.features.push({type:"Feature",geometry:{type:parseInt(w.ty)===1?"Point":"MultiPolygon",coordinates:JSON.parse(w.co)},properties:{id:w.id,name:w.na,hasCoordinatesDown:w.hcd,hasCoordinatesUp:w.hcu,level:w.le,grandParentParentGraph:r,grandParentId:s,parentGraph:w.pg,parentId:w.pi,parentName:w.pn}})}return t};l.gui={};l.gui.combo={};l.gui.combo.setQueryMode=function(r,t){for(var s=0;s<r.length;s++){r[s].queryMode=t}};l.object={};l.object.getLength=function(r){var t=0;for(var s in r){if(r.hasOwnProperty(s)){t++}}return t};l.array={};l.array.getLength=function(s,r){if(!Ext.isArray(s)){if(!r){console.log("support.prototype.array.getLength: not an array")}return null}return s.length};l.array.sort=function(u,t,s,r){if(!l.array.getLength(u,true)){return}s=!!s||Ext.isNumber(s)?s:"name";u.sort(function(w,v){if(Ext.isObject(w)&&Ext.isObject(v)){w=w[s];v=v[s]}if(Ext.isArray(w)&&Ext.isArray(v)){w=w[s];v=v[s]}if(Ext.isString(w)&&Ext.isString(v)){w=w.toLowerCase();v=v.toLowerCase();if(t==="DESC"){return w<v?1:(w>v?-1:0)}else{return w<v?-1:(w>v?1:0)}}else{if(Ext.isNumber(w)&&Ext.isNumber(v)){return t==="DESC"?v-w:w-v}else{if(w===undefined||w===null){return r?-1:1}else{if(v===undefined||v===null){return r?1:-1}}}}return -1});return u};l.array.getObjectMap=function(x,s,r,w){if(!(Ext.isArray(x)&&x.length)){return{}}var v={};s=s||"id";r=r||"name";w=w||"";for(var t=0,u;t<x.length;t++){u=x[t];v[w+u[s]]=u[r]}return v};l.layout={};l.layout.getAnalytical=function(w){var v,u;if(Ext.isObject(w)&&Ext.isArray(w.mapViews)&&w.mapViews.length){for(var t=0,r,x;t<w.mapViews.length;t++){r=w.mapViews[t];x=r.layer;if(k.layer.hasOwnProperty(x)&&k.layer[x].layerCategory===k.conf.finals.layer.category_thematic){v=k.api.layout.Layout(r);if(v){return v}}}}else{for(var s in k.layer){if(k.layer.hasOwnProperty(s)&&k.layer[s].layerCategory===k.conf.finals.layer.category_thematic&&k.layer[s].core.view){u=k.layer[s];v=k.api.layout.Layout(u.core.view);if(v){if(!v.parentGraphMap&&u.widget){v.parentGraphMap=u.widget.getParentGraphMap()}return v}}}}return};l.layout.getPluginConfig=function(){var u=k.util.map.getVisibleVectorLayers(),t={};if(k.map){return k.map}t.mapViews=[];for(var s=0,r;s<u.length;s++){r=u[s];if(r.core.view){r.core.view.layer=r.id;t.mapViews.push(r.core.view)}}return t};l.layout.setSessionStorage=function(u,t,s){if(GIS.isSessionStorage){var r=JSON.parse(sessionStorage.getItem("dhis2"))||{};r[u]=t;sessionStorage.setItem("dhis2",JSON.stringify(r));if(Ext.isString(s)){window.location.href=s}}};l.layout.getDataDimensionsFromLayout=function(v){var u=Ext.Array.clean([].concat(v.columns||[],v.rows||[],v.filters||[])),t=["pe","ou"],r=[];for(var s=0;s<u.length;s++){if(!Ext.Array.contains(t,u[s].dimension)){r.push(u[s])}}return r};l.date={};l.date.getYYYYMMDD=function(u){if(!Ext.isString(u)){if(!(Object.prototype.toString.call(u)==="[object Date]"&&u.toString()!=="Invalid date")){return null}}var s=new Date(u),t=""+(1+s.getMonth()),r=""+s.getDate();t=t.length===1?"0"+t:t;r=r.length===1?"0"+r:r;return s.getFullYear()+"-"+t+"-"+r};l.message={};l.message.alert=function(u){var r={},s,t;if(!u||(Ext.isObject(u)&&!u.message&&!u.responseText)){return}if(Ext.isObject(u)&&u.responseText&&!u.message){u=Ext.decode(u.responseText)}if(Ext.isString(u)){u={status:"ERROR",message:u}}if(k.dashboard){k.viewport.centerRegion.update('<div class="ns-plugin-alert">'+u.message+"</div>");return}s=(u.status||"INFO").toLowerCase();r.title=u.status;r.iconCls="gis-window-title-messagebox "+s;r.html="";r.html+=u.httpStatusCode?"Code: "+u.httpStatusCode+"<br>":"";r.html+=u.httpStatus?"Status: "+u.httpStatus+"<br><br>":"";r.html+=u.message+(u.message.substr(u.message.length-1)==="."?"":".");r.bodyStyle="padding: 12px; background: #fff; max-width: 600px; max-height: "+k.viewport.centerRegion.getHeight()/2+"px";r.modal=true;r.destroyOnBlur=true;r.listeners={show:function(v){v.setPosition(v.getPosition()[0],v.getPosition()[1]/2);if(!v.hasDestroyOnBlurHandler){k.util.gui.window.addDestroyOnBlurHandler(v)}}};t=Ext.create("Ext.window.Window",r);t.show()};l.connection={};l.connection.ajax=function(r,s){var t=s||j||{};if(t.crossDomain&&Ext.isString(t.username)&&Ext.isString(t.password)){r.headers=Ext.isObject(t.headers)?t.headers:{};r.headers.Authorization="Basic "+btoa(t.username+":"+t.password)}Ext.Ajax.request(r)}}());k.init=q;k.conf=n;k.util=l;(function(){var r=k.conf.finals.dimension;o.layout={};o.response={};o.layout.Record=function(t){var s;if(!Ext.isObject(t)){console.log("Record config is not an object",t);return}if(!Ext.isString(t.id)){console.log("Record id is not text",t);return}s=Ext.clone(t);if(Ext.isString(t.name)){s.name=t.name}return s};o.layout.Dimension=function(t){var v={};if(!Ext.isObject(t)){return}if(!Ext.isString(t.dimension)){console.log("Dimension name is not text",t);return}if(t.dimension!==n.finals.dimension.category.objectName){var s=[];if(!Ext.isArray(t.items)){console.log("Dimension items is not an array",t);return}for(var u=0;u<t.items.length;u++){record=o.layout.Record(t.items[u]);if(record){s.push(record)}}t.items=s;if(!t.items.length){console.log("Dimension has no valid items",t);return}}v.dimension=t.dimension;v.items=t.items;if(t.objectName){v.objectName=t.objectName}return Ext.clone(v)};o.layout.Layout=function(v,u,t){v=Ext.apply(v,u);var w={},s,x;s=function(B){var z=[];if(!(B&&Ext.isArray(B)&&B.length)){return}for(var y=0,A;y<B.length;y++){A=o.layout.Dimension(B[y]);if(A){z.push(A)}}B=z;return B.length?B:null};x=function(A){var C=Ext.Array.clean([].concat(A.columns||[],A.rows||[],A.filters||[])),E=n.period.integratedRelativePeriodsMap,z,F,y;for(var B=0,D;B<C.length;B++){D=C[B];if(D.dimension===r.data.objectName){z=D}else{if(D.dimension===r.period.objectName){F=D}else{if(D.dimension===r.organisationUnit.objectName){y=D}}}}if(!y){k.alert("No organisation units specified");return}if(z){z.items=[z.items[0]]}if(F){F.items=[F.items[0]];F.items[0].id=E[F.items[0].id]?E[F.items[0].id]:F.items[0].id}A.columns=[z];A.rows=[y];A.filters=[F];return A};return function(){var E=[],D=[],G=n.finals.dimension,z=isOu=false,y=false,H=false;v=x(v);if(!v){return}v.columns=s(v.columns);v.rows=s(v.rows);v.filters=s(v.filters);if(!v.rows){console.log("Organisation unit dimension is invalid",v.rows);return}if(Ext.Array.contains([k.layer.thematic1.id,k.layer.thematic2.id,k.layer.thematic3.id,k.layer.thematic4.id],v.layer)){if(!v.columns){return}}for(var B=0,C,F=Ext.Array.clean([].concat(v.columns,v.rows,v.filters));B<F.length;B++){C=F[B];if(C){if(Ext.isString(C.dimension)){D.push(C.dimension)}if(C.dimension===G.organisationUnit.objectName&&Ext.isArray(C.items)){for(var A=0;A<C.items.length;A++){if(C.items[A].id==="USER_ORGUNIT"){isOu=true}else{if(C.items[A].id==="USER_ORGUNIT_CHILDREN"){y=true}else{if(C.items[A].id==="USER_ORGUNIT_GRANDCHILDREN"){H=true}}}}}}}w.columns=v.columns;w.rows=v.rows;w.filters=v.filters;if(Ext.isObject(v.program)&&v.program.id){w.program=v.program}w.layer=Ext.isString(v.layer)&&!Ext.isEmpty(v.layer)?v.layer:"thematic1";w.classes=Ext.isNumber(v.classes)&&!Ext.isEmpty(v.classes)?v.classes:5;w.method=Ext.isNumber(v.method)&&!Ext.isEmpty(v.method)?v.method:2;w.colorLow=Ext.isString(v.colorLow)&&!Ext.isEmpty(v.colorLow)?v.colorLow:"ff0000";w.colorHigh=Ext.isString(v.colorHigh)&&!Ext.isEmpty(v.colorHigh)?v.colorHigh:"00ff00";w.radiusLow=Ext.isNumber(v.radiusLow)&&!Ext.isEmpty(v.radiusLow)?v.radiusLow:5;w.radiusHigh=Ext.isNumber(v.radiusHigh)&&!Ext.isEmpty(v.radiusHigh)?v.radiusHigh:15;w.opacity=Ext.isNumber(v.opacity)&&!Ext.isEmpty(v.opacity)?v.opacity:k.conf.layout.layer.opacity;w.areaRadius=v.areaRadius;w.labels=!!v.labels;w.labelFontSize=v.labelFontSize||"11px";w.labelFontSize=parseInt(w.labelFontSize)+"px";w.labelFontWeight=Ext.isString(v.labelFontWeight)||Ext.isNumber(v.labelFontWeight)?v.labelFontWeight:"normal";w.labelFontWeight=Ext.Array.contains(["normal","bold","bolder","lighter"],w.labelFontWeight)?w.labelFontWeight:"normal";w.labelFontWeight=Ext.isNumber(parseInt(w.labelFontWeight))&&parseInt(w.labelFontWeight)<=1000?w.labelFontWeight.toString():w.labelFontWeight;w.labelFontStyle=Ext.Array.contains(["normal","italic","oblique"],v.labelFontStyle)?v.labelFontStyle:"normal";w.labelFontColor=Ext.isString(v.labelFontColor)||Ext.isNumber(v.labelFontColor)?v.labelFontColor:"normal";w.labelFontColor=Ext.isNumber(w.labelFontColor)?w.labelFontColor.toString():w.labelFontColor;w.labelFontColor=w.labelFontColor.charAt(0)!=="#"?"#"+w.labelFontColor:w.labelFontColor;w.hidden=!!v.hidden;w.userOrganisationUnit=isOu;w.userOrganisationUnitChildren=y;w.userOrganisationUnitGrandChildren=H;w.parentGraphMap=Ext.isObject(v.parentGraphMap)?v.parentGraphMap:null;w.legendSet=v.legendSet;w.organisationUnitGroupSet=v.organisationUnitGroupSet;if(Ext.Array.from(v.userOrgUnit).length){w.userOrgUnit=Ext.Array.from(v.userOrgUnit)}if(l.date.getYYYYMMDD(v.relativePeriodDate)){w.relativePeriodDate=support.prototype.date.getYYYYMMDD(v.relativePeriodDate)}return Ext.apply(w,t)}()};o.response.Header=function(s){var t={};return function(){if(!Ext.isObject(s)){console.log("Header is not an object",s);return}if(!Ext.isString(s.name)){console.log("Header name is not text",s);return}if(!Ext.isBoolean(s.meta)){console.log("Header meta is not boolean",s);return}t.name=s.name;t.meta=s.meta;return Ext.clone(t)}()};o.response.Response=function(t){var s={};return function(){var v=[];if(!(t&&Ext.isObject(t))){k.alert("Data response invalid",t);return false}if(!(t.headers&&Ext.isArray(t.headers))){k.alert("Data response invalid",t);return false}for(var u=0,w;u<t.headers.length;u++){w=o.response.Header(t.headers[u]);if(w){v.push(w)}}t.headers=v;if(!t.headers.length){k.alert("No valid response headers",t);return}if(!(Ext.isArray(t.rows)&&t.rows.length>0)){k.alert("No values found",t);return false}if(t.headers.length!==t.rows[0].length){k.alert("Data invalid",t);return false}s.headers=t.headers;s.metaData=t.metaData;s.width=t.width;s.height=t.height;s.rows=t.rows;return s}()}}());k.alert=l.message.alert;k.api=o;k.store=m;k.olmap=GIS.core.getOLMap(k,j);k.layer=GIS.core.getLayers(k);k.thematicLayers=[k.layer.thematic1,k.layer.thematic2,k.layer.thematic3,k.layer.thematic4];p.push(k.layer.openStreetMap,k.layer.boundary,k.layer.thematic4,k.layer.thematic3,k.layer.thematic2,k.layer.thematic1,k.layer.facility,k.layer.event);k.olmap.addLayers(p);GIS.core.instances.push(k);return k};(function(){window.mapfish={_scriptName:"MapFish.js",_getScriptLocation:function(){if(window.gMfLocation){return window.gMfLocation}var m="";var n=mapfish._scriptName;var j=document.getElementsByTagName("script");for(var l=0;l<j.length;l++){var o=j[l].getAttribute("src");if(o){var k=o.lastIndexOf(n);if((k>-1)&&(k+n.length==o.length)){m=o.slice(0,-n.length);break}}}return m}};mapfish.Color=OpenLayers.Class({getColorRgb:function(){}});mapfish.ColorRgb=OpenLayers.Class(mapfish.Color,{redLevel:null,greenLevel:null,blueLevel:null,initialize:function(l,k,j){this.redLevel=l;this.greenLevel=k;this.blueLevel=j},equals:function(j){return j.redLevel==this.redLevel&&j.greenLevel==this.greenLevel&&j.blueLevel==this.blueLevel},getColorRgb:function(){return this},getRgbArray:function(){return[this.redLevel,this.greenLevel,this.blueLevel]},hex2rgbArray:function(j){if(j.charAt(0)=="#"){j=j.substr(1)}var k=[parseInt(j.substring(0,2),16),parseInt(j.substring(2,4),16),parseInt(j.substring(4,6),16)];for(var l=0;l<k.length;l++){if(k[l]<0||k[l]>255){OpenLayers.Console.error("Invalid rgb hex color string: rgbHexString")}}return k},setFromHex:function(j){var k=this.hex2rgbArray(j);this.redLevel=k[0];this.greenLevel=k[1];this.blueLevel=k[2]},setFromRgb:function(k){var j=dojo.colorFromString(k);this.redLevel=j.r;this.greenLevel=j.g;this.blueLevel=j.b},toHexString:function(){var l=this.toHex(this.redLevel);var k=this.toHex(this.greenLevel);var j=this.toHex(this.blueLevel);return"#"+l+k+j},toHex:function(o){var l="0123456789ABCDEF";if(o<0||o>255){var n="Invalid decimal value for color level";OpenLayers.Console.error(n)}var m=Math.floor(o/16);var k=o%16;return l.charAt(m)+l.charAt(k)},CLASS_NAME:"mapfish.ColorRgb"});mapfish.ColorRgb.getColorsArrayByRgbInterpolation=function(r,m,o){var s=[];var k=r.getColorRgb();var j=m.getColorRgb();var q=k.getRgbArray();var p=j.getRgbArray();if(o==1){return[k]}for(var n=0;n<o;n++){var l=[];l[0]=q[0]+n*(p[0]-q[0])/(o-1);l[1]=q[1]+n*(p[1]-q[1])/(o-1);l[2]=q[2]+n*(p[2]-q[2])/(o-1);s[n]=new mapfish.ColorRgb(parseInt(l[0]),parseInt(l[1]),parseInt(l[2]))}return s};mapfish.Util={};mapfish.Util.sum=function(l){for(var j=0,k=0;j<l.length;k+=l[j++]){}return k};mapfish.Util.max=function(j){return Math.max.apply({},j)};mapfish.Util.min=function(j){return Math.min.apply({},j)};mapfish.Util.getIconUrl=function(k,j){if(!j.layer){OpenLayers.Console.warn("Missing required layer option in mapfish.Util.getIconUrl");return""}if(!j.rule){j.rule=j.layer}if(k.indexOf("?")<0){k+="?"}else{if(k.lastIndexOf("&")!=(k.length-1)){if(k.indexOf("?")!=(k.length-1)){k+="&"}}}var j=OpenLayers.Util.extend({layer:"",rule:"",service:"WMS",version:"1.1.1",request:"GetLegendGraphic",format:"image/png",width:16,height:16},j);j=OpenLayers.Util.upperCaseObject(j);return k+OpenLayers.Util.getParameterString(j)};mapfish.Util.arrayEqual=function(k,j){if(k==null||j==null){return false}if(typeof(k)!="object"||typeof(j)!="object"){return false}if(k.length!=j.length){return false}for(var l=0;l<k.length;l++){if(typeof(k[l])!=typeof(j[l])){return false}if(k[l]!=j[l]){return false}}return true};mapfish.Util.isIE7=function(){var j=navigator.userAgent.toLowerCase();return j.indexOf("msie 7")>-1};mapfish.Util.relativeToAbsoluteURL=function(k){if(/^\w+:/.test(k)||!k){return k}var j=location.protocol+"//"+location.host;if(k.indexOf("/")==0){return j+k}var l=location.pathname.replace(/\/[^\/]*$/,"");return j+l+"/"+k};mapfish.Util.fixArray=function(j){if(j==""||j==null){return[]}else{if(j instanceof Array){return j}else{return j.split(",")}}};mapfish.GeoStat=OpenLayers.Class({layer:null,format:null,url:null,requestSuccess:function(j){},requestFailure:function(j){},indicator:null,defaultSymbolizer:{},legendDiv:null,initialize:function(l,j){this.map=l;this.addOptions(j);if(!this.layer){var k=new OpenLayers.Layer.Vector("geostat",{displayInLayerSwitcher:false,visibility:false});l.addLayer(k);this.layer=k}this.setUrl(this.url);this.legendDiv=Ext.get(j.legendDiv)},setUrl:function(j){this.url=j;if(this.url){OpenLayers.Request.GET({url:this.url,scope:this,success:this.requestSuccess,failure:this.requestFailure})}},getColors:function(j,l){var m=new mapfish.ColorRgb(),k=new mapfish.ColorRgb();m.setFromHex(j);k.setFromHex(l);return[m,k]},addOptions:function(j){if(j){if(!this.options){this.options={}}OpenLayers.Util.extend(this.options,j);OpenLayers.Util.extend(this,j)}},extendStyle:function(m,l,j){var k=this.layer.styleMap.styles["default"];if(m){k.rules=m}if(l){k.setDefaultStyle(OpenLayers.Util.applyDefaults(l,k.defaultStyle))}if(j){if(!k.context){k.context={}}OpenLayers.Util.extend(k.context,j)}},applyClassification:function(j){this.layer.renderer.clear();this.layer.redraw();this.updateLegend();this.layer.setVisibility(true)},showDetails:function(j){},hideDetails:function(j){},CLASS_NAME:"mapfish.GeoStat"});mapfish.GeoStat.Distribution=OpenLayers.Class({labelGenerator:function(k,m,n){var j=parseFloat(k.lowerBound).toFixed(1),l=parseFloat(k.upperBound).toFixed(1);return j+" - "+l+"&nbsp;&nbsp;("+k.nbVal+")"},values:null,nbVal:null,minVal:null,maxVal:null,initialize:function(j,k){OpenLayers.Util.extend(this,k);this.values=j;this.nbVal=j.length;this.minVal=this.nbVal?mapfish.Util.min(this.values):0;this.maxVal=this.nbVal?mapfish.Util.max(this.values):0},classifyWithBounds:function(l){var v=[];var s=[];var u=[];for(var r=0;r<this.values.length;r++){u.push(this.values[r])}u.sort(function(k,j){return k-j});var t=l.length-1;for(var q=0;q<t;q++){s[q]=0}for(var p=0;p<t-1;p){if(u[0]<l[p+1]){s[p]=s[p]+1;u.shift()}else{p++}}s[t-1]=this.nbVal-mapfish.Util.sum(s);for(var o=0;o<t;o++){v[o]=new mapfish.GeoStat.Bin(s[o],l[o],l[o+1],o==(t-1));var n=this.labelGenerator||this.defaultLabelGenerator;v[o].label=n(v[o],o,t)}return new mapfish.GeoStat.Classification(v)},classifyByEqIntervals:function(l){var k=[];for(var j=0;j<=l;j++){k[j]=this.minVal+j*(this.maxVal-this.minVal)/l}return this.classifyWithBounds(k)},classifyByQuantils:function(p){var k=this.values;k.sort(function(q,j){return q-j});var o=Math.round(this.values.length/p);var n=[];var m=(o===0)?0:o;if(k.length>0){n[0]=k[0];for(i=1;i<p;i++){n[i]=k[m];m+=o}n.push(k[k.length-1])}for(var l=0;l<n.length;l++){n[l]=parseFloat(n[l])}return this.classifyWithBounds(n)},sturgesRule:function(){return Math.floor(1+3.3*Math.log(this.nbVal,10))},classify:function(m,l,j){var k=null;if(!l){l=this.sturgesRule()}switch(parseFloat(m)){case mapfish.GeoStat.Distribution.CLASSIFY_WITH_BOUNDS:k=this.classifyWithBounds(j);break;case mapfish.GeoStat.Distribution.CLASSIFY_BY_EQUAL_INTERVALS:k=this.classifyByEqIntervals(l);break;case mapfish.GeoStat.Distribution.CLASSIFY_BY_QUANTILS:k=this.classifyByQuantils(l);break;default:OpenLayers.Console.error("Unsupported or invalid classification method")}return k},CLASS_NAME:"mapfish.GeoStat.Distribution"});mapfish.GeoStat.Distribution.CLASSIFY_WITH_BOUNDS=1;mapfish.GeoStat.Distribution.CLASSIFY_BY_EQUAL_INTERVALS=2;mapfish.GeoStat.Distribution.CLASSIFY_BY_QUANTILS=3;mapfish.GeoStat.Bin=OpenLayers.Class({label:null,nbVal:null,lowerBound:null,upperBound:null,isLast:false,initialize:function(l,m,k,j){this.nbVal=l;this.lowerBound=m;this.upperBound=k;this.isLast=j},CLASS_NAME:"mapfish.GeoStat.Bin"});mapfish.GeoStat.Classification=OpenLayers.Class({bins:[],initialize:function(j){this.bins=j},getBoundsArray:function(){var k=[];for(var j=0;j<this.bins.length;j++){k.push(this.bins[j].lowerBound)}if(this.bins.length>0){k.push(this.bins[this.bins.length-1].upperBound)}return k},CLASS_NAME:"mapfish.GeoStat.Classification"});mapfish.GeoStat.Facility=OpenLayers.Class(mapfish.GeoStat,{classification:null,gis:null,view:null,featureStore:Ext.create("Ext.data.Store",{fields:["id","name"],features:[],loadFeatures:function(k){if(k&&k.length){var l=[];for(var j=0;j<k.length;j++){l.push([k[j].attributes.id,k[j].attributes.name])}this.loadData(l);this.sortStore();this.features=k}else{this.removeAll()}},sortStore:function(){this.sort("name","ASC")}}),initialize:function(k,j){mapfish.GeoStat.prototype.initialize.apply(this,arguments)},getLoader:function(){return GIS.core.LayerLoaderFacility(this.gis,this.layer)},decode:function(n){var m,o,j,k={type:"FeatureCollection",crs:{type:"EPSG",properties:{code:"4326"}},features:[]};for(var l=0;l<n.length;l++){j=n[l];m={type:"Feature",geometry:{type:parseInt(j.ty)===1?"Point":"MultiPolygon",coordinates:JSON.parse(j.co)},properties:{id:j.id,name:j.na}};m.properties=Ext.Object.merge(m.properties,j.dimensions);k.features.push(m)}return k},reset:function(){this.layer.destroyFeatures();if(this.layer.legendPanel){this.layer.legendPanel.update("");this.layer.legendPanel.collapse()}if(this.layer.widget){this.layer.widget.reset()}},extendView:function(j,k){j=j||this.view;j.organisationUnitGroupSet=k.organisationUnitGroupSet||j.organisationUnitGroupSet;j.organisationUnitLevel=k.organisationUnitLevel||j.organisationUnitLevel;j.parentOrganisationUnit=k.parentOrganisationUnit||j.parentOrganisationUnit;j.parentLevel=k.parentLevel||j.parentLevel;j.parentGraph=k.parentGraph||j.parentGraph;j.opacity=k.opacity||j.opacity;return j},updateOptions:function(j){this.addOptions(j)},applyClassification:function(k){this.updateOptions(k);var j=this.gis.store.groupsByGroupSet.data.items;var n=new Array(j.length);for(var l=0;l<j.length;l++){var m=new OpenLayers.Rule({symbolizer:{pointRadius:8,externalGraphic:"../images/orgunitgroup/"+j[l].data.symbol},filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:this.indicator,value:j[l].data.name})});n[l]=m}this.extendStyle(n);mapfish.GeoStat.prototype.applyClassification.apply(this,arguments)},updateLegend:function(){var l=document.createElement("div"),m=document.createElement("div"),j=this.gis.store.groupsByGroupSet.data.items;for(var k=0;k<j.length;k++){m=document.createElement("div");m.style.backgroundImage="url(../images/orgunitgroup/"+j[k].data.symbol+")";m.style.backgroundRepeat="no-repeat";m.style.width="21px";m.style.height="16px";m.style.marginBottom="2px";m.style.cssFloat="left";l.appendChild(m);m=document.createElement("div");m.innerHTML=j[k].data.name;m.style.height="16px";m.style.lineHeight="17px";l.appendChild(m);m=document.createElement("div");m.style.clear="left";l.appendChild(m)}if(this.layer.legendPanel){this.layer.legendPanel.update(l.outerHTML)}return l},CLASS_NAME:"mapfish.GeoStat.Facility"});mapfish.GeoStat.Event=OpenLayers.Class(mapfish.GeoStat,{colors:[new mapfish.ColorRgb(120,120,0),new mapfish.ColorRgb(255,0,0)],method:mapfish.GeoStat.Distribution.CLASSIFY_BY_QUANTILS,numClasses:5,minSize:4,maxSize:4,minVal:null,maxVal:null,defaultSymbolizer:{fillOpacity:1},classification:null,colorInterpolation:null,gis:null,view:null,featureStore:Ext.create("Ext.data.Store",{fields:["id","name"],features:[],loadFeatures:function(k){if(k&&k.length){var l=[];for(var j=0;j<k.length;j++){l.push([k[j].attributes.id,k[j].attributes.name])}this.loadData(l);this.sortStore();this.features=k}else{this.removeAll()}},sortStore:function(){this.sort("name","ASC")}}),initialize:function(k,j){mapfish.GeoStat.prototype.initialize.apply(this,arguments)},getLoader:function(){return GIS.core.LayerLoaderEvent(this.gis,this.layer)},reset:function(){this.layer.destroyFeatures();if(this.layer.widget){this.layer.widget.reset()}},extendView:function(j,k){j=j||this.view;j.organisationUnitLevel=k.organisationUnitLevel||j.organisationUnitLevel;j.parentOrganisationUnit=k.parentOrganisationUnit||j.parentOrganisationUnit;j.parentLevel=k.parentLevel||j.parentLevel;j.parentGraph=k.parentGraph||j.parentGraph;j.opacity=k.opacity||j.opacity;return j},getLegendConfig:function(){return},getImageLegendConfig:function(){return},updateOptions:function(k){var j=OpenLayers.Util.extend({},this.options);this.addOptions(k);if(k){this.setClassification()}},createColorInterpolation:function(){var j=this.classification.bins.length;this.colorInterpolation=mapfish.ColorRgb.getColorsArrayByRgbInterpolation(this.colors[0],this.colors[1],j)},setClassification:function(){var k=[];for(var l=0;l<this.layer.features.length;l++){k.push(this.layer.features[l].attributes[this.indicator])}var j={labelGenerator:this.options.labelGenerator};var m=new mapfish.GeoStat.Distribution(k,j);this.minVal=m.minVal;this.maxVal=m.maxVal;this.classification=m.classify(this.method,this.numClasses,null);this.createColorInterpolation()},applyClassification:function(j){this.updateOptions(j);var o=OpenLayers.Function.bind(function(q){var r=q.attributes[this.indicator];var p=(r-this.minVal)/(this.maxVal-this.minVal)*(this.maxSize-this.minSize)+this.minSize;return p||this.minSize},this);this.extendStyle(null,{pointRadius:"${calculateRadius}"},{calculateRadius:o});var m=this.classification.getBoundsArray();var n=new Array(m.length-1);for(var k=0;k<m.length-1;k++){var l=new OpenLayers.Rule({symbolizer:{fillColor:this.colorInterpolation[k].toHexString()},filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN,property:this.indicator,lowerBoundary:m[k],upperBoundary:m[k+1]})});n[k]=l}this.extendStyle(n);mapfish.GeoStat.prototype.applyClassification.apply(this,arguments)},updateLegend:function(){return{}},CLASS_NAME:"mapfish.GeoStat.Event"});mapfish.GeoStat.Boundary=OpenLayers.Class(mapfish.GeoStat,{colors:[new mapfish.ColorRgb(120,120,0),new mapfish.ColorRgb(255,0,0)],method:mapfish.GeoStat.Distribution.CLASSIFY_BY_QUANTILS,numClasses:5,minSize:3,maxSize:20,minVal:null,maxVal:null,defaultSymbolizer:{fillOpacity:1},classification:null,colorInterpolation:null,gis:null,view:null,featureStore:Ext.create("Ext.data.Store",{fields:["id","name"],features:[],loadFeatures:function(k){if(k&&k.length){var l=[];for(var j=0;j<k.length;j++){l.push([k[j].attributes.id,k[j].attributes.name])}this.loadData(l);this.sortStore();this.features=k}else{this.removeAll()}},sortStore:function(){this.sort("name","ASC")}}),initialize:function(k,j){mapfish.GeoStat.prototype.initialize.apply(this,arguments)},getLoader:function(){return GIS.core.LayerLoaderBoundary(this.gis,this.layer)},reset:function(){this.layer.destroyFeatures();if(this.layer.widget){this.layer.widget.reset()}},extendView:function(j,k){j=j||this.view;j.organisationUnitLevel=k.organisationUnitLevel||j.organisationUnitLevel;j.parentOrganisationUnit=k.parentOrganisationUnit||j.parentOrganisationUnit;j.parentLevel=k.parentLevel||j.parentLevel;j.parentGraph=k.parentGraph||j.parentGraph;j.opacity=k.opacity||j.opacity;return j},getLegendConfig:function(){return},getImageLegendConfig:function(){return},getDefaultFeatureStyle:function(){return{fillOpacity:0,fillColor:"#000",strokeColor:"#000",strokeWidth:1,pointRadius:5,cursor:"pointer"}},setFeatureStyle:function(k){for(var j=0;j<this.layer.features.length;j++){this.layer.features[j].style=k}this.layer.redraw()},setFeatureLabelStyle:function(o,p,j){for(var m=0,l,n,k;m<this.layer.features.length;m++){l=this.layer.features[m];n=l.style;if(o){n.label=l.attributes.label;n.fontColor=n.strokeColor;n.fontWeight=n.strokeWidth>1?"bold":"normal";n.labelAlign="cr";n.labelYOffset=13;if(j.labelFontSize){n.fontSize=j.labelFontSize}if(j.labelFontStyle){n.fontStyle=j.labelFontStyle}}else{n.label=null}}if(!p){this.layer.redraw()}},updateOptions:function(k){var j=OpenLayers.Util.extend({},this.options);this.addOptions(k);if(k){this.setClassification()}},createColorInterpolation:function(){var j=this.classification.bins.length;this.colorInterpolation=mapfish.ColorRgb.getColorsArrayByRgbInterpolation(this.colors[0],this.colors[1],j)},setClassification:function(){var k=[];for(var l=0;l<this.layer.features.length;l++){k.push(this.layer.features[l].attributes[this.indicator])}var j={labelGenerator:this.options.labelGenerator};var m=new mapfish.GeoStat.Distribution(k,j);this.minVal=m.minVal;this.maxVal=m.maxVal;this.classification=m.classify(this.method,this.numClasses,null);this.createColorInterpolation()},applyClassification:function(j){this.updateOptions(j);var o=OpenLayers.Function.bind(function(q){var r=q.attributes[this.indicator];var p=(r-this.minVal)/(this.maxVal-this.minVal)*(this.maxSize-this.minSize)+this.minSize;return p||this.minSize},this);this.extendStyle(null,{pointRadius:"${calculateRadius}"},{calculateRadius:o});var m=this.classification.getBoundsArray();var n=new Array(m.length-1);for(var k=0;k<m.length-1;k++){var l=new OpenLayers.Rule({symbolizer:{fillColor:this.colorInterpolation[k].toHexString()},filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN,property:this.indicator,lowerBoundary:m[k],upperBoundary:m[k+1]})});n[k]=l}this.extendStyle(n);mapfish.GeoStat.prototype.applyClassification.apply(this,arguments)},updateLegend:function(){return{}},CLASS_NAME:"mapfish.GeoStat.Boundary"});mapfish.GeoStat.createThematic=function(j){mapfish.GeoStat[j]=OpenLayers.Class(mapfish.GeoStat,{colors:[new mapfish.ColorRgb(120,120,0),new mapfish.ColorRgb(255,0,0)],method:mapfish.GeoStat.Distribution.CLASSIFY_BY_QUANTILS,numClasses:5,bounds:null,minSize:3,maxSize:20,minVal:null,maxVal:null,defaultSymbolizer:{fillOpacity:1},classification:null,colorInterpolation:null,gis:null,view:null,featureStore:Ext.create("Ext.data.Store",{fields:["id","name"],features:[],loadFeatures:function(l){if(l&&l.length){var m=[];this.features=l;for(var k=0;k<l.length;k++){m.push([l[k].attributes.id,l[k].attributes.name])}this.loadData(m);this.sortStore()}else{this.removeAll()}},sortStore:function(){this.sort("name","ASC")}}),initialize:function(l,k){mapfish.GeoStat.prototype.initialize.apply(this,arguments)},getLoader:function(){return GIS.core.LayerLoaderThematic(this.gis,this.layer)},reset:function(){this.layer.destroyFeatures();this.featureStore.loadFeatures(this.layer.features.slice(0));if(this.layer.legendPanel){this.layer.legendPanel.update("");this.layer.legendPanel.collapse()}if(this.layer.widget){this.layer.widget.reset()}},extendView:function(k,l){k=k||this.view;k.valueType=l.valueType||k.valueType;k.indicatorGroup=l.indicatorGroup||k.indicatorGroup;k.indicator=l.indicator||k.indicator;k.dataElementGroup=l.dataElementGroup||k.dataElementGroup;k.dataElement=l.dataElement||k.dataElement;k.periodType=l.periodType||k.periodType;k.period=l.period||k.period;k.legendType=l.legendType||k.legendType;k.legendSet=l.legendSet||k.legendSet;k.classes=l.classes||k.classes;k.method=l.method||k.method;k.colorLow=l.colorLow||k.colorLow;k.colorHigh=l.colorHigh||k.colorHigh;k.radiusLow=l.radiusLow||k.radiusLow;k.radiusHigh=l.radiusHigh||k.radiusHigh;k.organisationUnitLevel=l.organisationUnitLevel||k.organisationUnitLevel;k.parentOrganisationUnit=l.parentOrganisationUnit||k.parentOrganisationUnit;k.parentLevel=l.parentLevel||k.parentLevel;k.parentGraph=l.parentGraph||k.parentGraph;k.opacity=l.opacity||k.opacity;return k},getImageLegendConfig:function(){var n=this.classification.bins,l=this.colorInterpolation,k=[];for(var m=0;m<n.length;m++){k.push({color:l[m].toHexString(),label:n[m].lowerBound.toFixed(1)+" - "+n[m].upperBound.toFixed(1)+" ("+n[m].nbVal+")"})}return k},updateOptions:function(l){var k=OpenLayers.Util.extend({},this.options);this.addOptions(l);if(l){this.setClassification()}},createColorInterpolation:function(){var k=this.classification.bins.length;if(!this.view.legendSet){this.colorInterpolation=mapfish.ColorRgb.getColorsArrayByRgbInterpolation(this.colors[0],this.colors[1],k)}},setClassification:function(){var l=[];for(var m=0;m<this.layer.features.length;m++){l.push(this.layer.features[m].attributes[this.indicator])}var k={labelGenerator:this.options.labelGenerator};var n=new mapfish.GeoStat.Distribution(l,k);this.minVal=n.minVal;this.maxVal=n.maxVal;if(this.view.legendType===this.gis.conf.finals.widget.legendtype_predefined){if(this.bounds[0]>this.minVal){this.bounds.unshift(this.minVal);this.colorInterpolation.unshift(new mapfish.ColorRgb(240,240,240))}if(this.bounds[this.bounds.length-1]<this.maxVal){this.bounds.push(this.maxVal);this.colorInterpolation.push(new mapfish.ColorRgb(240,240,240))}}this.classification=n.classify(this.method,this.numClasses,this.bounds);this.createColorInterpolation()},applyClassification:function(k,m){this.updateOptions(k,m);var q=OpenLayers.Function.bind(function(s){var t=s.attributes[this.indicator];var r=(t-this.minVal)/(this.maxVal-this.minVal)*(this.maxSize-this.minSize)+this.minSize;return r||this.minSize},this);this.extendStyle(null,{pointRadius:"${calculateRadius}"},{calculateRadius:q});var o=this.classification.getBoundsArray();var p=new Array(o.length-1);for(var l=0;l<o.length-1;l++){var n=new OpenLayers.Rule({symbolizer:{fillColor:this.colorInterpolation[l].toHexString()},filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN,property:this.indicator,lowerBoundary:o[l],upperBoundary:o[l+1]})});p[l]=n}this.extendStyle(p);mapfish.GeoStat.prototype.applyClassification.apply(this,arguments)},updateLegend:function(){var t=this.view,p=this.gis.response,n=this.gis.plugin,r=document.createElement("div"),s=t.legendSet?t.legendSet.names||{}:{},l={},o,m,k;l.dataLineHeight=n?"12px":"14px";l.dataPaddingBottom=n?"2px":"3px";l.colorWidth=n?"15px":"30px";l.colorHeight=n?"13px":"15px";l.colorMarginRight=n?"5px":"8px";l.fontSize=n?"10px":"11px";m=t.columns[0].items[0].id;k=t.columns[0].items[0].name;o=document.createElement("div");o.style.fontSize=l.fontSize;o.style.lineHeight=l.dataLineHeight;o.style.paddingBottom=l.dataPaddingBottom;o.innerHTML+='<div style="color:#222; font-size:10px !important">'+(p.metaData.names[m]||k||m)+"</div>";m=t.filters[0].items[0].id;k=t.filters[0].items[0].name;o.innerHTML+=p.metaData.names[m]||k||m;r.appendChild(o);o=document.createElement("div");o.style.clear="left";r.appendChild(o);if(t.legendSet){for(var q=0;q<this.classification.bins.length;q++){o=document.createElement("div");o.style.fontSize=l.fontSize;o.style.backgroundColor=this.colorInterpolation[q].toHexString();o.style.width=l.colorWidth;o.style.height=s[q]?"22px":l.colorHeight;o.style.cssFloat="left";o.style.marginRight=l.colorMarginRight;r.appendChild(o);o=document.createElement("div");o.style.height=s[q]?"22px":l.colorHeight;o.style.fontSize=l.fontSize;o.style.lineHeight=s[q]?"12px":"7px";o.innerHTML='<div style="color:#222; font-size:10px !important; height:11px; line-height:12px; font-weight:bold;">'+(s[q]||"")+"</div>";o.innerHTML+='<div style="color:#222; font-size:10px !important; height:11px; line-height:12px">'+this.classification.bins[q].label+"</div>";r.appendChild(o);o=document.createElement("div");o.style.clear="left";r.appendChild(o)}}else{for(var q=0;q<this.classification.bins.length;q++){o=document.createElement("div");o.style.backgroundColor=this.colorInterpolation[q].toHexString();o.style.width=l.colorWidth;o.style.height=l.colorHeight;o.style.cssFloat="left";o.style.marginRight=l.colorMarginRight;r.appendChild(o);o=document.createElement("div");o.style.height=l.colorHeight;o.style.fontSize=l.fontSize;o.innerHTML=this.classification.bins[q].label;r.appendChild(o);o=document.createElement("div");o.style.clear="left";r.appendChild(o)}}if(this.layer.legendPanel){this.layer.legendPanel.update(r.outerHTML)}return r},CLASS_NAME:"mapfish.GeoStat."+j})};mapfish.GeoStat.createThematic("Thematic1");mapfish.GeoStat.createThematic("Thematic2");mapfish.GeoStat.createThematic("Thematic3");mapfish.GeoStat.createThematic("Thematic4")}());var g={user:{},systemInfo:{}},f=[],h=false,b=false,d=false,a,c,e;GIS.i18n={event_layer:"Event layer",boundary_layer:"Boundary layer",facility_layer:"Facility layer",thematic_layer:"Thematic layer",measure_distance:"Measure distance",coordinates_could_not_be_loaded:"Coordinates could not be loaded",invalid_coordinates:"Invalid coordinates",no_valid_coordinates_found:"No valid coordinates found"};GIS.plugin={};a=function(j){var q=false,p=[],n=0,m="json",o,l;g.contextPath=j.url;l=function(){if(++n===p.length){b=true;for(var r=0;r<f.length;r++){e(f[r])}}};o=function(r,s){s=s||j;if(s.crossDomain&&Ext.isString(s.username)&&Ext.isString(s.password)){r.headers=Ext.isObject(s.headers)?s.headers:{};r.headers.Authorization="Basic "+btoa(s.username+":"+s.password)}Ext.Ajax.request(r)};p.push({url:g.contextPath+"/api/systemSettings."+m+"?key=keyCalendar&key=keyDateFormat",disableCaching:false,success:function(u){var t=u.responseText?Ext.decode(u.responseText):u,s;g.systemInfo.dateFormat=Ext.isString(t.keyDateFormat)?t.keyDateFormat.toLowerCase():"yyyy-mm-dd";g.systemInfo.calendar=t.keyCalendar;s={url:g.contextPath+"/api/me/user-account."+m,disableCaching:false,success:function(w){g.userAccount=w.responseText?Ext.decode(w.responseText):w;var v=function(){var C="en",A="name",z,B,y,r,x;g.userAccount.settings.keyUiLocale=g.userAccount.settings.keyUiLocale||C;g.userAccount.settings.keyAnalysisDisplayProperty=g.userAccount.settings.keyAnalysisDisplayProperty||A;B=g.contextPath;y=g.userAccount.settings.keyUiLocale;keyAnalysisDisplayProperty=g.userAccount.settings.keyAnalysisDisplayProperty;z=keyAnalysisDisplayProperty===A?keyAnalysisDisplayProperty:keyAnalysisDisplayProperty+"|rename("+A+")";r=g.systemInfo.dateFormat;g.namePropertyUrl=z;dhis2.util.namespace("dhis2.gis");dhis2.gis.store=dhis2.gis.store||new dhis2.storage.Store({name:"dhis2",adapters:[dhis2.storage.IndexedDBAdapter,dhis2.storage.DomSessionStorageAdapter,dhis2.storage.InMemoryAdapter],objectStores:["optionSets"]});x={url:B+"/api/optionSets."+m+"?fields=id,version&paging=false",disableCaching:false,success:function(D){var G=(D.responseText?Ext.decode(D.responseText).optionSets:D.optionSets)||[],J=dhis2.gis.store,E=[],F="",H=0,K,I,L;if(!G.length){l();return}L={url:B+"/api/optionSets."+m+"?fields=id,name,version,options[code,name]&paging=false"+F,disableCaching:false,success:function(N){var M=N.responseText?Ext.decode(N.responseText).optionSets:N.optionSets;J.setAll("optionSets",M).done(l)}};I=function(){if(++H===G.length){if(!E.length){l();return}for(var M=0;M<E.length;M++){F+="&filter=id:eq:"+E[M]}o(L)}};K=function(M){J.get("optionSets",M.id).done(function(N){if(!Ext.isObject(N)||N.version!==M.version){E.push(M.id)}I()})};J.open().done(function(){for(var M=0;M<G.length;M++){K(G[M])}})}};o(x)};if(window.dhis2&&window.jQuery){v()}else{Ext.Loader.injectScriptElement(g.contextPath+"/dhis-web-commons/javascripts/jQuery/jquery.min.js",function(){Ext.Loader.injectScriptElement(g.contextPath+"/dhis-web-commons/javascripts/dhis2/dhis2.util.js",function(){Ext.Loader.injectScriptElement(g.contextPath+"/dhis-web-commons/javascripts/dhis2/dhis2.storage.js",function(){Ext.Loader.injectScriptElement(g.contextPath+"/dhis-web-commons/javascripts/dhis2/dhis2.storage.idb.js",function(){Ext.Loader.injectScriptElement(g.contextPath+"/dhis-web-commons/javascripts/dhis2/dhis2.storage.ss.js",function(){Ext.Loader.injectScriptElement(g.contextPath+"/dhis-web-commons/javascripts/dhis2/dhis2.storage.memory.js",function(){v()})})})})})})}}};o(s)}});p.push({url:g.contextPath+"/api/organisationUnits."+m+"?userOnly=true&fields=id,name,children[id,name]&paging=false",disableCaching:false,success:function(v){var u=(v.responseText?Ext.decode(v.responseText).organisationUnits:v)||[],t=[],w=[];if(u.length){for(var s=0,x;s<u.length;s++){x=u[s];t.push(x.id);if(x.children){w=Ext.Array.clean(w.concat(Ext.Array.pluck(x.children,"id")||[]))}}g.user=g.user||{};g.user.ou=t;g.user.ouc=w}else{gis.alert("User is not assigned to any organisation units")}l()}});p.push({url:g.contextPath+"/api/dimensions."+m+"?fields=id,name&paging=false",disableCaching:false,success:function(s){g.dimensions=s.responseText?Ext.decode(s.responseText).dimensions:s.dimensions;l()}});for(var k=0;k<p.length;k++){o(p[k])}};c=function(){var j="";j+=".x-border-box .gis-plugin * {box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;-webkit-box-sizing:border-box} \n";j+=".gis-plugin, .gis-plugin * { font-family: arial, sans-serif, liberation sans, consolas; } \n";j+="table{border-collapse:collapse;border-spacing:0} \n";j+="fieldset,img{border:0} \n";j+="*:focus{outline:none}";j+=".x-clear{overflow:hidden;clear:both;height:0;width:0;font-size:0;line-height:0} \n";j+=".x-layer{position:absolute;overflow:hidden;zoom:1} \n";j+=".x-css-shadow{position:absolute;-moz-border-radius:5px 5px;-webkit-border-radius:5px 5px;-o-border-radius:5px 5px;-ms-border-radius:5px 5px;-khtml-border-radius:5px 5px;border-radius:5px 5px} \n";j+=".x-frame-shadow *{overflow:hidden} \n";j+=".x-frame-shadow *{padding:0;border:0;margin:0;clear:none;zoom:1} \n";j+=".x-mask{z-index:100;position:absolute;top:0;left:0;filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=50);opacity:0.5;width:100%;height:100%;zoom:1;background:#cccccc} \n";j+=".x-mask-msg{z-index:20001;position:absolute;top:0;left:0;padding:2px;border:1px solid;border-color:#d0d0d0;background-image:none;background-color:#e0e0e0} \n";j+='.x-mask-msg div{padding:5px 10px 5px 25px;background-image:url("'+g.contextPath+'/dhis-web-commons/javascripts/plugin/images/loading.gif");background-repeat:no-repeat;background-position:5px center;cursor:wait;border:1px solid #b3b3b3;background-color:#eeeeee;color:#222222;font:normal 11px tahoma, arial, verdana, sans-serif} \n';j+=".x-btn *{cursor:pointer;cursor:hand} \n";j+=".x-btn em a{text-decoration:none;display:inline-block;color:inherit} \n";j+=".x-btn-disabled span{filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=50);opacity:0.5} \n";j+=".x-ie6 .x-btn-disabled span,.x-ie7 .x-btn-disabled span{filter:none} \n";j+=".x-btn button,.x-btn a{position:relative} \n";j+=".x-item-disabled,.x-item-disabled *{cursor:default} \n";j+=".x-datepicker a{-moz-outline:0 none;outline:0 none;color:#523a39;text-decoration:none;border-width:0} \n";j+=".x-datepicker-prev a,.x-datepicker-next a{display:block;width:16px;height:16px;background-position:top;background-repeat:no-repeat;cursor:pointer;text-decoration:none !important;filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=70);opacity:0.7} \n";j+=".x-datepicker-prev a:hover,.x-datepicker-next a:hover{filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=100);opacity:1} \n";j+='.x-datepicker-next a{background-image:url("images/right-btn.gif")} \n';j+='.x-datepicker-prev a{background-image:url("images/left-btn.gif")} \n';j+=".x-item-disabled .x-datepicker-prev a:hover,.x-item-disabled .x-datepicker-next a:hover{filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=60);opacity:0.6} \n";j+=".x-datepicker-month span{color:#fff !important} \n";j+="table.x-datepicker-inner th span{display:block;padding-right:7px} \n";j+="table.x-datepicker-inner a{padding-right:4px;display:block;zoom:1;font:normal 11px tahoma, arial, verdana, sans-serif;color:black;text-decoration:none;text-align:right} \n";j+="table.x-datepicker-inner .x-datepicker-selected a{background:repeat-x left top;background-color:#d8d8d8;border:1px solid #b2aaa9} \n";j+="table.x-datepicker-inner .x-datepicker-selected span{font-weight:bold} \n";j+="table.x-datepicker-inner .x-datepicker-today a{border:1px solid;border-color:darkred} \n";j+="table.x-datepicker-inner .x-datepicker-prevday a,table.x-datepicker-inner .x-datepicker-nextday a{text-decoration:none !important;color:#aaa} \n";j+="table.x-datepicker-inner a:hover,table.x-datepicker-inner .x-datepicker-disabled a:hover{text-decoration:none !important;color:#000;background-color:transparent} \n";j+="table.x-datepicker-inner .x-datepicker-disabled a{cursor:default;background-color:#eee;color:#bbb} \n";j+=".x-item-disabled .x-datepicker-inner a:hover{background:none} \n";j+=".x-monthpicker-item a{display:block;margin:0 5px 0 5px;text-decoration:none;color:#523a39;border:1px solid white;line-height:17px} \n";j+=".x-monthpicker-item a:hover{background-color:transparent} \n";j+=".x-color-picker a{border:1px solid #fff;float:left;padding:2px;text-decoration:none;-moz-outline:0 none;outline:0 none;cursor:pointer} \n";j+=".x-color-picker a:hover,.x-color-picker a.x-color-picker-selected{border-color:#8bb8f3;background-color:#deecfd} \n";j+=".x-color-picker em span{cursor:pointer;display:block;height:10px;width:10px;line-height:10px} \n";j+=".x-menu-body{user-select:none;-o-user-select:none;-ms-user-select:none;-moz-user-select:-moz-none;-webkit-user-select:none;cursor:default;background:#f0f0f0 !important;padding:2px} \n";j+=".x-menu-focus{display:block;position:absolute;top:-10px;left:-10px;width:0px;height:0px} \n";j+=".x-menu-item{white-space:nowrap;overflow:hidden;z-index:1} \n";j+=".x-menu-item-link{display:block;margin:1px;padding:6px 2px 3px 32px;text-decoration:none !important;line-height:16px;cursor:default} \n";j+=".x-opera .x-menu-item-link{position:relative} \n";j+=".x-menu-item-icon{width:16px;height:16px;position:absolute;top:5px;left:4px;background:no-repeat center center} \n";j+=".x-menu-item-text{font-size:11px;color:#222222} \n";j+=".x-menu-item-active .x-menu-item-link{background-image:none;background-color:#e6e6e6;background-image:-webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #eeeeee), color-stop(100%, #dcdcdc));background-image:-webkit-linear-gradient(top, #eeeeee,#dcdcdc);background-image:-moz-linear-gradient(top, #eeeeee,#dcdcdc);background-image:-o-linear-gradient(top, #eeeeee,#dcdcdc);background-image:-ms-linear-gradient(top, #eeeeee,#dcdcdc);background-image:linear-gradient(top, #eeeeee,#dcdcdc);margin:0px;border:1px solid #9d9d9d;cursor:pointer;-moz-border-radius:3px;-webkit-border-radius:3px;-o-border-radius:3px;-ms-border-radius:3px;-khtml-border-radius:3px;border-radius:3px} \n";j+=".x-menu-item-disabled{filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=50);opacity:0.5} \n";j+=".x-ie6 .x-menu-item-link,.x-ie7 .x-menu-item-link,.x-quirks .x-ie8 .x-menu-item-link{padding-bottom:2px} \n";j+='.x-nlg .x-menu-item-active .x-menu-item-link{background:#e6e6e6 repeat-x left top;background-image:url("images/menu-item-active-bg.gif")} \n';j+=".x-unselectable{user-select:none;-o-user-select:none;-ms-user-select:none;-moz-user-select:-moz-none;-webkit-user-select:none;cursor:default} \n";j+=".x-grid-row-editor .x-panel-body{background-color:#ebe6e6;border-top:1px solid #d0d0d0 !important;border-bottom:1px solid #d0d0d0 !important} \n";j+=".x-webkit *:focus{outline:none !important} \n";j+=".x-ie .x-fieldset-noborder legend span{position:absolute;left:16px} \n";j+=".x-panel,.x-plain{overflow:hidden;position:relative} \n";j+=".x-panel-header{padding:5px 4px 4px 5px} \n";j+=".x-panel-header-horizontal .x-panel-header-body,.x-panel-header-horizontal .x-window-header-body,.x-panel-header-horizontal .x-btn-group-header-body,.x-window-header-horizontal .x-panel-header-body,.x-window-header-horizontal .x-window-header-body,.x-window-header-horizontal .x-btn-group-header-body,.x-btn-group-header-horizontal .x-panel-header-body,.x-btn-group-header-horizontal .x-window-header-body,.x-btn-group-header-horizontal .x-btn-group-header-body{width:100%} \n";j+=".x-panel-header-text-container{overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis} \n";j+=".x-panel-header-text{user-select:none;-o-user-select:none;-ms-user-select:none;-moz-user-select:-moz-none;-webkit-user-select:none;cursor:default;white-space:nowrap} \n";j+=".x-panel-body{overflow:hidden;position:relative;font-size:12px} \n";j+=".x-panel-collapsed .x-panel-header-collapsed-border-top{border-bottom-width:1px !important} \n";j+=".x-panel-default{border-color:#d0d0d0} \n";j+=".x-panel-header-default{font-size:11px;line-height:15px;border-color:#d0d0d0;border-width:1px;border-style:solid;background-image:none;background-color:#d7d2d2;background-image:-webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #f0f0f0), color-stop(100%, #d7d7d7));background-image:-webkit-linear-gradient(top, #f0f0f0,#d7d7d7);background-image:-moz-linear-gradient(top, #f0f0f0,#d7d7d7);background-image:-o-linear-gradient(top, #f0f0f0,#d7d7d7);background-image:-ms-linear-gradient(top, #f0f0f0,#d7d7d7);background-image:linear-gradient(top, #f0f0f0,#d7d7d7);-moz-box-shadow:#efeded 0 1px 0px 0 inset;-webkit-box-shadow:#efeded 0 1px 0px 0 inset;-o-box-shadow:#efeded 0 1px 0px 0 inset;box-shadow:#efeded 0 1px 0px 0 inset} \n";j+=".x-panel-header-text-default{color:#333333;font-size:11px;font-weight:bold;font-family:tahoma, arial, verdana, sans-serif} \n";j+=".x-panel-collapsed .x-window-header-default,.x-panel-collapsed .x-panel-header-default{border-color:#d0d0d0} \n";j+=".x-panel-collapsed .x-panel-header-default-top{-moz-border-radius-bottomleft:null;-webkit-border-bottom-left-radius:null;-o-border-bottom-left-radius:null;-ms-border-bottom-left-radius:null;-khtml-border-bottom-left-radius:null;border-bottom-left-radius:null;-moz-border-radius-bottomright:null;-webkit-border-bottom-right-radius:null;-o-border-bottom-right-radius:null;-ms-border-bottom-right-radius:null;-khtml-border-bottom-right-radius:null;border-bottom-right-radius:null} \n";j+=".x-panel-header-default-top{-moz-box-shadow:#efeded 0 1px 0px 0 inset;-webkit-box-shadow:#efeded 0 1px 0px 0 inset;-o-box-shadow:#efeded 0 1px 0px 0 inset;box-shadow:#efeded 0 1px 0px 0 inset} \n";j+=".x-tip-header a,.x-tip-body a,.x-form-invalid-tip-body a{color:#2a2a2a} \n";j+=".x-toolbar-footer .x-box-inner{border-width:0} \n";j+=".x-window-default{-moz-border-radius-topleft:5px; -webkit-border-top-left-radius:5px; -o-border-top-left-radius:5px; -ms-border-top-left-radius:5px; -khtml-border-top-left-radius:5px; border-top-left-radius:5px; -moz-border-radius-topright:5px; -webkit-border-top-right-radius:5px; -o-border-top-right-radius:5px; -ms-border-top-right-radius:5px; -khtml-border-top-right-radius:5px; border-top-right-radius:5px; -moz-border-radius-bottomright:5px; -webkit-border-bottom-right-radius:5px; -o-border-bottom-right-radius:5px; -ms-border-bottom-right-radius:5px; -khtml-border-bottom-right-radius:5px; border-bottom-right-radius:5px; -moz-border-radius-bottomleft:5px; -webkit-border-bottom-left-radius:5px; -o-border-bottom-left-radius:5px; -ms-border-bottom-left-radius:5px; -khtml-border-bottom-left-radius:5px; border-bottom-left-radius:5px; -moz-box-shadow:#ebe7e7 0 1px 0px 0 inset, #ebe7e7 0 -1px 0px 0 inset, #ebe7e7 -1px 0 0px 0 inset, #ebe7e7 1px 0 0px 0 inset; -webkit-box-shadow:#ebe7e7 0 1px 0px 0 inset, #ebe7e7 0 -1px 0px 0 inset, #ebe7e7 -1px 0 0px 0 inset, #ebe7e7 1px 0 0px 0 inset; -o-box-shadow:#ebe7e7 0 1px 0px 0 inset, #ebe7e7 0 -1px 0px 0 inset, #ebe7e7 -1px 0 0px 0 inset, #ebe7e7 1px 0 0px 0 inset; box-shadow:#ebe7e7 0 1px 0px 0 inset, #ebe7e7 0 -1px 0px 0 inset, #ebe7e7 -1px 0 0px 0 inset, #ebe7e7 1px 0 0px 0 inset; padding:4px 4px 4px 4px; border-color:#a9a9a9; border-width:1px; border-style:solid; background-color:#e8e8e8; } \n";j+=".x-window{outline:none} \n";j+=".x-window-header-default { border-color: #a9a9a9; zoom: 1; } \n";j+=".x-window-header-default-top { box-shadow: #ebe7e7 0 1px 0px 0 inset, #ebe7e7 -1px 0 0px 0 inset, #ebe7e7 1px 0 0px 0 inset; border-bottom-left-radius: 0; padding: 5px 5px 0 5px; border-width: 1px; border-style: solid; background-color: #e8e8e8; } \n";j+=".x-window .x-window-wrap .x-window-body{overflow:hidden} \n";j+=".x-window-body-default{border-color:#bcb1b0;border-width:1px;background:#e0e0e0;color:black} \n";j+=".x-window-body{position:relative;border-style:solid} \n";j+=".x-message-box .x-window-body{background-color:#e8e8e8;border:none} \n";j+=".x-tab-bar-bottom .x-tab-bar-body .x-box-inner{position:relative;top:-1px} \n";j+=".x-tab-bar-bottom .x-tab-bar-body-default-plain .x-box-inner{position:relative;top:-1px} \n";j+=".x-tab *{cursor:pointer;cursor:hand} \n";j+=".x-tab-default-disabled *{cursor:default} \n";j+=".x-tab button,.x-tab a{position:relative} \n";j+=".x-grid-tree-loading span{font-style:italic;color:#444444} \n";j+=".x-proxy-el{position:absolute;background:#b4b4b4;filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=80);opacity:0.8} \n";j+=".x-docked{position:absolute;z-index:1} \n";j+=".x-docked-top{border-bottom-width:0 !important} \n";j+=".x-box-inner{overflow:hidden;zoom:1;position:relative;left:0;top:0} \n";j+=".x-box-item{position:absolute !important;left:0;top:0} \n";j+=".x-box-layout-ct,.x-border-layout-ct{overflow:hidden;zoom:1} \n";j+=".x-inline-children > *{display:inline-block !important} \n";j+=".x-tool{height:15px} \n";j+='.x-tool img{overflow:hidden;width:15px;height:15px;cursor:pointer;background-color:transparent;background-repeat:no-repeat;background-image:url("images/tool-sprites.gif");margin:0} \n';j+=".x-panel-header-horizontal .x-tool,.x-window-header-horizontal .x-tool{margin-left:2px} \n";j+=".x-tool-expand-bottom,.x-tool-collapse-bottom{background-position:0 -195px} \n";j+=".x-tool-expand-top,.x-tool-collapse-top{background-position:0 -210px} \n";j+=".x-html html,.x-html address,.x-html blockquote,.x-html body,.x-html dd,.x-html div,.x-html dl,.x-html dt,.x-html fieldset,.x-html form,.x-html frame,.x-html frameset,.x-html h1,.x-html h2,.x-html h3,.x-html h4,.x-html h5,.x-html h6,.x-html noframes,.x-html ol,.x-html p,.x-html ul,.x-html center,.x-html dir,.x-html hr,.x-html menu,.x-html pre{display:block} \n";j+=".x-html :before,.x-html :after{white-space:pre-line} \n";j+=".x-html :link,.x-html :visited{text-decoration:underline} \n";j+=".x-panel-header-draggable,.x-panel-header-draggable .x-panel-header-text,.x-window-header-draggable,.x-window-header-draggable .x-window-header-text,.x-tip-header-draggable .x-tip-header-text { cursor:move; } \n";j+=".x-panel-header-vertical,.x-panel-header-vertical .x-panel-header-body,.x-btn-group-header-vertical,.x-btn-group-header-vertical .x-btn-group-header-body,.x-window-header-vertical,.x-window-header-vertical .x-window-header-body,.x-html button,.x-html textarea,.x-html input,.x-html select { display:inline-block; } \n";j+=".x-window-header-text { user-select:none; -o-user-select:none; -ms-user-select:none; -moz-user-select:0; -webkit-user-select:none; cursor:default; white-space:nowrap; display:block; } \n";j+=".x-box-inner { zoom: 1; } \n";j+=".x-panel-default { border-color: #d0d0d0; } \n";j+=".x-panel { overflow: hidden; } \n";j+=".x-panel-body { overflow: hidden; position: relative; } \n";j+=".x-panel-body, .x-window-body * { font-size: 11px; } \n";j+=".x-panel-header-default { line-height: 15px; border-color: #d0d0d0; border-width: 1px; border-style: solid; } \n";j+=".x-panel-header { height: 30px; padding: 7px 4px 4px 7px; border: 0 none; } \n";j+=".x-panel-header-text-default { color: #333333; font-weight: bold; } \n";j+=".x-panel-header-text { -webkit-user-select: none; cursor: default; white-space: nowrap; } \n";j+=".x-box-item { position: absolute !important; } \n";j+=".x-unselectable { -webkit-user-select: none; cursor: default; } \n";j+=".x-docked { position: absolute; z-index: 1; } \n";j+=".x-docked-top { border-bottom-width: 0 !important; } \n";j+=".gis-container-default .x-window-body { padding: 5px; background: #fff; } \n";j+=".olControlPanel { position: absolute; top: 0; right: 0; border: 0 none; } \n";j+='.olControlButtonItemActive { background: #556; color: #fff; width: 24px; height: 24px; opacity: 0.75; filter: alpha(opacity=75); -ms-filter: "alpha(opacity=75)"; cursor: pointer; cursor: hand; text-align: center; font-size: 21px !important; text-shadow: 0 0 1px #ddd; } \n';j+=".olControlPanel.zoomIn { right: 76px; top: 4px; } \n";j+=".olControlPanel.zoomIn .olControlButtonItemActive { border-top-left-radius: 3px; border-bottom-left-radius: 3px; } \n";j+=".olControlPanel.zoomOut { right: 52px; top: 4px; } \n";j+=".olControlPanel.zoomVisible { right: 28px; top: 4px; } \n";j+=".olControlPanel.legend { right: 4px; top: 4px; } \n";j+=".olControlPanel.legend .olControlButtonItemActive { border-top-right-radius: 3px; border-bottom-right-radius: 3px; } \n";j+=".olControlPanel.zoomIn-vertical { right: 4px; top: 4px; } \n";j+=".olControlPanel.zoomIn-vertical .olControlButtonItemActive { border-top-left-radius: 3px; border-top-right-radius: 3px; } \n";j+=".olControlPanel.zoomOut-vertical { right: 4px; top: 28px; } \n";j+=".olControlPanel.zoomVisible-vertical { right: 4px; top: 52px; } \n";j+=".olControlPanel.legend-vertical { right: 4px; top: 76px; } \n";j+=".olControlPanel.legend-vertical .olControlButtonItemActive { border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; } \n";j+=".olControlPermalink { display: none !important; } \n";j+='.olControlMousePosition { background: #fff !important; line-height: 14px; opacity: 0.8 !important; filter: alpha(opacity=80) !important; -ms-filter: "alpha(opacity=80)" !important; right: 0 !important; bottom: 0 !important; border-top-left-radius: 2px !important; padding: 2px 2px 1px 5px !important; color: #000 !important; -webkit-text-stroke-width: 0.1px; -webkit-text-stroke-color: #555; } \n';j+=".olControlMousePosition * { font-size: 10px !important; } \n";j+=".text-mouseposition-lonlat { color: #555; } \n";j+=".olLayerGoogleCopyright, .olLayerGoogleV3.olLayerGooglePoweredBy { display: none; } \n";j+='.google-logo { background: url("'+g.contextPath+'/dhis-web-commons/javascripts/plugin/images/google-logo.png") no-repeat; width: 40px; height: 13px; margin-left: 6px; display: inline-block; vertical-align: bottom; cursor: pointer; cursor: hand; } \n';j+='.google-logo-small { background: url("'+g.contextPath+'/dhis-web-commons/javascripts/plugin/images/google-logo-small.png") no-repeat; width: 13px; height: 13px; margin-left: 4px; display: inline-block; vertical-align: bottom; cursor: pointer; cursor: hand; } \n';j+=".olControlScaleLine { left: 5px !important; bottom: 5px !important; } \n";j+=".olControlScaleLineBottom { display: none; } \n";j+=".olControlScaleLineTop { font-weight: bold; } \n";j+=".x-mask-msg { padding: 0; border: 0 none; background-image: none; background-color: transparent; } \n";j+=".x-mask-msg div { background-position: 11px center; } \n";j+=".x-mask-msg .x-mask-loading { border: 0 none; background-color: #000; color: #fff; border-radius: 2px; padding: 12px 14px 12px 30px; opacity: 0.65; } \n";j+=".gis-window-widget-feature { padding: 0; border: 0 none; border-radius: 0; background: transparent; box-shadow: none; } \n";j+=".gis-window-widget-feature .x-window-body-default { border: 0 none; background: transparent; } \n";j+='.gis-window-widget-feature .x-window-body-default .x-panel-body-default { border: 0 none; background: #556; opacity: 0.92; filter: alpha(opacity=92); -ms-filter: "alpha(opacity=92)"; padding: 5px 8px 4px 8px; border-bottom-left-radius: 2px; border-bottom-right-radius: 2px; color: #fff; font-weight: bold; letter-spacing: 1px; } \n';j+=".x-menu-body { border:1px solid #bbb; border-radius: 2px; padding: 0; background-color: #fff !important; } \n";j+=".x-menu-item-active .x-menu-item-link {	border-radius: 0; border-color: #e1e1e1; background-color: #e1e1e1; background-image: none; } \n";j+=".x-menu-item-link { padding: 4px 5px 4px 26px; } \n";j+=".x-menu-item-text { color: #111; } \n";j+=".disabled { opacity: 0.4; cursor: default !important; } \n";j+=".el-opacity-1 { opacity: 1 !important; } \n";j+=".el-border-0, .el-border-0 .x-panel-body { border: 0 none !important; } \n";j+=".el-fontsize-10 { font-size: 10px !important; } \n";j+=".gis-grid-row-icon-disabled * { cursor: default !important; } \n";j+=".gis-toolbar-btn-menu { margin-top: 4px; } \n";j+=".gis-toolbar-btn-menu .x-panel-body-default { border-radius: 2px; border-color: #999; } \n";j+=".gis-grid .link, .gis-grid .link * { cursor: pointer; cursor: hand; color: blue; text-decoration: underline; } \n";j+=".gis-menu-item-icon-drill, .gis-menu-item-icon-float { left: 6px; } \n";j+=".gis-menu-item-first.x-menu-item-active .x-menu-item-link {	border-radius: 0; border-top-left-radius: 2px; border-top-right-radius: 2px; } \n";j+=".gis-menu-item-last.x-menu-item-active .x-menu-item-link { border-radius: 0; border-bottom-left-radius: 2px; border-bottom-right-radius: 2px; } \n";j+='.gis-menu-item-icon-drill { background: url("'+g.contextPath+'/dhis-web-commons/javascripts/plugin/images/drill_16.png") no-repeat; } \n';j+='.gis-menu-item-icon-float { background: url("'+g.contextPath+'/dhis-web-commons/javascripts/plugin/images/float_16.png") no-repeat; } \n';j+=".x-color-picker a { padding: 0; } \n";j+=".x-color-picker em span { width: 14px; height: 14px; } \n";j+=".gis-panel-legend .x-panel-header { height: 23px; background: #f1f1f1; padding: 4px 4px 0 5px} \n";j+=".gis-panel-legend .x-panel-header .x-panel-header-text { font-size: 10px; } \n";j+=".ns-plugin-alert { width: 90%; padding: 5%; color: #777 } \n";Ext.util.CSS.createStyleSheet(j)};e=function(n){var p,m,k,o,j,l;p=function(){if(!Ext.isString(n.url)){alert("Invalid url ("+n.el+")");return}if(n.url.split("").pop()==="/"){n.url=n.url.substr(0,n.url.length-1)}if(!Ext.isString(n.el)){alert("Invalid html element id ("+n.el+")");return}n.id=n.id||n.uid;if(n.id&&!Ext.isString(n.id)){alert("Invalid map id ("+n.el+")");return}return true};m=function(x,z){var y=x.init,s=x.api,t=x.conf,w=x.store,r=x.util,v="json",u={json:"application/json"},q={"Content-Type":u[v],Accepts:u[v]};y.el=n.el;x.plugin=z.plugin;x.dashboard=z.dashboard;x.crossDomain=z.crossDomain;x.skipMask=z.skipMask;x.skipFade=z.skipFade;x.el=z.el;x.username=z.username;x.password=z.password;x.ajax=r.connection.ajax;w.groupsByGroupSet=Ext.create("Ext.data.Store",{fields:["id","name","symbol"]})};k=function(y){var t,v=[],x,q,u,s=Ext.get(l.el),r=l.map.hideLegend?0:(y.plugin?120:200),w=[];if(y.dashboard){v.push(x=Ext.create("Ext.panel.Panel",{region:"north",width:s.getWidth(),height:19,bodyStyle:"background-color: #fff; border: 0 none; font: bold 12px LiberationSans, arial, sans-serif; color: #333; text-align: center; line-height: 14px; letter-spacing: -0.1px",html:""}))}v.push(q=new GeoExt.MapPanel({region:"center",map:l.olmap,bodyStyle:"border: 1px solid #d0d0d0",width:s.getWidth()-r}));if(y.dashboard){v.push(u=Ext.create("Ext.panel.Panel",{width:0,height:0}))}else{v.push(u=Ext.create("Ext.panel.Panel",{region:"east",layout:"anchor",bodyStyle:"border-top:0 none; border-bottom:0 none",width:r,preventHeader:true,defaults:{bodyStyle:"padding: 6px; border: 0 none",collapsible:true,collapsed:true,animCollapse:false},items:[{title:GIS.i18n.thematic_layer_1_legend,cls:"gis-panel-legend",bodyStyle:"padding:3px 0 4px 5px; border-width:1px 0 1px 0; border-color:#d0d0d0;",listeners:{added:function(){l.layer.thematic1.legendPanel=this}}},{title:GIS.i18n.thematic_layer_2_legend,cls:"gis-panel-legend",bodyStyle:"padding:3px 0 4px 5px; border-width:1px 0 1px 0; border-color:#d0d0d0;",listeners:{added:function(){l.layer.thematic2.legendPanel=this}}},{title:GIS.i18n.thematic_layer_3_legend,cls:"gis-panel-legend",bodyStyle:"padding:3px 0 4px 5px; border-width:1px 0 1px 0; border-color:#d0d0d0;",listeners:{added:function(){l.layer.thematic3.legendPanel=this}}},{title:GIS.i18n.thematic_layer_4_legend,cls:"gis-panel-legend",bodyStyle:"padding:3px 0 4px 5px; border-width:1px 0 1px 0; border-color:#d0d0d0;",listeners:{added:function(){l.layer.thematic4.legendPanel=this}}},{title:GIS.i18n.facility_layer_legend,cls:"gis-panel-legend",bodyStyle:"padding:3px 0 4px 5px; border-width:1px 0 1px 0; border-color:#d0d0d0;",listeners:{added:function(){l.layer.facility.legendPanel=this}}}]}))}t=Ext.create("Ext.panel.Panel",{renderTo:s,width:s.getWidth(),height:s.getHeight(),cls:"gis-plugin",layout:"border",bodyStyle:"border: 0 none",items:v,listeners:{afterrender:function(){o()}}});t.northRegion=x;t.centerRegion=q;t.eastRegion=u;t.centerRegion.trash=w;t.centerRegion.getEl().on("mouseleave",function(){for(var z=0,A;z<w.length;z++){A=t.centerRegion.trash[z];if(A&&A.destroy){A.destroy()}}});return t};o=function(r){var x=["zoomInButton","zoomIn-verticalButton","zoomOutButton","zoomOut-verticalButton","zoomVisibleButton","zoomVisible-verticalButton","measureButton","measure-verticalButton","legendButton","legend-verticalButton"],q={"zoomIn-verticalButton":"zoomin_24.png","zoomOut-verticalButton":"zoomout_24.png","zoomVisible-verticalButton":"zoomvisible_24.png","measure-verticalButton":"measure_24.png","legend-verticalButton":"legend_24.png",zoomInButton:"zoomin_24.png",zoomOutButton:"zoomout_24.png",zoomVisibleButton:"zoomvisible_24.png",measureButton:"measure_24.png",legendButton:"legend_24.png"};for(var w=0,y,u;w<x.length;w++){y=x[w];u=Ext.query("."+y);for(var v=0,t;v<u.length;v++){t=u[v];if(t){t.innerHTML='<img src="'+g.contextPath+"/dhis-web-commons/javascripts/plugin/images/"+q[y]+'" />'}}}if(Ext.isDefined(l.map.baseLayer)){var s=Ext.isString(l.map.baseLayer)?l.map.baseLayer.split(" ").join("").toLowerCase():l.map.baseLayer;if(!s||s==="none"||s==="off"){l.layer.openStreetMap.setVisibility(false)}else{if(s==="gh"||s==="googlehybrid"){l.olmap.setBaseLayer(l.layer.googleHybrid)}else{if(s==="osm"||s==="openstreetmap"){l.olmap.setBaseLayer(l.layer.openStreetMap)}}}}};j=function(){var s=Ext.get(n.el),q;if(!p()){return}q={plugin:true,dashboard:Ext.isBoolean(n.dashboard)?n.dashboard:false,crossDomain:Ext.isBoolean(n.crossDomain)?n.crossDomain:true,skipMask:Ext.isBoolean(n.skipMask)?n.skipMask:false,skipFade:Ext.isBoolean(n.skipFade)?n.skipFade:false,el:Ext.isString(n.el)?n.el:null,username:Ext.isString(n.username)?n.username:null,password:Ext.isString(n.password)?n.password:null};c();l=GIS.core.getInstance(g,q);m(l,q);var r=function(){var t=new OpenLayers.Layer.Google("Google Streets",{numZoomLevels:20,animationEnabled:true,layerType:l.conf.finals.layer.type_base,layerOpacity:1,setLayerOpacity:function(v){if(v){this.layerOpacity=parseFloat(v)}this.setOpacity(this.layerOpacity)}});t.id="googleStreets";var u=new OpenLayers.Layer.Google("Google Hybrid",{type:google.maps.MapTypeId.HYBRID,numZoomLevels:20,animationEnabled:true,layerType:l.conf.finals.layer.type_base,layerOpacity:1,setLayerOpacity:function(v){if(v){this.layerOpacity=parseFloat(v)}this.setOpacity(this.layerOpacity)}});u.id="googleHybrid";l.olmap.addLayers([t,u]);if(n.baseLayer==="osm"){l.olmap.setBaseLayer(l.layer.openStreetMap)}else{if(n.baseLayer==="gh"){l.olmap.setBaseLayer(u)}else{l.olmap.setBaseLayer(t)}}};if(GIS_GM.ready){console.log("(Item "+n.el+") GM is ready -> skip queue, add layers, set as baselayer");r()}else{if(GIS_GM.offline){console.log("Deactivate base layer");l.olmap.baseLayer.setVisibility(false)}else{console.log("GM is not ready -> add to queue");GIS_GM.array.push({scope:this,fn:r})}}GIS.core.createSelectHandlers(l,l.layer.boundary);GIS.core.createSelectHandlers(l,l.layer.thematic1);GIS.core.createSelectHandlers(l,l.layer.thematic2);GIS.core.createSelectHandlers(l,l.layer.thematic3);GIS.core.createSelectHandlers(l,l.layer.thematic4);GIS.core.createSelectHandlers(l,l.layer.facility);l.map=n;l.viewport=k(q);if(s){s.setViewportWidth=function(t){l.viewport.setWidth(t);l.viewport.centerRegion.setWidth(t);if(l.viewport.northRegion){l.viewport.northRegion.setWidth(t)}}}l.olmap.mask=Ext.create("Ext.LoadMask",l.viewport.centerRegion.getEl(),{msg:"Loading"});GIS.core.MapLoader(l,n).load()}()};GIS.plugin.getMap=function(j){if(Ext.isString(j.url)&&j.url.split("").pop()==="/"){j.url=j.url.substr(0,j.url.length-1)}if(b){e(j)}else{f.push(j);if(!h){h=true;GIS_GM={ready:false,offline:false,array:[]};GIS_GM_fn=function(){console.log("GM called back, queue length: "+GIS_GM.array.length);GIS_GM.ready=true;for(var k=0,l;k<GIS_GM.array.length;k++){l=GIS_GM.array[k];if(l){console.log("Running queue obj "+(k+1));l.fn.call(l.scope)}}};if(!Ext.Array.contains(["osm","none"],j.baseLayer)){Ext.Loader.injectScriptElement("//maps.googleapis.com/maps/api/js?callback=GIS_GM_fn",function(){console.log("GM available (online)")},function(){console.log("GM not available (offline)");GIS_GM.offline=true})}a(j)}}};DHIS=Ext.isObject(window.DHIS)?DHIS:{};DHIS.getMap=GIS.plugin.getMap});